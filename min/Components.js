console.log("using components"),spotter.components=function(){function j(a){if(!a)return!1;for(var b=a.parentNode;b&&"body"!==b&&"document"!==b;){if("SPOTTER-TEMPLATE"===b.tagName)return console.debug("custom element is part of a template",a),!0;b=b.parentNode}return!1}function k(a){if(~c.indexOf(a))return console.debug("custom element already registered:","<"+a.tagName+' id="'+a.id+' class="'+a.className+'"'),!1;var b=e.indexOf(a);return-1===b?(b=c.push(a)-1,d[b]=[]):c[b]=a,!0}function l(a,b){var c;return"string"==typeof a?(c=document.getElementById(a))?c:(console.warn("attempt to retrieve element by id "+a+" failed \n","stack:",(new Error).stack),!1):(c=document.createElement("SPAN"),c.innerHTML=b,c.children[0])}spotter.addCSSToHead(spotter.require.homeURL+"css/components.css"),spotter.addScriptToHead("/js/register-components.js");var a={},b=[],c=[],d=[],e=[],f=!1,g=[],h={};__private={elemConstructorFuncs:[],readyComponents:{}},document.addEventListener("registerComponentsReady",function(){f=!0;for(var b=0,c=g.length,d=g[0];b<c;d=g[++b])document.registerElement(d.tagName,d.initParams),a.registerComponent(d.tagName)}),a.registerComponent=function(a){__private.readyComponents[a]=!0},a.isComponentRegistered=function(a){return!0===__private.readyComponents[a]};var m=function(a,b,c){if(!0===f){document.registerElement(a,b);spotter.components.registerComponent(a)}else g.push({tagName:a,initParams:b})};a.onReady=function(a,f){var g=b.indexOf(a);~g?f.call(a):~(g=c.indexOf(a))?(e[g]="",d[g].push(f),console.debug("registered: index:",g,"readyFuncs.length:",d[g].length)):(g=e.push(a)-1,d[g]=[f],console.debug("unregistered: index:",g,"readyFuncs.length:",d[g].length))},a.isReady=function(a){var e=c.indexOf(a);return~e?(b[e]=a,void 0!==d[e]&&d[e].forEach(function(b){b.call(a)}),!0):(e=c.push(a)-1,b[e]=a,!1)},a.afterPolyFillLoaded=function(a){return function(b){polyfillLoadedReady&&b(),a.elemConstructorFuncs.push(b)}}(__private),document.addEventListener("WebComponentsReady",function(a){return function(){polyfillLoadedReady=!0,a.elemConstructorFuncs.forEach(function(a){a()})}}(__private),!1),a.slots=function(){var a=function(a){var b=document.createElement("DIV"),c=document.createElement("DIV");b.className="spotter-hide-scroll",c.className="reel";var f,g,d={},e=a.getAttribute("type");if(2!==(e=e.split(" to ")).length)return!1;e[1]=Number(e[1]);for(var h=Number(e[0]);h<=e[1];h++)(f=document.createElement("DIV")).className="step",g=("0"+h).slice(-2),f.innerHTML='<span class="center">'+g+"</span>",f.value=g,d[g]=f,c.appendChild(f);return b.appendChild(c),a.appendChild(b),[b,c,d]},b=function(b){if(void 0===b&&(b=this),!j(b)&&k(b)){var c,d,e,f;if(!1===(f=a(b)))return console.error("build reel for slots failed",b),!1;d=f[0],e=f[1],c=f[2];var g=!1,h=!1,l=(spotter.events.setEventTrigger(b,"change"),spotter.getHeight(d)),m=e.children[1].offsetTop,n=Math.round(l/m),o=e.children.length-1,r=null,s=Number(b.getAttribute("offset-frames"))||0,t=function(){d.removeEventListener("scroll",x,!1),d.disableScrollEnd()},u=function(){d.addEventListener("scroll",x,!1),d.enableScrollEnd()},v=function(a){if(!g){if(g=!0,m=e.children[1].offsetTop,void 0===a||void 0===a.tagName){var c=Math.round(d.scrollTop/m);a=e.children[c]}t(),A(void 0,a),B(void 0,a),d.scrollTop=a.offsetTop,w=d.scrollTop,u(),r!=a&&(b.eventTriggers.change(),r=a),g=!1}},w=d.scrollTop,x=function(a){if(!h){h=!0,m=e.children[1].offsetTop;var b=d.scrollTop-w;if(Math.abs(b)>m){console.log("cycleSlides"),console.log(" - scrollChg = "+b),console.log(" - frameHeight = "+m);var c=b/m;b>0?z(Math.floor(c)):y(Math.ceil(c))}h=!1}},y=function(a,b){for(console.log("cycleUp");a<0;)d.scrollTop+=m,!0!==b&&(w=Math.ceil(d.scrollTop/m)*m),e.insertBefore(e.children[o],e.children[0]),a++},z=function(a,b){for(console.log("cycleDown");a>0;)d.scrollTop-=m,!0!==b&&(w=Math.floor(d.scrollTop/m)*m),e.appendChild(e.children[0]),a--},A=function(a,c){if(void 0!==c&&void 0===a){var d=c.offsetTop,e=(o+1)*m,f=e-(n+2)*m;if(console.log("enforceBottomLimit:","offsetTop:",d,"maxHeight:",e,"range:",f),d>=f){var g=n+2-Math.ceil((d-f)/m);console.log(" - cycleDown:",g),z(g)}if(!(d>=e))return;z(Math.ceil((e-d)/m))}else void 0!==a?o-a<=n+2&&z(n+2-(o-a)):console.error("enforce lower limit for slots ",b," index is required")},B=function(a,c){if(void 0!==c&&void 0===a){var d=c.offsetTop;if(!(d<2*m))return;a=2-Math.floor(d/m),console.log("enforceUpperLimit:","index:",a,"offsetTop:",d)}void 0!==a?a>1||y(-1*(2-a)):console.error("enforce upper limit for slots ",b," index is required")};b.getValue=function(){console.log("get slots");var a=r;if(s)for(var b=0;b<s;b++)a=a.nextSibling;return a.value},b.setValue=function(a){var f,g=(e.children.length,c[a]);if(console.log("set slots "+b.className+" to "+a," target elem:",g),g){if(s>0)for(var h=0;h<s;h++)f=g.previousSibling,f||(y(-1,!0),f=g.previousSibling,F++),g=f;return v(g),!0}return console.error("Set value on ",b," failed. The value "+a+" was not found as an option",(new Error).stack),!1};for(var D=null,E=null,F=0;F<o;F++)child=e.children[F],child.hasAttribute("start")&&(D=F,E=child);null===E&&(D=0,E=e.children[0]),B(D),A(D),d.scrollTop=E.offsetTop,r=E,spotter.events.scrollEndEventv2(d,800),d.addEventListener("scrollEnd",v,!1),u()}};return m("spotter-slot",{prototype:Object.create(HTMLDivElement.prototype,{createdCallback:{value:b}})}),spotter.events.fire(spotter.events("slots-ready")),b}(),a.popSelect=function(){var b={instances:[],menus:[],inputs:[]};b.setupMenu=function(a,b){spotter.events.setEventTrigger(b,"change");var g,c=[],d=a.getAttribute("multi-select"),e="disabled"!==a.getAttribute("deselect"),f=a.getAttribute("placeholder");if(g=a.getAttribute("text-target")){if(!(g=document.getElementById(g)))return console.warn("no target element with id "+a.getAttribute("text-target")+" was found for "+a),!1}else g=a.querySelector(".text-target");return null!==g&&null!==f&&spotter.placeholder.add(spotter.getFirstTextNode(g),f),function(h){var i=[],j=h.menus[0].querySelector("[selected]");Array.prototype.push.apply(i,h.menus[0].children),a.options={},i.forEach(function(b){a.options[b.getAttribute("data-value")]=b});var k=function(){var a;if(~(a=c.indexOf(this))){if(!0!==e)return!1;if(c.splice(a,1),b.value=b.value.removeListValue(this.parseData.value),spotter.toggle.class.remove(this,"selected"),g){var h=spotter.firstTextNodeRemoveValue(g,this.parseData.text,f);null!==f&&spotter.placeholder.add(h,f)}}else if("none"===d||"exclusive"===this.parseData.special||this.hasAttribute("exclusive")||c.length&&("exclusive"===c[0].parseData.special||c[0].hasAttribute("exclusive"))){if(spotter.toggle.class.remove(c,"selected"),c=[this],b.value=this.parseData.value,spotter.toggle.class.add(this,"selected"),g){var h=spotter.setFirstTextNode(g,this.parseData.text);null!==f&&spotter.placeholder.add(h,f)}}else if(c.push(this),b.value=b.value.addListValue(this.parseData.value),spotter.toggle.class.add(this,"selected"),g){var h=spotter.firstTextNodeAddValue(g,this.parseData.text);null!==f&&spotter.placeholder.add(h,f)}b.eventTriggers.change()};spotter.events.setDelegatedEvent("click",h.menus[0],k),Object.defineProperty(a,"value",{get:function(){return this.input.value},set:function(a){(o=this.options[a])?k.call(o):console.log("the value "+a+" was not found in the list of options for modal select")}}),null!==j&&(j.click(),a.input.eventTriggers["modal-select-change"]())}};var c=function(c){if(void 0===c&&(c=this),!j(c)&&k(c)){console.log("modal select: ",c.id);var m,p,q,e=c.getAttribute("cache-name"),f=c.getAttribute("targ-input"),g=c.getAttribute("name"),h=l(f,'<input type="hidden" '+(null!==g?'name="'+g+'"':"")+"/>"),i=c.getAttribute("data-option-template")||"modal-select",n=c.querySelectorAll("spotter-option");if("object"!=typeof h||"INPUT"!==h.tagName&&!(h=h.querySelector("input")))return console.warn("target for modal select must either be an input or contain an input"),!1;if(null===f&&((m=c.getAttribute("data-input-name"))&&(h.name=m),(m=c.getAttribute("data-input-id"))&&(h.id=m),c.appendChild(h)),h.id||h.name||(h.id=spotter.makeId(5)),c.input=h,h.popChangeEvt=spotter.events.setEventTrigger(h,"modal-select-change"),h.popSelectTemplate=c.querySelector(c.getAttribute("data-template")||"spotter-template"),null===n&&(n=c.getAttribute("spotter-options")),"string"==typeof n){var r,s=[];if("months"===n)s[0]={value:1,text:"january"},s[1]={value:2,text:"february"},s[2]={value:3,text:"march"},s[3]={value:4,text:"april"},s[4]={value:5,text:"may"},s[5]={value:6,text:"june"},s[6]={value:7,text:"july"},s[7]={value:8,text:"august"},s[8]={value:9,text:"september"},s[9]={value:10,text:"october"},s[10]={value:11,text:"november"},s[11]={value:12,text:"december"},p=new spotter.popMenu("modal-select-"+f).useTemplate(i).bindDataToParseTemplate(s);else if(~(r=n.indexOf(" to "))){for(var t=n.slice(0,r)-1,u=n.slice(r+4)-0,w=0,s=[];++t<=u;)s[w++]={value:t,text:t};p=new spotter.popMenu("modal-select-"+f).useTemplate(i).bindDataToParseTemplate(s)}else s=n.split(","),s.forEach(function(a,b){s[b]={value:a,text:a}}),p=new spotter.popMenu("modal-select-"+f).useTemplate(i).bindDataToParseTemplate(s)}else if(null!==n&&n.length>0)n=a.spotterOptions(n,c,{value:"value",abbr:"abbr",name:"innerHTML",exclusive:"exclusive"}),h.value=n.selected.value,p=new spotter.popMenu("modal-select-"+f).useTemplate(i).bindDataToParseTemplate(n.rows);else{if(!(url=c.getAttribute("options-src")))return console.warn("modal select menus require an options source or for spotter options nodes within the modal select"),!1;e&&(e={name:e,type:c.getAttribute("cache-type")||"local",expiration:c.getAttribute("cache-time")||172800}),p=new spotter.popMenu("modal-select-"+f).useTemplate(i).bindDataToRemoteRequest({},url,e)}(q=c.getAttribute("data-modal-title"))&&p.setTitle(q),p.onMenu(b.setupMenu(c,h)).onOpen(function(a,b){return function(b){a.formerValue=a.value}}(h)).onClose(function(a){return function(){a.formerValue!==a.value&&a.eventTriggers["modal-select-change"]()}}(h)).attachTo(c).loadTemplate(),b.instances.push(c),b.inputs.push(h),b.menus.push(p),a.isReady(c)}};c.onClose=function(a,c){var d;if((d=b.instances.indexOf(a))>-1){var e=function(){c.call(b.instances[d],b.inputs[d])};b.menus[d].onClose(e)}},c.onOpen=function(a,c){var d;if((d=b.instances.indexOf(a))>-1){var e=function(){c.call(b.instances[d],b.inputs[d])};b.menus[d].onOpen(e)}};var d=document.createElement("link");return d.href="/js/spotter/templates/modal-select.html",d.rel="import",document.getElementsByTagName("HEAD")[0].appendChild(d),m("spotter-modal-select",{prototype:Object.create(HTMLDivElement.prototype,{attachedCallback:{value:c}})}),spotter.events.fire(spotter.events("modal-select-ready")),c}();var n=[];return a.ajaxList=function(){var b={defaultErrorHandler:function(a){console.error("An error occurred retrieving data for ajax list: \n","response: \n",a)}},c=function(c){if(!spotter.require.isReady("DataManager"))return void n.push(c);if(void 0===c&&(c=this),!j(c)&&k(c)){var e,f,l,o,p,r,F,q=[],t=!1,u=!1,v=!1,w=!1,x=!!c.hasAttribute("delay-activation"),y=c.getAttribute("src"),z=c.getAttribute("total-limit"),A=c.getAttribute("page-limit"),B=c.getAttribute("sort"),C=c.getAttribute("cache-name"),D=!c.hasAttribute("no-deselect"),G=(c.getAttribute("id-field"),b.defaultErrorHandler),H=c.getAttribute("index-fields"),I=new fastArray(100);null!==z&&(z=Number(z)),null!==A&&(A=Number(A)),null!==H&&(H=H.split(",")),null!==C&&(C={name:C,type:c.getAttribute("cache-type")||"session",expiration:c.getAttribute("cache-time")||86400}),spotter.events.setEventTrigger(c,"ready"),spotter.events.setEventTrigger(c,"selectedChange"),spotter.events.setEventTrigger(c,"moreResults");var J=function(){if(!0!==t){if(~c.disabledListItems.indexOf(this))return void console.log("list item is currently disabled");var a;~(a=c.selectedListItems.indexOf(this))?D||this.hasAttribute("groupable")?spotter.toggle.class.remove(c.selectedListItems.splice(a,1),"selected"):(spotter.toggle.class.remove(c.selectedListItems,"selected"),c.selectedListItems=[this],spotter.toggle.class.add(this,"selected")):(this.hasAttribute("groupable")&&!0===c.allowGroupSelect?c.selectedListItems.push(this):(spotter.toggle.class.remove(c.selectedListItems,"selected"),c.selectedListItems=[this]),spotter.toggle.class.add(this,"selected")),c.eventTriggers.selectedChange()}},K=function(a,b){spotter.templates.setup(a,b),w=!0,q.forEach(function(a){a()})},L=function(a,b){!0===a?(console.log("no more results"+(b?" - "+b:"")),spotter.toggle.hide(c.loadMoreButton),spotter.toggle.show(c.endResults),u=!0,F&&(F.validator.disableSubmit=!0)):!1===a&&(spotter.toggle.show(c.loadMoreButton),spotter.toggle.hide(c.endResults),u=!1,F&&(F.validator.disableSubmit=!1))},M=function(a){var d,b=document.createElement("SPAN");b.className="page_"+c.dataManager.data.master.length,spotter.templates.append(Z,a,b,"group_contacts"===c.id),c.listCont.appendChild(b),d=b.children.length;for(var e=0,f=b.children[e],g=spotter.toggle.class.add;e<d;f=b.children[++e])g(f,"spotter-li"),a[e]._node_=f,f.listData=a[e];return b},N=function(){F.action=F.defaultAction+"&"+f+"&"+e;var a=c.dataManager.getLastSearchParams();a[1].length&&(F.action,a[0].encodeURLParam(),a[1].encodeURLParam());var b=c.dataManager.getLastSortParams();b[0].length>0&&(F.action,b[0].map(function(a,c){return a.encodeURLParam()+"+"+(b[1][c]<0?"desc":"asc")}).join(","))},O=function(){if(!(F=document.getElementById(c.getAttribute("form"))))return void console.error("the id ",c.getAttribute("form")," does not have an associated form element",c);F.hasAttribute("data-ajax-submit")||F.setAttribute("data-ajax-submit",!0),F.defaultAction=String(F.action),-1===F.defaultAction.indexOf("?")&&(F.defaultAction+="?cache=1");spotter.form(F,{success:Q});F.addEventListener("change",function(){x=!0,c.refresh(),x=!1},!1)};c.hideListItems=function(a,b){var d=c.dataManager.search.exact(a,b),e=d.length,f=0,g=spotter.toggle.class.add;for(f;f<e;f++)node=d[f]._node_,g(node,"hide"),I.push(node);return d},c.unhideListItems=function(){var a=I.length,b=0,c=spotter.toggle.class.remove;for(b;b<a;b++)c(I.values[b],"hide");I.clear()},c.disableSelectedListings=function(){for(var a;a=c.selectedListItems.pop();)~c.disabledListItems.indexOf(a)||(a.className=a.className.addListValue("disabled"," "),a.className=a.className.removeListValue("selected"," "),c.disabledListItems.push(a))},c.disableListings=function(a,b){var d,e,h,i,j,f=c.disabledListItems,g=c.selectedListItems;if("string"==typeof a&&void 0!==b)d=c.dataManager.search.exact(a,b),i=d.length;else{var k=c.dataManager.data.master;d=k.values,i=k.length}for(var l=0;l<i;l++)j=d[l],h=j._node_,h||console.log("row:",j),~f.indexOf(h)||(h.className=h.className.addListValue("disabled"," "),~(e=g.indexOf(h))&&(h.className=h.className.removeListValue("selected"," "),g.splice(e,1)),f.push(h))},c.enableListings=function(a,b){var d,e,f,h,g=0,i=c.disabledListItems;if("string"==typeof a&&void 0!==b)for(h=c.dataManager.search.exact(a,b),f=h.length;g<f;g++)e=h[g]._node_,d=i.indexOf(e),e.className=e.className.removeListValue("disabled"," "),i.splice(d,1);else for(;e=i.pop();)e.className=e.className.removeListValue("disabled"," ")},c.deleteListingsByFieldValue=function(a,b){var d=c.dataManager.deleteByField(a,b),e=[];0===d.length&&console.log("deleteListingsByFieldValue: \n","no listings found"," \n","not found: ",this.dataManager.search.notFound," \n","arguments: ",arguments),d.forEach(function(a){e.push(a._node_),delete a._node_}),c.deleteListingsHelper(e)},c.deleteListingsHelper=function(a){void 0===a&&console.log("nodes sent to deleteListingsHelper undefined"),Array.isArray(a)||(a=[a]),a.forEach(function(a){delete a.listData._node_,delete a.listData,spotter.deleteElement(a)})},c.addListingsFromExternal=function(a){Array.isArray(a)||(a=[a]),console.log("addListingsFromExternal");var b=this.dataManager;b.addData(a),a=b.data.recent.new.slice(0),console.log("rows:",a);M(a)},c.showSearchResults=function(){var j,k,a=c.dataManager.data.master,b=a.values,d=this.dataManager.search.results,e=c.disabledListItems,f=c.selectedListItems,g=0,h=a.length;for(console.log("components@showSearchResults: \n","master length:",h," \n","searchResults:",d),g;g<h;g++)j=b[g],k=j._node_,W=~e.indexOf(k),sr=~d.indexOf(j),W||sr?W&&sr&&(k=rows[g]._node_,i=disabledListItems.indexOf(k),k.className=k.className.removeListValue("disabled"," "),disabledListItems.splice(i,1)):(k.className=k.className.addListValue("disabled"," "),~(i=f.indexOf(k))&&(k.className=k.className.removeListValue("selected"," "),f.splice(i,1)),e.push(k))},c.retrieveInformationAboutListingsByField=function(a,b){if(void 0===b)d=c.dataManager.getValuesByField(a);else var d=c.dataManager.search.exact(a,b);return d.length>0&&d},c.getListingsByFieldValue=function(a,b){var d=c.dataManager.search.exact(a,b);return Array.getRowFieldValues(d,"_node_")},c.addRemoteRequestParams=function(a){this.dataManager.setParams(a)},c.removeRemoteRequestParam=function(a){this.dataManager.setParams([a])},c.resetQueryParams=function(){this.dataManager.resetParams()},c.getMoreListings=function(){return R(),c.eventTriggers.moreResults(),c},c.updateSelectedListItems=function(a,b){var d,e,f,g;if((f=c.selectedListItems.length)>a.length)for(var h=0;h<f;h++)"object"==typeof a[h]&&(g=a[h]),a[h]=g;c.selectedListItems.forEach(function(f,g){d=M(a[g]),e=d.children[0],c.dataManager.overwriteByFieldValue(a[g],b,f.listData[b]),c.dataManager.repeatLastSearchAndSort(),spotter.replaceElement(f,e),spotter.deleteElement(d),e.click()})},c.dataReady=function(){return!!v},c.deselectAll=function(){for(var d,a=c.selectedListItems,b=a.length;--b>-1;)d=a.pop(),d.className=d.className.removeListValue("selected"," ")},c.setErrorOnResponseHandler=function(a){if("function"!=typeof a)return console.error("set error response handler must be given a function \n","argument:",a,(new Error).stack),!1;G=a},c.enableRequests=function(){return u=!1,c},c.refresh=function(a){if(a=a||{},void 0!==a.dataSrc&&(y=a.dataSrc),"string"!=typeof y)return console.error("a datasrc was never specified for ajax list <spotter-ajax-list"+(c.id?" id="+c.id:"")+(c.className?" class="+c.className:"")),!1;w=!1,v=!1,u=!1,void 0!==a.pageLimit&&(A=a.pageLimit),void 0!==a.totalLimit&&(z=a.totalLimit);var b=this.dataManager;if(void 0===b?(b=this.dataManager=new spotter.RemoteData({URL:y,name:c.id||void 0,idField:c.getAttribute("id-field"),pageLimit:A,totalLimit:z,indexedFields:H}),b.setSourceNode(c),c.selectedListItems=[],c.disabledListItems=[],c.allowGroupSelect=!0,b.setParseResponse(function(a){return a=JSON.parse(a),"success"===a.status&&"no more results"===a.result[0]&&(a.status="error",L(!0,"parseResponse")),a}),b.addEventListener("search",T,!1),b.addEventListener("searchReset",U,!1),b.addEventListener("sort",V,!1),b.addEventListener(b.events.limitReached,function(){L(!0,"limitReached")}),b.addEventListener(b.events.resultsComplete,function(){L(!0,"resultsComplete")})):("string"==typeof a.dataSrc&&this.dataManager.setURL(a.dataSrc),b.pageLimit=A,b.totalLimit=z,b.reset(),b.resetData(),b.setTrackPagination()),c.listCont.innerHTML="",F&&N(),a.hasOwnProperty("requestParams")&&a.requestParams&&b.setParams(a.requestParams),void 0!==a.template){if(!(l=o.innerHTML))return console.error('The "template" param of the refresh method of ajax list should be an element. Use "import" param if you wish to name an import',c),!1;w=!0,Z=o.id||o.getAttribute("name"),K(l,Z)}else"string"==typeof a.import?(w=!1,Z=a.import,spotter.imports.useImport(Z,function(a){K(a.content.template,Z),S()})):w=!0;b.resetData(),b.reset(),b.preventRequests=!1,L(!1),a.data&&Array.isArray(a.data)?Q({status:"success",result:a.data}):x?console.log("ajax list refresh failed because list is suspended"):R(Q)},c.disableSelect=function(a){t=!!a};var Q=function(a){r=a,a.length>0?(v=!0,S(),F&&N()):L(!0)},R=function(a){u&&console.log("no more results so stopNewRequests is stopping further calls");var b={};return"form"!==y?function(){return b=a.dataManager.getData(Q)}:function(){N(),F.querySelector('input[type="submit"]').click()}}(c),S=function(){if(!1===v)return console.debug("updateListings - data not ready or template not ready"),!1;if(!1===w)return console.debug("updateListings - template not ready"),!1;var a=M(r);0===a.children.length&&console.error("no children created for list update operation:",(new Error).stack),c.eventTriggers.dataReady(null,{contNode:a,data:r})},T=function(){console.debug("hideListItemsAfterSearch",c.dataManager.getCurrentResults()),c.dataManager.data.master.forEach(function(a){spotter.toggle.class.add(a._node_,"hide")}),c.dataManager.getCurrentResults().forEach(function(a){console.log("unhide after search:",a._node_),spotter.toggle.class.remove(a._node_,"hide")})},U=function(){c.dataManager.data.forEach(function(a){spotter.toggle.class.remove(a._node_,"hide")})},V=function(){if(!c.listCont.appendChild)return console.warn("list cannot be sorted because list has not yet been setup"),!1;c.dataManager.getCurrentResults().forEach(function(a){if("object"!=typeof a._node_)return void console.warn("list cannot be sorted because list items have not yet been added as nodes to the data manager");c.listCont.appendChild(a._node_)})};spotter.events.setEventTrigger(c,"dataReady"),c.className=c.className.addListValue("vertical"," ");var W=document.createElement("DIV");if(W.className="spotter-hide-scroll list-slide",c.listCont=document.createElement("DIV"),c.listCont.className="list-cont",W.appendChild(c.listCont),c.appendChild(W),c.endResults=document.createElement("DIV"),c.loadMoreButton=document.createElement("DIV"),c.appendChild(c.endResults),c.appendChild(c.loadMoreButton),spotter.events.expandedMouseEvents(c),spotter.events.setDelegatedEvent("click",c,J,".spotter-li"),A>0&&(c.endResults.className="no-more hide",c.endResults.innerHTML="No More Results",A&&(c.loadMoreButton.className="get-more",c.loadMoreButton.innerHTML="Load More",c.loadMoreButton.addEventListener("click",function(){c.getMoreListings()},!1))),!A){spotter.events.onScrollBottom(W);W.addEventListener("scrollBot",R)}var Y={pageLimit:A,totalLimit:z,sort:B};if("form"===y){var F;O()}else Y.cache=1;var Z=null;if(o=c.querySelector("spotter-template"))Y.template=o;else if(o=c.getAttribute("template")){if(!(o=document.getElementById(o)))return console.error("a template attribute was set for ajax list but the targeted template was not found",c),!1;Y.template=o}else{if(!(p=c.getAttribute("import")))return console.error("ajax list must contain a template or else have the id of a template or import specified",c),!1;Y.import=p}y?c.refresh(Y):console.debug("data source not ready for ajax list",c),a.isReady(c)}};return c.setDefaultResponseErrorHandler=function(a){if("function"!=typeof a)return console.error("Argument sent to set default response error handlder for ajax list must be a function. \n","func: ",a),!1;b.defaultErrorHandler=a},c}(),m("spotter-ajax-list",{prototype:Object.create(HTMLDivElement.prototype,{createdCallback:{value:a.ajaxList}})}),spotter.testLoaded(function(){n.forEach(a.ajaxList),spotter.events.fire(spotter.events("ajax-list-ready"))},"DataManager"),a.searchInput=function(){var b=function(a,c,d,e,f){this.cont=d,this.menu=a,a.className="_auto-fill-menu open",this.listItemClick=function(a){return function(c){b.prototype.listItemClick.call(a,this)}}(this),spotter.events.setEventTrigger(this,"select"),spotter.events.setDelegatedEvent("click",a,this.listItemClick),this.listItems=[],this.listRows=[],this.input=c,this.selectedListItem=null,this.selectedListIndex=-1,this.currentUserInputSearchTerm=null,this.previousValues={},this.setTemplate(e);var g=function(a){return function(){a.hide()}}(this),h=function(a){return function(){a.show()}}(this);this.input.addEventListener("focus",h),this.input.addEventListener("blur",g)};b.prototype.hide=function(){spotter.toggle.class.add(this.menu,"invis")},b.prototype.show=function(){spotter.toggle.class.remove(this.menu,"invis")},b.prototype.setTemplate=function(a){return this.templateId=spotter.makeId(),spotter.templates.setup(a,this.templateId),!0},b.prototype.buildMenu=function(){if(!this.active||!this.templateId)return console.debug("auto complete build menu was called but is not active"),!1;console.log("buildMenu: \n","rows:\n",this.listRows," \n","this:\n",this),this.menu.innerHTML="",this.listRows.length>0?(this.listItems=spotter.castToArray(this.menu.children),spotter.templates.append(this.templateId,this.listRows,this.menu),this.show()):this.hide()},b.prototype.clear=function(){this.menu.className="_auto-fill-menu",this.listItems=[],this.menu.innerHTML="",this.active=!1},b.prototype.resetPosition=function(){this.selectedListIndex=-1,this.selectedListItem=null,this.input.focus(),this.cont.eventTriggers.autoCompleteInactive()},b.prototype.changeListItem=function(a){var b;~this.selectedListIndex?(b=this.listItems[this.selectedListIndex],spotter.toggle.class.remove(b,"selected")):this.currentUserInputSearchTerm=this.input.value,this.selectedListIndex+=a,-1===this.selectedListIndex||this.selectedListIndex>=this.listItems.length?(this.resetPosition(),this.cont.eventTriggers.autoCompleteSelect(void 0,{selectedListItem:this.input}),this.input.value=this.currentUserInputSearchTerm):(this.selectedListIndex<-1&&(this.selectedListIndex=this.listItems.length-1),b=this.listItems[this.selectedListIndex],spotter.toggle.class.add(b,"selected"),this.input.value=b.innerHTML,this.cont.eventTriggers.autoCompleteActive(),this.cont.eventTriggers.autoCompleteSelect(void 0,{selectedListItem:b}))},b.prototype.getSelectedListItem=function(){return-1!==this.selectedListIndex?this.listItems[this.selectedListIndex]:this.input},b.prototype.setSelectedListItem=function(){if(-1===this.selectedListIndex)return!1;this.input.value=this.listItems[this.selectedListIndex].innerHTML},b.prototype.listItemClick=function(a){this.input.value=a.innerHTML,this.eventTriggers.select()},b.prototype.active=!1;var c=function(c){if(void 0===c&&(c=this),!j(c)&&k(c)){var d,m,n,e=c.getAttribute("auto-complete"),f=document.createElement("INPUT"),g=c.querySelector(".submit-button"),h=h=c.getAttribute("data-ignore-case")?h:"";c.getAttribute("auto-complete-limit");f.type="text",f.className="_auto-fill",f.placeholder=c.getAttribute("placeholder"),c.appendChild(f),"disabled"!==e&&(n=(n=c.querySelector("spotter-template"))?n.innerHTML:'<span class="_auto-complete-result">$[DATA]</span>',e=new b(d=document.createElement("DIV"),f,c,n),c.appendChild(d)),spotter.events.setEventTrigger(c,"searchTermChange"),spotter.events.setEventTrigger(c,"searchSubmit"),spotter.events.setEventTrigger(c,"autoCompleteRequestKeys"),spotter.events.setEventTrigger(c,"autoCompleteSelect"),spotter.events.setEventTrigger(c,"autoCompleteActive"),spotter.events.setEventTrigger(c,"autoCompleteInactive");var o=function(a,b){c.searchTerm=a,console.log("searchTermChange:",a),0===a.length?null!==e&&(e.hide(),e.resetPosition(),e.clear()):null!==e&&(console.log(e.previousValues),e.active=!0,void 0===e.previousValues[a]?c.eventTriggers.autoCompleteRequestKeys(void 0,{searchTerm:a}):c.setAutoCompleteResults(e.previousValues[a])),c.eventTriggers.searchTermChange(void 0,{searchTerm:a,key:b})},p=function(a){var b=f.value;a&&a.preventDefault&&a.preventDefault(),null!==e&&(e.hide(),e.resetPosition(),e.clear()),f.focus(),c.eventTriggers.searchSubmit(void 0,{searchTerm:b})},q=function(a){q.event=a;var b=spotter.keyboard.keyCodes[a.keyCode];if("down arrow"===b)e.changeListItem(1);else if("up arrow"===b)e.changeListItem(-1);else if("tab"===b);else if("enter"===b){a.preventDefault();var c=e.getSelectedListItem();c!=this&&(m=f.value=c.innerHTML),g&&g.click()}else r.active=!0};q.event=null,f.addEventListener("keydown",q);var r=function(){if(console.log("keyup is "+(!1===r.active?"not ":"active ")+" and the key is "+spotter.keyboard.keyCodes[q.event.keyCode]),!1!==r.active){r.active=!1;var a=q.event,b=spotter.keyboard.keyCodes[a.keyCode];if("backspace"===b||"delete"===b){f.value.length;var c=f.value;m=c,console.log("keyUp \n",c),o(c,b)}else{if(0===a.which||a.key&&a.key.length>1||(b=spotter.keyboard.getChar(a))&&b.length>1)return;var d;console.log("keyPress \n","value:",f.value),d=f.value,o(d,b),m=d}}};r.active=!1,f.addEventListener("keyup",r),null!==g&&g.addEventListener("click",p),c.setAutoCompleteResults=function(a){void 0===e.previousValues[c.searchTerm]&&(e.previousValues[c.searchTerm]=a),e.listRows=a,a.length>0?e.buildMenu():e.clear()},e.addEventListener("select",p),a.isReady(c)}};return m("spotter-input-search",{prototype:Object.create(HTMLDivElement.prototype,{createdCallback:{value:c}})}),c}(),a.sortInput=function(){var b=function(a){a=a.split(",");for(var g,h,b=a.length,c=[],d=[],e=[];--b>-1;){if(g=a[b],g=g.trim().split(" "),1===(h=g.length))g[1]="alpha",g[2]="1";else if(2===h)~[1,-1,"asc","desc"].indexOf(g[1])?(g[2]=g[1],g[1]="alpha"):g[2]="1";else if(3===h&&"use"===h[1])h[1]=h[2],h[2]="1";else{if(4!==h)return spotter.consoleError("string sent is not of correct format",arguments[0]),!1;g[1]=g[2],g[2]=g[3]}c.push(g[0]),d.push(g[1]),e.push("asc"===g[2]?1:"desc"===g[2]?-1:g[2])}return{fields:c,types:d,directions:e}},c=function(b){if(void 0===b&&(b=this),!j(b)&&k(b)){if(b.UIElem=b.getAttribute("user-interface"),null!==b.UIElem){if(null===(b.UIElem=document.getElementById(b.UIElem)))return console.error("no element found by id for user-interface attribute",b.getAttribute("user-interface")),!1;"spotter"===b.UIElem.tagName.slice(0,7)&&a.onReady(b.UIElem,function(){this.UIElem=__self.input,d(__self)})}var e,c=b.getAttribute("data-src");if(b.setDataSource=function(a){this.dataManager=a,this.setDataSource=void 0,d(this)},null!==c&&(c=document.getElementById(c))){if(b.setDataSource=void 0,!(e=spotter.DataManager.getObjectFor(c)))return void document.addEventListener("datamanagerready",function(a,b){return function(c){c.content&&c.content.srcNode===b&&(a.dataManager=spotter.DataManager.getObjectFor(b),d(a))}}(b,c),!1);b.dataManager=e,d(b)}else console.debug("sort input waiting for data source")}},d=function(c){c.UIElem&&c.dataManager&&(c.sort=function(a){var d=this.querySelector("input"),e=b(d.value);console.log("cont.sort:",a,"sortOpts:",e),c.dataManager.sort(e.fields,e.types,e.directions)},c.UIElem.addEventListener("modal-select-change",c.sort,!1),console.log("spotter input sort: \n",c.UIElem," \n",String(c.UIElem.value)," \n",typeof c.UIElem.defaultSelection),c.UIElem.value?c.sort.call(c.UIElem):"function"==typeof c.UIElem.defaultSelection&&c.UIElem.defaultSelection(),a.isReady(c))};return m("spotter-input-sort",{prototype:Object.create(HTMLDivElement.prototype,{createdCallback:{value:c}})}),c.parseSortString=b,c}(),a.popUpTextArea=function(){var b,a={popMenus:[],error:function(a){console.log("ERROR [spotter.components.popUpTextArea]: "+a)},template:"big-textbox"},c={functions:{getOnClose:function(a,b){return function(){console.log("big text box value info: \n","value length:",b.modalRepresentative.value.length," \n","textarea value: ",b.modalRepresentative.value," \n","target text area:",b),b.modalRepresentative.value.length?b.value=b.innerText=b.innerHTML=b.modalRepresentative.value:b.value=b.innerText=b.innerHTML=b.value=""}},modalRepClick:function(){this.hasBeenActivated||(this.value="",this.hasBeenActivated=!0)}}};return b=function(b){if(void 0===b&&(b=this),!j(b)&&k(b)){var d=b.getAttribute("button");if(d&&!(d=document.getElementById(d)))return void console.error("the button for modal textarea was not found by id",b.getAttribute("button"),b);(d=b.querySelector(".button"))||(d=b);var e=b.getAttribute("target");if(e&&!(e=document.getElementById(d)))return void console.log("the target input ("+b.getAttribute("target")+") for modal textarea was not found by id");(e=b.querySelector(".target"))||(e=document.createElement("textarea"),b.hasAttribute("name")&&(e.name=b.getAttribute("name")),b.hasAttribute("placeholder")&&(e.placeholder=b.getAttribute("placeholder")),b.hasAttribute("maxlength")&&(e.maxLength=b.getAttribute("maxlength")),b.hasAttribute("initial-value")&&(e.value=b.getAttribute("initial-value")),e.className="hide",b.appendChild(e));var f=b.getAttribute("text-target");if(null!=f&&!(f=document.getElementById(f)))return void console.log("the text target ("+b.getAttribute("text-target")+") for modal textarea was not found by id");if(f=b.querySelector(".text")){var g=function(a){return a||null===e.placeholder?a:e.placeholder};spotter.data.bindElementToInput(f,e,g),f.hasAttribute("text-limit")?f.textLimit=f.getAttribute("text-limit"):b.hasAttribute("text-limit")&&(f.textLimit=b.getAttribute("text-limit")),e.value.length?spotter.setFirstTextNode(f,e.value):e.placeholder.length&&spotter.setFirstTextNode(f,e.placeholder)}var h=new spotter.popMenu(e.name).useTemplate("big-textbox").onMenu(function(){e.modalRepresentative=this.querySelector(".big-textbox"),e.modalRepresentative.addEventListener("click",c.modalRepClick,!1),e.modalRepresentative.placeholder=e.placeholder||null,e.modalRepresentative.value=e.value.trim()||null}).onClose(c.functions.getOnClose(d,e)).onOpen(function(){null!==e.value&&e.value.length>=0&&(e.modalRepresentative.value=e.value||null,e.modalRepresentative.hasBeenActivated=!0),e.modalRepresentative.focus(),spotter.resetCursor(e.modalRepresentative)}).setTitle(d.getAttribute("title")||"title not set").attachTo(d).loadTemplate();a.popMenus.push(h);b.setValue=function(a){null!==a&&0!==a.length||!e.placeholder.length||spotter.setFirstTextNode(f,e.placeholder),e.value=a}}},m("spotter-modal-textarea",{prototype:Object.create(HTMLElement.prototype,{createdCallback:{value:b}})}),b}(),a.keypad=function(){var a=function(a){if(void 0===a&&(a=this),!j(a)&&k(a)){var b="",c=document.createElement("DIV");c.className="input",a.appendChild(c),a.textTarget=c;var d=document.createElement("DIV");d.className="keypad clear",a.appendChild(d),void 0===a.filters&&(a.filters={custom:function(a){return a}});var e=spotter.getLocalePreferences(),f=function(a){return a.toLocaleString(e.language)};if(a.hasAttribute("special")){switch(a.getAttribute("special")){case"currency":f=function(a){return Number(a.replace(/[^0-9]/g,"")).toLocaleString(e.language,{style:"currency",currency:e.currency.abbr})}}}a.clear=function(a){this.textTarget.innerHTML="undefined"!==a?f(a):"",b=""};for(var i=(spotter.events.setEventTrigger(a,"done"),""),l=10;--l>-1;)i+='<div class="key hvr-push"><div class="text">'+l+"</div></div>";customKeys=a.getAttribute("custom-keys"),customKeys&&(customKeys=customKeys.split(","),customKeys.forEach(function(a){i+='<div class="key double hvr-push"><div class="text">'+a+"</div></div>"})),i+='<div class="key double hvr-push"><div class="text">backspace</div></div>',i+='<div class="key triple hvr-push"><div class="text">done</div></div>',d.innerHTML=i;Array.prototype.slice.call(d.querySelectorAll(".key")).forEach(function(d){d.text=d.querySelector(".text").innerHTML,d.addEventListener("click",function(){"done"===d.text?a.eventTriggers.done():"backspace"===d.text?(b=b.slice(0,-1),c.innerHTML=f(b)):d.text==parseInt(d.text,10)?(void 0!==a.filters.numeric&&a.filters.numeric(b),b+=String(this.text),c.innerHTML=f(b)):a.filters.custom.call(a,d.text)},!1),d.addEventListener("mouseup",function(){this.className=this.className+" active"},!1),d.addEventListener("mousedown",function(){this.className=this.className.replace(/\sactive/g,"")},!1)}),a.setValue=function(b){return c.innerHTML=f(b),a},a.linkInput=function(b){return spotter.requiredParam(b).element("INPUT").result()(),this.targInput=b,a.setValue(b.value),a.addEventListener("done",function(){this.targInput.value=this.textTarget.innerHTML},!1),a}}};return m("spotter-keypad",{prototype:Object.create(HTMLDivElement.prototype,{createdCallback:{value:a}})}),a}(),a.toggleSwitch=function(){var a=function(a){if(void 0===a&&(a=this),!j(a)&&k(a)){var b=document.createElement("DIV");b.className="reel";var c=a.getAttribute("options").split(","),d="";c.forEach(function(a){var b,c=a;(b=/^(.+?)\((.+)\)$/.exec(a))&&(c=b[2],a=b[1]),d+='<div class="option" value="'+c+'">'+a+"</div>"});for(var f,e=a.querySelectorAll("spotter-option"),g=0,h=e.length;g<h;g++)f=e[g],d+='<div class="option" value="'+f.getAttribute("value")+'">'+f.innerHTML+"</div>",a.removeChild(f);d='<div class="option empty top"></div>'+d+'<div class="option empty bot"></div>',b.innerHTML=d,a.appendChild(b);var h=b.children.length-3,i=0;spotter.events.setEventTrigger(a,"change");var l=function(c){var d="-"+Number(100*i)+"%";Velocity(b,{marginTop:d},{duration:200,complete:function(){var c=b.children[i+1].getAttribute("value");a.setAttribute("value",c),a.eventTriggers.change()}})};a.getValue=function(){return this.getAttribute("value")},a.setValue=function(a){var b=this.querySelector('.option[value="'+a+'"]');null===b?console.error("the toggle switch ",this," does not contain a child with value "+a):(i=[].indexOf.call(b.parentNode.children,b)-1,l())},spotter.events.swipeEvents(a,"5%"),a.addEventListener("swipeup",function(){i>=h||(i++,l())},!1),a.addEventListener("swipedown",function(){i<=0||(i--,l())},!1);var m;null!==(m=a.getAttribute("value"))?a.setValue(m):a.setValue(b.children[1].getAttribute("value"))}};return m("spotter-toggle-switch",{prototype:Object.create(HTMLScriptElement.prototype,{createdCallback:{value:a}})}),a}(),a.calendar=function(){var a=function(a){void 0===a&&(a=this),"object"!=typeof moment?(spotter.require("moment","/js/spotter/third_party/moment.js",[],function(){return window.moment}),spotter.testLoaded(function(){b(a)},"moment")):b(a)},b=function(a){if(void 0===a&&(a=this),!j(a)&&k(a)){var b=moment(a.getAttribute("value")||void 0),c=b.year(),d=b.month(),e=b.date(),f=document.createElement("DIV");f.className="title-bar",f.innerHTML='<div class="selected-date"></div>',a.appendChild(f);var h,g=a.getAttribute("upper-limit");if(console.debug("upperLimit",typeof g,g),null!==g)if("now"===g||"today"===g){var h=moment();g={year:h.year(),month:h.month(),day:h.date()}}else if(h=/([0-9]+)\-([0-9]+)\-([0-9]+)/.exec(g))g={year:h[3],month:h[2],day:h[1]};else{g=g.split(" ");var h=moment(e+"-"+String(d+1)+"-"+c,"D-M-YYYY");g.forEach(function(a){var b=/([\+\-])([0-9]+)(days|months|years)/.exec(a);"+"===b[1]?h.add(b[2],b[3]):"-"===b[1]&&h.subtract(b[2],b[3])}),g={year:h.year()||0,month:h.month()||0,day:h.date()||0}}var i=a.getAttribute("lower-limit");if(i)if("now"===i||"today"===i){var l=moment();i={year:l.year(),month:l.month(),day:l.date()}}else if(i=/([0-9]+)\-([0-9]+)\-([0-9]+)/.exec(i))i={year:i[3],month:i[2]-1,day:i[1]};else{i=" "+i;var l=moment(e+"-"+String(d+1)+"-"+c,"D-M-YYYY");i.forEach(function(a){var b=/([\+\-])([0-9]+)(days|months|years)/.exec(a);"+"===b[1]?l.add(b[2],b[3]):"-"===b[1]&&l.subtract(b[2],b[3])}),i={year:l.year(),month:l.month()-1,day:l.date()}}var m=12,n=-1,o=0,p=0,q=function(a){if(null!==g)return"year"===a?c>=g.year?(c=g.year,m=g.month,!0):(m=12,!1):"month"===a?d>=g.month&&c>=g.year?(d=g.month,o=g.day,!0):(o=0,console.log("month within range"),!1):void console.error("argument type is required for test upper limit and must be month or year ("+a+")")},r=function(a){if(null!==i)return"year"===a?c<=i.year?(c=i.year,n=i.month,!0):(n=-1,!1):"month"===a?d<=i.month&&c<=i.year?(d=i.month,p=i.day,!0):(p=0,!1):void console.error("argument type is required for test lower limit and must be month or year ("+a+")")},s=f.querySelector(".selected-date");spotter.events.setEventTrigger(a,"change");var t=function(){s.innerHTML=moment(e+"-"+String(d+1)+"-"+c,"D-M-YYYY").format("MMM, DD YYYY"),a.year=c,a.month=d,a.day=e,a.eventTriggers.change()},u=function(a){m=12,n=-1,"+"===a?(c++,q("year")):"-"===a?(c--,r("year")):a>0&&(c=a,q("year"),r("year")),t()},v=function(a){u(a)},w=document.createElement("DIV");w.className="months-scroll",w.innerHTML='<div class="month-bar"><img class="arrow-left" src="/images/universal/nav_arrow_left.png"/><div class="name"></div><img class="arrow-right" src="/images/universal/nav_arrow_right.png"/></div>';var x=w.querySelector(".arrow-right"),y=w.querySelector(".arrow-left"),z=w.querySelector(".name"),A="",B=["january","february","march","april","may","june","july","august","september","october","november","december"],C=[],D={};B.forEach(function(a,b){tag=document.createElement("SPAN"),tag.className="tag",tag.textContent=a,C[b]=tag,z.appendChild(tag),D[a]=b}),a.appendChild(w);var E=function(a){if(!Number.isInteger(a)||!(a>=0&&a<=11))return console.error("argument ("+a+") to cycle month must be an integer between 0 and 11 inclusive",(new Error).stack),!1;for(var b=C[a],c=0;z.children[0]!==b&&c<13;)z.appendChild(z.children[0]),c++;if(c>12)return console.error("set month failure. the target month was not found"),!1;d=a,d>=m&&(x.style.visibility="hidden",H=!1),d<=n&&(y.style.visibility="hidden",I=!1),q("month"),r("month"),V()},F=function(a){"+"===a?(d++,d>11&&(u("+"),d=0),console.log("incrementMonth: month",d,"lowerLimitMonth:",n,"upperLimitMonth:",m),d!==n&&(y.style.visibility="visible",I=!0),d>=m&&(x.style.visibility="hidden",H=!1,q("month")),p=0):"-"===a&&(d--,d<0&&(u("-"),d=11),d!==m&&(x.style.visibility="visible",H=!0),d<=n&&(y.style.visibility="hidden",I=!1,r("month")),o=0),t()},G=!1,H=!0,I=!0,J=function(a){if(!0===G)return void console.log("scrollMonthActive is true");if(G=!0,"+"===a){if(!1===H)return void console.log("scrollUp is false");var b=z.children[0];Velocity(b,{marginLeft:"-100%"},{duration:200,complete:function(){F(a),z.appendChild(b),b.style.marginLeft="0",V(),G=!1}})}else if("-"===a){if(!1===I)return void console.log("scrollDown is false");var b=z.children[z.children.length-1];b.style.marginLeft="-100%",z.insertBefore(b,z.children[0]),Velocity(b,{marginLeft:"0"},{duration:200,complete:function(){F(a),V(),G=!1}})}else console.error("scroll month argument ("+a+") must be 1 or -1");console.log("month:",d)};a.setYear=function(a){v(a),V()},w.querySelector(".arrow-left").addEventListener("click",function(){J("-")},!1),w.querySelector(".arrow-right").addEventListener("click",function(){J("+")},!1);var K=document.createElement("DIV");K.className="days-bar";var L=document.createElement("DIV");L.className="days-name-bar",A="";["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(a){A+='<div class="name">'+a.substr(0,3)+"</div>"}),L.innerHTML=A,K.appendChild(L);var N=document.createElement("DIV");N.className="days-number",A="";for(var O=0;O<8;O++)A+='<div class="inactive start">'+(24+O)+"</div>";for(O=1;O<32;O++)A+='<div class="active">'+O+"</div>";for(O=1;O<14;O++)A+='<div class="inactive end">'+O+"</div>";N.innerHTML=A,K.appendChild(N),a.appendChild(K);var Q=Array.prototype.slice.call(N.querySelectorAll(".active")).reverse(),R=Array.prototype.slice.call(N.querySelectorAll(".inactive.start")),S=Array.prototype.slice.call(N.querySelectorAll(".inactive.end")),T=[],V=function(){for(var b=0;b<4;b++)Q[b].style.display="inline-block";T.forEach(function(a){a.className=a.className.removeListValue("deactivated"," ")}),T=[];var f=moment(c+"-"+String(d+1),"YYYY-M").daysInMonth(),g=31-f;for(b=0;b<g;b++)Q[b].style.display="none";if(o>0){var h=31-o-g;for(b=0;b<h;b++)l=Q[b],l.className=l.className.addListValue("deactivated"," "),T.push(l);e>o&&W(o)}if(p>0){for(b=31-(p-1);b<31;b++)l=Q[b],l.className=l.className.addListValue("deactivated"," "),T.push(l);e<p&&W(p)}X.click(),R.forEach(function(a){a.style.display="none"});var i=new Date(c,d,1),j=i.getDay();if(j>0){var l,k=moment((0===d?c-1:c)+"-"+(0===d?12:d),"YYYY-M").daysInMonth();console.log("daysInPreviousMonth",(0===d?c-1:c)+"-"+(0===d?12:d),k);var m=31-k;for(b=0;b<j;b++)l=R[7-m-b],void 0===l?console.warn("inactivedaysend["+(7-m-b)+"] was undefined"):l.style.display="inline-block"}S.forEach(function(a){a.style.display="none"});var l,h=42-(j+f);for(b=0;b<h;b++)l=S[b],void 0===l?console.warn("inactivedaysend["+b+"] was undefined"):l.style.display="inline-block";a.month!==d?X.className=X.className.removeListValue("selected"," "):X.className=X.className.addListValue("selected"," ")},W=function(a){Q[31-a].click()},X=Q[0];return Q.forEach(function(a){a.addEventListener("click",function(a){this!==X&&(a.target.className.indexOf("deactivated")>-1||(e=this.innerHTML,this.className=this.className.addListValue("selected"," "),X.className=X.className.removeListValue("selected"," "),X=this,t()))},!1)}),t(),v(c),E(d),W(e),p>0&&(p=0),o>0&&(o=0),b}};return m("spotter-calendar",{prototype:Object.create(HTMLElement.prototype,{createdCallback:{value:a}})}),a}(),a.timeCalendar=function(){var a=function(a){if(void 0===a&&(a=this),!j(a)&&k(a)){var b=document.createElement("SPOTTER-CALENDAR"),c=a.getAttribute("upper-date-limit"),d=a.getAttribute("lower-date-limit");null!==d&&b.setAttribute("lower-limit",d),null!==c&&b.setAttribute("upper-limit",c),a.appendChild(b);var e=spotter.components.calendar(b),f=b.querySelector(".title-bar"),g=document.createElement("IMG");g.className="icon",g.src="/spotter/images/universal/clock_s_bicolour.png",g.addEventListener("click",function(){Velocity(n,{left:0},{duration:250})},!1),f.appendChild(g);var h=document.createElement("DIV");h.className="selected-datetime";var i=f.querySelector(".selected-date");f.insertBefore(h,i),h.appendChild(i);var l=document.createElement("DIV");l.className="selected-time",h.appendChild(l),spotter.events.setEventTrigger(a,"change");var m=function(){var b=p.getValue()+":"+r.getValue()+s.getValue();l.innerHTML=b,a.eventTriggers.change()},n=document.createElement("DIV");n.className="time";var o=document.createElement("DIV");o.className="title-bar",o.innerHTML=a.getAttribute("title-time"),n.appendChild(o);var p=document.createElement("SPOTTER-SLOT");p.className="start-hour vertical",p.setAttribute("offset-frames",a.getAttribute("offset-frames")),p.setAttribute("type","1 to 12"),n.appendChild(p);var q=document.createElement("DIV");q.className="divider",n.appendChild(q);var r=document.createElement("SPOTTER-SLOT");r.className="start-minute vertical",r.setAttribute("offset-frames",a.getAttribute("offset-frames")),r.setAttribute("type","0 to 59"),n.appendChild(r);var s=document.createElement("SPOTTER-TOGGLE");s.className="meridiem",s.setAttribute("options","am,pm"),n.appendChild(s),a.appendChild(n),spotter.components.slots(p),spotter.components.slots(r),spotter.components.toggleSwitch(s),spotter.events.swipeEvents(n,"20%"),n.addEventListener("swiperight",function(){Velocity(this,{left:"100%"},{duration:250,complete:m})},!1),r.setValue(("0"+e.format("mm")).slice(-2));var t=e.format("HH"),u="pm";t>12?t-=12:u="am",t=Number(t),t=0===t?"12":("0"+String(t)).slice(-2),p.setValue(t),console.log("meridiem:",u),s.setValue(u),b.addEventListener("change",a.eventTriggers.change,!1),p.addEventListener("change",m,!1),r.addEventListener("change",m,!1),s.addEventListener("change",m,!1),m(),Object.defineProperty(a,"value",{get:function(){return i.innerHTML+"T"+l.innerHTML}}),Object.defineProperty(a,"UTC",{get:function(){return moment(i.innerHTML+"T"+l.innerHTML,"MMM, DD YYYYThh:mma").unix()}}),a.getFormattedDate=function(a){return console.log("selectedTime.innerHTML:",l.innerHTML),moment(i.innerHTML+"T"+l.innerHTML,"MMM, DD YYYYThh:mma").format(a)}}};return m("spotter-time-calendar",{prototype:Object.create(HTMLScriptElement.prototype,{createdCallback:{value:a}})}),a}(),a.spotterTemplate=function(){var a=function(a){void 0===a&&(a=this),!j(a)&&k(a)&&spotter.imports.registerTemplate(a)};return m("spotter-template",{prototype:Object.create(HTMLScriptElement.prototype,{createdCallback:{value:a}})}),a}(),document.createElement("spotter-option"),a.spotterOptions=function(a,b,c){c=c||{value:"value",name:"name"},a.length||(a=[a]);var e,f,g,h,i,d=a.length,j={parent:b,children:[],selected:a[0],rows:[]};for(j.setSelected=function(a){spotter.isType.numeric(a)?this.selected=this.children[a]:this.selected=a},j.setSelected(0),h=0;h<d;h++){e=a[h],e.getAttribute||console.log((new Error).stack),f={};for(i in c)g="innerHTML"===c[i]?e.innerHTML:e.getAttribute(c[i]),e[i]=g,f[i]=g;e.index=j.children.push(e)-1,j.rows[e.index]=f,e.family=j,e.hasAttribute("selected")&&(j.selected=e)}return j},a.cropper=function(){var a=function(a,b,c){var d=document.createElement("DIV");a.cropperCont=d,spotter.templates.setup(b,c),spotter.templates.append(c,null,d)},b=function(b){void 0===b&&(b=this);var d,e;(d=b.getAttribute("template"))?spotter.imports.useImport(d,function(e){a(b,e.content.template,d),c(b)}):(e=b.querySelector("spotter-template"))?(a(b,e.innerHTML,e.id||e.getAttribute("name")),e=null,c(b)):(a(b,'<div class="canvas-cont"></div><img src="/spotter/images/universal/crop_s_tri_colour.png" class="crop-button"/><img src="/spotter/images/universal/undo_s_bicolour.png" class="undo-button"/><img src="/spotter/images/universal/save_file_s_bicolour.png" class="save-button"/>',"defaultSpotterCropper"),c(b))},c=function(a){if(!j(a)&&k(a)){a=a||this;var c,d,v,b=new spotter.shade("imageCropper"+a.getAttribute("name")),e=a.cropperCont,f=null,g=document.createElement("INPUT"),h={thickness:Number(a.getAttribute("frame-thickness"))||2,heightMult:Number(a.getAttribute("frame-height"))||80,widthMult:Number(a.getAttribute("frame-width"))||80,width:null,height:null,maxWidth:null,maxHeight:null,minWidth:null,minHeight:null,x:null,y:null,color:a.getAttribute("frame-color")||"#FFFFFF",canvas:document.createElement("CANVAS"),aspect:null,active:!1},i={thickness:Number(a.getAttribute("handle-thickness"))||2,ctx:h.canvas.getContext("2d"),heightMult:Number(a.getAttribute("handle-height"))||15,widthMult:Number(a.getAttribute("handle-width"))||15,width:null,height:null,color:a.getAttribute("handle-color")||"#FFFFFF",x:null,y:null,active:!1},l={ctx:h.canvas.getContext("2d"),opacity:(a.getAttribute("blur-opacity")||8)/10,color:a.getAttribute("blur-color")||"#000",active:a.getAttribute("blur-active")||!0},m={canvas:document.createElement("CANVAS"),imageData:null,maxWidth:a.getAttribute("maximum-image-resize")||null},n={canvas:document.createElement("CANVAS"),width:a.getAttribute("crop-width"),height:a.getAttribute("crop-height")},o={canvas:document.createElement("CANVAS"),width:null,height:null},p={canvas:document.createElement("CANVAS"),width:a.getAttribute("crop-width"),height:a.getAttribute("crop-height"),maxWidth:a.getAttribute("max-crop-width"),maxHeight:a.getAttribute("max-crop-height"),minWidth:a.getAttribute("min-crop-width"),minHeight:a.getAttribute("min-crop-height"),aspect:(d=a.getAttribute("aspect-ratio"))&&(d=d.split("/"))?d[0]/d[1]:d,fillMode:a.getAttribute("fill-mode")||"cover",quality:.92|Number(a.getAttribute("image-quality")),mimeType:a.getAttribute("image-mimetype")||"jpg"},q={start:{x:0,y:0},end:{x:0,y:0}},r={crop:null,save:null,undo:null},s={canvas:document.createElement("CANVAS"),width:null},u=(spotter.events.setEventTrigger(a,"crop"),spotter.events.setEventTrigger(a,"undo"),spotter.events.setEventTrigger(a,"save"),spotter.events.setEventTrigger(a,"close"),spotter.events.setEventTrigger(a,"open"),{save:!1,crop:!0,undo:!1});h.context=h.canvas.getContext("2d"),n.context=n.canvas.getContext("2d"),o.context=o.canvas.getContext("2d"),p.context=p.canvas.getContext("2d"),p.canvas.setAttribute("image-quality",p.quality),p.canvas.setAttribute("mimetype",p.mimeType);f=e.querySelector(".canvas-cont"),r.crop=e.querySelector(".crop-button"),r.undo=e.querySelector(".undo-button"),r.save=e.querySelector(".save-button"),r.undo.className=r.undo.className.addListValue("inactive"," "),r.save.className=r.save.className.addListValue("inactive"," "),h.canvas.className="frame",o.canvas.className="reference",n.canvas.className="preview",s.canvas.className="cropper-input",f.appendChild(n.canvas),f.appendChild(o.canvas),f.appendChild(h.canvas),b.content.appendChild(e),a.appendChild(s.canvas);var A=function(a,b,c,d){(0!==a&&!a||0!==b&&!b||0!==c&&!c||0!==d&&!d)&&console.error("set frame arguments must all be defined and non null",arguments),h.context.clearRect(0,0,h.canvas.width,h.canvas.height),h.context.strokeStyle=h.color,h.context.lineWidth=h.thickness,h.x=Math.ceil(a),h.y=Math.ceil(b),h.width=c,h.height=d,h.context.strokeRect(a,b,c-h.thickness,d-h.thickness),C()},B=function(a,b){a=a||i.width,b=b||i.width,i.ctx.strokeStyle=i.color,i.ctx.lineWidth=i.thickness,i.x=h.x+h.width-a-i.thickness,i.y=h.y+h.height-b-i.thickness,i.width=a,i.height=b,i.ctx.strokeRect(i.x,i.y,a,b)},C=function(){if(l.active){var a=h.x+h.width,c=(h.y,h.x),d=h.y+h.height;l.ctx.fillStyle="rgba("+[spotter.hexToRgb(l.color),l.opacity].join(",")+")",l.ctx.fillRect(0,0,h.x,h.canvas.height),l.ctx.fillRect(a,0,h.canvas.width-a,h.canvas.height),l.ctx.fillRect(h.x,0,h.width,h.y),l.ctx.fillRect(c,d,h.width,h.canvas.height-d)}},D=function(){var c=h.width,d=h.height;L(),b.open(),p.maxWidth&&(c=Math.min(p.maxWidth,c)),p.maxHeight&&(d=Math.min(p.maxHeight,d)),p.minWidth&&(c=Math.max(p.minWidth,c)),p.minHeight&&(d=Math.max(p.minHeight,d)),p.aspect&&(d=c/p.aspect),A((h.canvas.width-c)/2,(h.canvas.height-d)/2,c,d),B(),Velocity(e,{width:"100%"},{duration:400}),a.eventTriggers.open()},E=function(){a.eventTriggers.close(),Velocity(e,{width:"0"},{duration:400,complete:b.close})},F=function(b){var c,d;c=e.style.width,e.style.width="",d=Math.round(spotter.getWidth(e)),e.style.width=c,m.canvas.width&&(h.aspect=d/m.canvas.width,p.maxWidth&&(h.maxWidth=p.maxWidth*h.aspect),p.maxHeight&&(h.maxHeight=p.maxHeight*h.aspect),p.minWidth&&(h.minWidth=p.minWidth*h.aspect),p.minHeight&&(h.minHeight=p.minHeight*h.aspect)),h.canvas.width=d,h.canvas.setAttribute("width",d+"px"),o.canvas.width=d,o.canvas.setAttribute("width",d+"px"),n.canvas.width=d,n.canvas.setAttribute("width",d+"px"),d=spotter.getWidth(a,void 0,!0),s.canvas.setAttribute("width",d)},G=function(){var a=o.canvas.width,b=o.canvas.width/m.canvas.width,c=b*m.canvas.height;h.canvas.height=o.canvas.height=c,h.canvas.setAttribute("height",c),h.width=h.widthMult/100*a,p.aspect?(h.height=h.width/p.aspect,h.height>c&&(h.height=h.widthMult/100*c,h.width=h.height*p.aspect)):h.height=h.widthMult/100*c,i.width=i.widthMult/100*h.width,i.height=i.heightMult/100*h.width,o.canvas.setAttribute("height",c),m.image&&o.context.drawImage(m.image,0,0,o.canvas.width,o.canvas.height)},H=function(){h.aspect=h.canvas.width/m.canvas.width,p.maxWidth&&(h.maxWidth=p.maxWidth*h.aspect),p.maxHeight&&(h.maxHeight=p.maxHeight*h.aspect),p.minWidth&&(h.minWidth=p.minWidth*h.aspect),p.minHeight&&(h.minHeight=p.minHeight*h.aspect),G(),open&&D()},I=function(a,b){var c;c="string"==typeof a?new spotter.images.createImageFromDataUrl(a,!0,m.image||null):new spotter.images.createImageFromFile(a,!0,m.image||null),c.promise(function(a){var b=m.canvas,c=b.getContext("2d");m.image=a,spotter.images.maxSize(a,1024,1024),a.exif?(a.onload=H,spotter.images.orient(a,b)):(b.width=a.width,b.height=a.height,c.drawImage(a,0,0,a.width,a.height),H())})},J=function(){var a={};return function(){var b=this.files[0],c=["lastModified","name","size","type"],d=!1;c.forEach(function(c){a[c]!==b[c]&&(d=!0)}),d?(void 0!==a&&c.forEach(function(c){a[c]=b[c]}),I(b,!0)):D()}}(),K=function(){if(u.crop){u.crop=!1;var b=Math.round(h.x/h.aspect),c=Math.round(h.y/h.aspect),d=h.width/h.aspect,e=h.height/h.aspect;O(b,c,d,e,m.canvas,p.canvas,p.width,null,p.fillMode,function(){n.canvas.style.zIndex=101,o.canvas.style.display="none",h.canvas.style.display="none",n.canvas.style.position="relative",n.canvas.style.visibility="visible",r.undo.className=r.undo.className.removeListValue("inactive"," "),r.save.className=r.save.className.removeListValue("inactive"," "),r.crop.className=r.crop.className.addListValue("inactive"," "),N(this,n.canvas,n.canvas.width,null,p.fillMode),u.save=!0,u.undo=!0,a.eventTriggers.crop()})}},L=function(){u.undo&&(u.undo=!1,u.save=!1,u.crop=!0,n.canvas.style.zIndex=99,o.canvas.style.display="inline-block",h.canvas.style.display="inline-block",n.canvas.style.position="absolute",n.canvas.style.visibility="hidden",r.undo.className=r.undo.className.addListValue("inactive"," "),r.save.className=r.save.className.addListValue("inactive"," "),r.crop.className=r.crop.className.removeListValue("inactive"," "),a.eventTriggers.undo())},M=function(){u.save&&(N(null,s.canvas,s.canvas.width,null,p.fillMode),E(),a.eventTriggers.save(),a.hasValue=!0)},N=function(a){return function(b,c,d,e,f){b?a=b:b=a;var g,h,i;d&&!e?(g=d/b.width,g>1?"cover"===f?(c.setAttribute("height",b.height*g),c.getContext("2d").drawImage(b,0,0,b.width*g,b.height*g)):"contain"===f?(c.setAttribute("height",b.height*g),c.getContext("2d").drawImage(b,0,0,d,b.height*g)):"whitespace"===f&&(c.setAttribute("height",b.height),c.getContext("2d").drawImage(b,(d-b.width)/2,0,b.width,b.height)):"cover"===f?(c.setAttribute("height",b.height*g),c.getContext("2d").drawImage(b,0,0,b.width,b.height)):(c.setAttribute("height",b.height*g),c.getContext("2d").drawImage(b,0,0,d,b.height*g))):e&&!d?(g=e/b.height,g>1?"cover"===f?(c.setAttribute("width",b.width*g),c.getContext("2d").drawImage(b,0,0,e,b.height)):(c.setAttribute("width",b.width/g),c.getContext("2d").drawImage(b,0,0,d,b.height/g)):"cover"===f?(c.setAttribute("width",b.width/g),c.getContext("2d").drawImage(b,0,0,d,e)):"whitespace"===f?(c.setAttribute("width",b.width),c.getContext("2d").drawImage(b,(e-b.height)/2,(d-b.width)/2,b.width,b.height)):"contain"===f&&(c.setAttribute("width",b.width/g),c.getContext("2d").drawImage(b,0,0,d,e))):e&&d?(c.setAttribute("width",d),cavnas.setAttribute("height",e),"cover"===f?(h=d/b.width,i=e/b.width,g=Math.min(h,i),g<1?c.getContext("2d").drawImage(b,0,0,b.width/g,b.height/g):c.getContext("2d").drawImage(b,0,0,b.width,b.height)):"contain"===f?c.getContext("2d").drawImage(b,0,0,d,e):"whitespace"===f&&(h=d/b.width,i=e/b.width,g=Math.min(h,i),c.getContext("2d").drawImage(b,Math.max((d-b.width)/2,0),Math.max((e-b.height)/2,0),b.width,b.height))):(c.setAttribute("width",b.width),c.setAttribute("height",b.height),c.getContext("2d").drawImage(b,0,0,b.width,b.height))}}(),O=function(){var a=new Image,b=document.createElement("CANVAS");return function(c,d,e,f,g,h,i,j,k,l){var m=g.getContext("2d").getImageData(c,d,e,f);b.setAttribute("width",e),b.setAttribute("height",f),b.getContext("2d").putImageData(m,0,0),a.addEventListener("load",function(){N(this,h,i,j,"contain")},!1),l&&a.addEventListener("load",l,!1),a.src=b.toDataURL()}}();if(spotter.testLoaded(F),spotter.onResize(function(){F(),G();var a=h.width,b=h.height;A((h.canvas.width-a)/2,(h.canvas.height-b)/2,a,b),B()}),g.className="hide",v=a.getAttribute("src"))g.type="hidden",I(v,!0);else{g.type="file",g.className="hide";var Q,P=[];(Q=a.getAttribute("accept"))?(Q=Q.split(","),(~Q.indexOf("jpg")||~Q.indexOf("jpeg"))&&P.push("jpeg"),~Q.indexOf("gif")&&P.push("gif"),~Q.indexOf("png")&&P.push("png")):P.push("*"),P="image/"+P.join(",image/"),g.accept=P,a.addEventListener("click",function(a){a.stopPropagation(),g.click()},!1),g.addEventListener("change",J,!1)}g.name=a.getAttribute("name"),g.fileTarget=p.canvas,a.appendChild(g),a.hasAttribute("data-required")&&(g.setAttribute("data-required",""),(c=a.getAttribute("data-validate-name"))&&g.setAttribute("data-validate-name",c),g.form&&g.form.validator&&g.form.validator.setupInput(g)),b.onClose(E),p.width&&p.canvas.setAttribute("width",p.width),p.height&&p.canvas.setAttribute("height",p.height),h.canvas.addEventListener(spotter.mobile.events.mouse.mousedown,function(a){q.start=spotter.getRelativeMousePos(this,a),q.start.x<h.x+h.width&&q.start.x>h.x&&q.start.y<h.y+h.height&&q.start.y>h.y&&(q.start.x>i.x&&q.start.y>i.y?i.active=!0:h.active=!0)},!1),h.canvas.addEventListener(spotter.mobile.events.mouse.mouseout,function(a){h.active=!1,i.active=!1},!1),h.canvas.addEventListener(spotter.mobile.events.mouse.mouseup,function(a){h.active=!1,i.active=!1},!1),h.canvas.addEventListener(spotter.mobile.events.mouse.mousemove,function(a){if(h.active){q.end=spotter.getRelativeMousePos(this,a);var b=getVector(q),c=h.x+b.chgX,d=h.y+b.chgY;c<0?c=0:h.width+c>h.canvas.width&&(c=h.canvas.width-h.width),d<0?d=0:h.height+d>h.canvas.height&&(d=h.canvas.height-h.height),A(c,d,h.width,h.height),B(),q.start.x=q.end.x,q.start.y=q.end.y}},!1),h.canvas.addEventListener(spotter.mobile.events.mouse.mousemove,function(a){if(i.active){q.end=spotter.getRelativeMousePos(this,a);var c,d,b=getVector(q);if(p.aspect){if(Math.abs(b.chgX)>Math.abs(b.chgY)?(c=h.width+b.chgX,c+h.x>=h.canvas.width&&(c=h.canvas.width-h.x),(d=c/p.aspect)+h.y>=h.canvas.height&&(d=h.canvas.height-h.y,c=d*p.aspect)):(d=h.height+b.chgY,d+h.y>=h.canvas.height&&(d=h.canvas.height-h.y),(c=d*p.aspect)+h.x>=h.canvas.width&&(c=h.canvas.width-h.x,d=c/p.aspect)),h.maxWidth&&c>=h.maxWidth)return;if(h.minWidth&&c<=h.minWidth)return;if(h.maxHeight&&d>=h.maxHeight)return;if(h.minHeight&&d<=h.minHeight)return;A(h.x,h.y,Math.ceil(Math.max(c,0)),Math.ceil(Math.max(d,0)))}else c=h.width+b.chgX,c+h.x>=h.canvas.width&&(c=h.canvas.width-h.x),d=h.height+b.chgY,d+h.y>=h.canvas.height&&(d=h.canvas.height-h.y),h.maxWidth&&(c=Math.min(h.maxWidth,c)),h.maxHeight&&(d=Math.min(h.maxHeight,d)),h.minWidth&&(c=Math.max(h.minWidth,c)),h.minHeight&&(d=Math.max(h.minHeight,d)),A(h.x,h.y,Math.ceil(c,0),Math.ceil(d,0));B(),q.start.x=q.end.x,q.start.y=q.end.y}},!1),r.crop.addEventListener("click",K,!1),r.undo.addEventListener("click",L,!1),r.save.addEventListener("click",M,!1),a.reset=function(){var a=s.canvas;a.getContext("2d").clearRect(0,0,a.width,a.height),a=n.canvas,a.getContext("2d").clearRect(0,0,a.width,a.height),a=m.canvas,a.getContext("2d").clearRect(0,0,a.width,a.height),a=o.canvas,a.getContext("2d").clearRect(0,0,a.width,a.height),a=p.canvas,a.getContext("2d").clearRect(0,0,a.width,a.height),g.value=""}}};return m("spotter-image-cropper",{prototype:Object.create(HTMLDivElement.prototype,{createdCallback:{value:b}})}),spotter.events.fire(spotter.events("cropper-ready")),b}(),a.expandable=function(){var a=Object.create(HTMLElement.prototype);a.createdCallback=function(){j(this)&&(this.noProcess=!0),k(this)||(this.noProcess=!0)},a.attachedCallback=function(){if(this.noProcess)return!1;var a;return(a=this.getAttribute("expand-button"))&&(this.expandButton=document.getElementById(a))||(this.expandButton=this.querySelector(".button.expand"))?(a=this.getAttribute("collapse-button"))&&(this.collapseButton=document.getElementById(a))||(this.collapseButton=this.querySelector(".button.collapse"))?(this.content=this.querySelector(".content"))?(this.needToGetHeight=!0,spotter.onResize(this.setHeights),this.expandButton.parentExpandable=this.collapseButton.parentExpandable=this,this.expandButton.addEventListener("click",this.expandContent),this.collapseButton.addEventListener("click",this.collapseContent),void(~this.expandButton.className.indexOf("hide")?this.expandContent():this.collapseContent())):(console.warn("spotter collapseable elements require content"),this.noProcess=!0,!1):(console.warn("spotter collapseable elements require a collapse button"),this.noProcess=!0,!1):(console.warn("spotter expandable elements require an expand button"),this.noProcess=!0,!1)},a.expandContent=function(){var a=spotter.toggle,b="SPOTTER-EXPANDABLE"===this.tagName?this:this.parentExpandable;a.hide(b.expandButton),a.show(b.collapseButton),b.needToGetHeight&&(b.setHeights(),this.needToGetHeight=!1),Velocity(b.content,{height:b.contentHeight+"px",duration:500})},a.collapseContent=function(){var a=spotter.toggle,b="SPOTTER-EXPANDABLE"===this.tagName?this:this.parentExpandable;a.show(b.expandButton),a.hide(b.collapseButton),Velocity(b.content,{height:0,duration:500})},a.setHeights=function(){this.content.style.height=null,spotter.toggle.class.add(this.content,"force-open"),this.contentHeight=spotter.getHeight(this.content),spotter.toggle.class.remove(this.content,"force-open")},m("spotter-expandable",{prototype:a})}(),h["[data-modal-timer]"]=function(){},h["SPOTTER-MODAL-SELECT"]=a.popSelect,h["SPOTTER-INPUT-SEARCH"]=a.searchInput,h["SPOTTER-INPUT-SORT"]=a.sortInput,h["SPOTTER-MODAL-TEXTAREA"]=a.popUpTextArea,h["SPOTTER-AJAX-LIST"]=a.ajaxList,h["SPOTTER-SLOTS-SCROLLER"]=a.slotsScroller,a}();