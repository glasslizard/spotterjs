console.log("using form"),spotter.form=function(){window.validationCount=0,window.validationResults=[];var b=function(a,b){return a.validator=new d(a,b)},c=[],d=function(a,b){if(~c.indexOf(a))return console.error("form already registered in spotter.form",a,(new Error).stack),!1;if("string"==typeof a&&!(a=document.getElementById(a))||"FORM"!==a.tagName)return console.error("form passed as argument is not defined, not a form, or could not be found",a),!1;if(b&&"function"!=typeof b.complete&&"function"!=typeof b.success&&"function"!=typeof b.error){if("function"!=typeof b)return console.warn("argument ajaxFuncs for spotter form is not of the correct form",a,b,(new Error).stack),!1;b={complete:b}}a.hasAttribute("data-ajax-submit")&&spotter.form.setupAjaxSubmit(a,b),c.push(a);var g,h;spotter.form.validate;this.inpLvlValFuncs=[],this.messageBox=a.querySelector("[data-validation-messages]"),null===this.messageBox&&(this.messageBox=document.createElement("DIV"),this.messageBox.setAttribute("data-validation-messages","created by spotter forms"),a.appendChild(this.messageBox)),spotter.toggle.class.add(this.messageBox,"hide"),this.messageBox.show=function(a){return function(){1!==a.validate.status&&spotter.toggle.class.remove(a.messageBox,"hide")}}(this),this.messageBox.hide=function(a){return function(){1===a.validate.status&&spotter.toggle.class.add(a.messageBox,"hide")}}(this),this.validate=function(){for(var a=0,b=this.inpLvlValFuncs.length;a<b;a++)this.inpLvlValFuncs[a]();return 1===this.validate.status},this.validate.status=1,this.validate.failure=function(a){return function(b){a.validate.status*=b}}(this),this.validate.pass=function(a){return function(b){a.validate.status/=b}}(this);for(var m,g=a.querySelectorAll("INPUT"),h=-1,l=g.length;++h<l;)m=g[h],m.name&&(m.validate=new e(m,this));for(var m,g=a.querySelectorAll("TEXTAREA"),h=-1,l=g.length;++h<l;)m=g[h],m.name&&(m.validate=new e(m,this))};d.prototype.setupInput=function(a){a.name&&(a.validate=new e(a,this))};var e=function(a,b){this.frmLvlVal=b,this.input=a,this.funcs=[],this.result=[],this.current=1,this.name=a.getAttribute("data-validate-name")||a.name,this.msgBox=document.createElement("DIV"),spotter.form.initMsgBox(this.msgBox,this.frmLvlVal.messageBox),this.frmLvlVal.messageBox.appendChild(this.msgBox),this.initialBorderColor=a.style.borderColor,this.setOnFail(function(){this.style.borderColor="rgb(255,0,0)"}),this.setOnPass(function(){this.style.borderColor=this.initialBorderColor}),this.pattern(),this.required(),this.minLength(),this.maxLength(),this.matching()};return e.prototype.all=function(){this.result=[];for(var a=0,b=this.funcs.length;a<b;a++)this.funcs[a]()},e.prototype.setOnFail=function(a){this.onFail=function(){a.call(this.input)}},e.prototype.setOnPass=function(a){this.onPass=function(){a.call(this.input)}},e.prototype.patternTypes={pattern:2,matching:3,required:5,minLength:7,maxLength:11,between:13},e.prototype.isValid=function(a){return 1===this.current||void 0!==a&&this.current/this.patternTypes[a]==1},e.prototype.setFailure=function(a,b){var c=this.patternTypes[a];this.current%c!=0&&(this.current*=c,this.frmLvlVal.validate.failure.call(this.frmLvlVal,c))},e.prototype.unsetFailure=function(a){var b=this.patternTypes[a];this.current%b==0&&(this.current/=b,this.frmLvlVal.validate.pass.call(this.frmLvlVal,b))},e.prototype.report=function(){console.log("validation report:",this.input,this.current)},e.prototype.pattern=function(){var b,c,a=this.input;(b=a.getAttribute("data-validate"))||(b=a.getAttribute("data-validate-onchange"))?("between"===b.substring(0,7)&&(this.range=b.substring(8).trim().split("-"),b="between"),c={input:a,inpLvlVal:this,func:spotter.form.validate[b],pattern:b},void 0!==c.func?this.pattern=function(a){var b=c,d=b.inpLvlVal,e=b.func(b.input,d.name);"fail"===e.status?(d.setFailure("pattern"),d.msgBox.fail(e.message)):(d.unsetFailure("pattern"),1===d.current&&d.msgBox.pass())}:(c.func=spotter.form.validate.pattern,c.customMessage=a.getAttribute("data-validate-custom-message"),this.pattern=function(a){console.log(a);var b=c,d=b.inpLvlVal,e=b.func(b.input,b.pattern,d.name,c.customMessage);"fail"===e.status?(d.setFailure("pattern"),d.msgBox.fail(e.message)):(d.unsetFailure("pattern"),1===d.current&&d.inpLvlVal.msgBox.pass(e.message))}),this.funcs.push(this.pattern),this.frmLvlVal.inpLvlValFuncs.push(this.pattern),a.hasAttribute("data-validate-onchange")?(spotter.events.setEventTrigger(a,"change"),a.addEventListener("change",this.pattern,!1)):(spotter.events.setEventTrigger(a,"input"),a.addEventListener("input",this.pattern,!1))):this.pattern=null},e.prototype.required=function(){var b,a=this.input;a.hasAttribute("data-required")?(b={input:a,inpLvlVal:this},this.passRequired=function(){var a=b,c=a.inpLvlVal;c.unsetFailure("required"),1===c.current&&c.msgBox.pass()},~["file","radio","checkbox"].indexOf(a.type)&&"TEXTAREA"!==a.tagName?"file"===a.type&&(this.required=function(){var a=b,c=a.inpLvlVal,e=(a.input,spotter.form.validate.fileRequired(a.input,c.name));"fail"===e.status?(c.setFailure("required"),c.msgBox.fail(e.message)):(c.unsetFailure("required"),1===c.current&&c.msgBox.pass())},spotter.events.setEventTrigger(a,"change"),a.addEventListener("change",this.required,!1)):(this.required=function(){var a=b,c=a.inpLvlVal,d=spotter.form.validate.required(a.input,c.name);"fail"===d.status?(c.setFailure("required"),c.msgBox.fail(d.message)):(c.unsetFailure("required"),1===c.current&&c.msgBox.pass())},spotter.events.setEventTrigger(a,"focus"),a.addEventListener("focus",this.passRequired,!1)),this.frmLvlVal.inpLvlValFuncs.push(this.required)):this.required=null},e.prototype.maxLength=function(){var c,a=this.input,b=a.getAttribute("data-max-length");spotter.isType.numeric(b)?(c={input:a,inpLvlVal:this,length:Number(b)},this.maxLength=function(){var a=c,b=a.input,d=spotter.form.validation.maxLength(b,a.length,e.name),e=a.inpLvlVal;"fail"===d.status?(e.setFailure("maxLength"),e.msgBox.fail(d.message)):(e.unsetFailure("maxLength"),1===e.current&&e.msgBox.pass(d.message))},this.funcs.push(this.maxLength),this.frmLvlVal.inpLvlValFuncs.push(this.maxLength),spotter.events.setEventTrigger(a,"input"),a.addEventListener("input",this.maxLength,!1)):this.maxLength=null},e.prototype.minLength=function(){var c,a=this.input,b=a.getAttribute("data-min-length");spotter.isType.numeric(b)?(c={input:a,inpLvlVal:this,length:Number(b)},this.minLength=function(){var a=c,b=a.input,d=spotter.form.validation.minLength(b,a.length,e.name),e=a.inpLvlVal;"fail"===d.status?(e.setFailure("minLength"),e.msgBox.fail(d.message)):(e.unsetFailure("minLength"),1===e.current&&e.msgBox.pass())},this.funcs.push(this.minLength),this.frmLvlVal.inpLvlValFuncs.push(this.minLength),spotter.events.setEventTrigger(a,"input"),a.addEventListener("input",this.minLength,!1)):this.minLength=null},e.prototype.matching=function(){var c,d,e,a=this.input,b=this.frmLvlVal;(d=a.getAttribute("data-matching"))?(e=spotter.form.validate.matching(a,d,b,"All "+d+" inputs must have matching values"),c={input:a,inpLvlVal:this,groupName:d,validateFunc:e.checkFunc},this.matching=function(){var b=c.inpLvlVal;a.removeEventListener("change",b.matching,!1),spotter.form.validate.matching.addToActive(c.input,c.groupName),b.matching=c.validateFunc,b.matching(),b.funcs[b.funcs.indexOf(b.matching)]=b.matching,a.addEventListener("change",b.matching,!1)},this.funcs.push(this.matching),b.inpLvlValFuncs.push(e.checkAllFunc),spotter.events.setEventTrigger(a,"change"),a.addEventListener("change",this.matching,!1)):this.matching=null},b.validate={pattern:function(a,b,c,d){return new RegExp(b).test(a.value)?{status:"pass",type:"pattern",subType:"custom",name:a.name}:(d=d||"$[NAME] contains disallowed characters",d=d.replace("$[NAME]",d),{status:"fail",type:"pattern",subType:"custom",message:d.replace("$[NAME]",d),associated:a})},alpha:function(a,b){return/^[a-zA-Z\s_]*$/.test(a.value)?{status:"pass",type:"pattern",subType:"alpha",name:a.name}:{status:"fail",type:"pattern",subType:"alpha",message:b+" must contain only letters, spaces, or underscores (_)",associated:a}},numeric:function(a,b){return Number(a.value)||0===Number(a.value)?{status:"pass",type:"pattern",subType:"numeric",name:a.name}:{status:"fail",type:"pattern",subType:"numeric",message:b+" must contain only numbers",associated:a}},alphanumeric:function(a,b){return/^[\w\s]*$/.test(a.value)?{status:"pass",type:"pattern",subType:"alphanumeric",name:a.name}:{status:"fail",type:"pattern",subType:"alphanumeric",message:b+" must contain only letters, numbers, spaces, or underscores (_)",associated:a}},streetaddress:function(a,b){return/^[A-Za-z0-9'\.\-\s\,]*$/.test(a.value)?{status:"pass",type:"pattern",subType:"streetaddress",name:a.name}:{status:"fail",type:"pattern",subType:"streetaddress",message:b+" must be a properly formatted address with street number and street name",associated:a}},phone:function(a,b){if(a.value.length>0){if(a.value.replaceAll("[^0-9]","").length<10)return{status:"fail",type:"pattern",subType:"phone",message:b+" must be a full 10-digit phone number including area code",associated:a}}return{status:"pass",type:"pattern",subType:"phone",name:a.name}},phoneint:function(a,b){if(a.value.length>0){if(a.value.replaceAll("[^0-9]","").length<11)return{status:"fail",type:"pattern",subType:"phoneint",message:b+" must be a full internation phone number including area code and country code",associated:a}}return{status:"pass",type:"pattern",subType:"phoneint",name:a.name}},day:function(a,b){return a.value>-1&&a.value<32?{status:"pass",type:"pattern",subType:"day",name:a.name}:{status:"fail",type:"pattern",subType:"day",message:b+" exceeded the range for a day of the month.",associated:a}},zipcodedom:function(a,b){return!/^[0-9]{5}$/.test(a.value)&&a.value.length>0?{status:"fail",type:"pattern",subType:"zipcodedom",message:b+" must be a 5 digit US zip code",associated:a}:{status:"pass",type:"pattern",subType:"zipcodedom",name:a.name}},zipcodeint:function(a,b){return!/^[0-9a-zA-Z\s]{5,}$/.test(a.value)&&a.value.length>0?{status:"fail",type:"pattern",subType:"zipcodeint",message:b+" must be a valid postal code",associated:a}:{status:"pass",type:"pattern",subType:"zipcodeint",name:a.name}},country:function(a,b){return!/^[a-zA-Z\s]+$/.test(a.value)&&a.value.length>0?{status:"fail",type:"pattern",subType:"country",message:b+" must be a 5 digit US zip code",associated:a}:{status:"pass",type:"pattern",subType:"country",name:a.name}},email:function(a,b){return!/^.+@.+\..+$/.test(a.value)&&a.value.length>0?{status:"fail",type:"pattern",subType:"email",message:b+" must be a valid email like user@domain.tld",associated:a}:{status:"pass",type:"pattern",subType:"email",name:a.name}},password:function(a,b){if(a.value.length>19&&a.value.length<41)return{status:"pass",type:"pattern",subType:"password",name:a.name};if(!a.value.length)return{status:"pass",type:"pattern",subType:"password",name:a.name};if(/[!@#$%\^&\*]/.test(a.value))if(/[A-Z]/.test(a.value))if(/[0-9]/.test(a.value)){if(a.value.length>6&&a.value.length<41)return{status:"pass",type:"pattern",subType:"password",name:a.name};$error="<li>Must be a minimum of 6 characters and a maximum of 40.</li>"}else $error="<li>Must contain at least one number.</li>";else $error="<li>Must contain at least one capital letter.</li>";else $error="<li>Must contain at least one of the following: ! @ # $ % ^ & *</li>";return{status:"fail",type:"pattern",subType:"password",message:"<ul><li>"+b+" must meet the following requirement:</li>"+$error+"<li>OR</li><li>Your password can be at least 20 characters in length (Max 40).</li></ul>",associated:a}},between:function(a,b){var c=a.validate.range;return!a.value.length||Number(a.value)>=Number(c[0])&&Number(a.value)<=Number(c[1])?{status:"pass",type:"pattern",name:a.name}:{status:"fail",type:"pattern",subType:"between",message:b+" must be between "+c[0]+" and "+c[1],associated:a}},required:function(a,b){return!a.value.length>0?{status:"fail",type:"required",message:b+" cannot be empty",associated:a}:{status:"pass",type:"required",name:a.name}},fileRequired:function(a,b){return 0===a.files.length?{status:"fail",type:"required",message:b+" must have a file specified",associated:a}:{status:"pass",type:"required",name:a.name}},minlength:function(a,b,c){return a.value.length&&a.value.length<b?{status:"fail",type:"required",message:c+" must be more than "+(Number(b)-1)+" characters in length.",associated:a}:{status:"pass",type:"minLength",name:a.name}},maxlength:function(a,b,c){return a.value.length&&a.value.length>b?{status:"fail",type:"required",message:c+" must be under "+(Number(b)+1)+" characters.",associated:a}:{status:"pass",type:"maxLength",name:a.name}},matching:function(){var a={groups:{}},b=function(b,c,d,e){var f;return void 0===a[c]?(a[c]={members:[],value:null},a[c].activeMembers=[],a[c].checkFunc=spotter.form.validate.matching.createCheckFunc(c,"activeMembers"),a[c].checkAllFunc=spotter.form.validate.matching.createCheckFunc(c,"members"),a[c].msgBox=[f=document.createElement("DIV")],a[c].frmLvlVal=[d],f.innerHTML=e,f.className="hide",d.messageBox.appendChild(f),spotter.form.validate.matching.setOnFail(c,function(){this.style.borderColor="rgb(255,0,0)"}),spotter.form.validate.matching.setOnPass(c,function(){this.style.borderColor=null})):~a[c].frmLvlVal.indexOf(d)||(a[c].msgBox.push(f=document.createElement("DIV")),f.innerHTML=e,d.messageBox.appendChild(f),a[c].frmLvlVal.push(d)),a[c].members.push(b),a[c]};return b.addToActive=function(b,c){a[c].activeMembers.push(b)},b.createCheckFunc=function(b,c){var d=a[b],c=c||"activeMembers";return function(){for(var a,e=d[c].length-1,f=d[c][e].value;--e>-1;)if(a=d[c][e],a.value!=f)return d.onFail(),{status:"fail",type:"matching",message:"the "+b+" inputs must match",associated:b};return d.value=f,d.onPass(),{status:"pass",type:"matching",associated:b}}},b.setOnFail=function(b,c){a[b].onFail=function(){a[b].members.forEach(function(a){c.call(a),a.validate.setFailure("matching")}),a[b].msgBox.forEach(function(a){spotter.toggle.class.remove(a,"hide")}),a[b].frmLvlVal.forEach(function(a){a.messageBox.show()})}},b.setOnPass=function(b,c){a[b].onPass=function(){a[b].members.forEach(function(a){c.call(a),a.validate.unsetFailure("matching")}),a[b].msgBox.forEach(function(a){spotter.toggle.class.add(a,"hide")}),a[b].frmLvlVal.forEach(function(a){a.messageBox.hide()})}},b.onFail=function(b){a[b].onFail()},b.onPass=function(b){a[b].onPass()},b}()},b.initMsgBox=function(a,b){a.fail=function(a){this.innerHTML=a,spotter.toggle.class.remove(this,"hide"),b.show()},a.pass=function(){spotter.toggle.class.add(this,"hide"),b.hide()}},b.setInputValues=function(a,b){b=b||document;var c,d,e,f,g;for(var h in a)if(void 0!==(c=b.getElementsByName(h)))for(f=c.length;--f>-1;)switch(d=c[f].tagName,e=c[f],d){case"SELECT":for(f=e.options.length;--f>-1;)e.options[f].value===a[h]&&(e.options[f].selected="selected");break;case"INPUT":if("file"===(g=e.type)){console.error("set input values cannot set values for file type inputs",e);break}if("radio"===g||"checkbox"==g){e.checked=e.value===a[h];break}case"TEXTAREA":e.value=a[h];break;default:console.error("set input values did not recognize how to handle a target elem:",e)}},b.imageInput=function(a){var b=function(){};return b.showImage=function(b){var c=function(){if(a.files&&a.files[0]){var c=new FileReader;c.onload=function(a){b.src=a.target.result},c.readAsDataURL(a.files[0])}};a.addEventListener("change",c,!1)},b},b.setupAjaxSubmit=function(a,b,c){b=b||{};var d={active:!1},e=function(c){if(spotter.preventDefault(c),d.active)return console.log("wait for request to complete"),!1;if(a.validator.disableSubmit)return console.log("submit is currently disabled (for validator at least)"),!1;if(!a.validator.validate())return console.log("validation failed"),!1;d.active=!0,spotter.cookie.commit(),null!==(a.ajaxWaitingScreen=a.getAttribute("data-ajax-waiting"))&&(a.ajaxWaitingScreen=document.getElementById(a.ajaxWaitingScreen));var e=!0;null!==a.getAttribute("data-ajax-sync")&&(e=!1);var f={url:a.action,data:a,method:a.method||"POST",async:e,cache:!1};return function(a){"function"==typeof b.success&&(f.success=function(c,d){b.success.call(this,c,d,a)}),"function"==typeof b.error&&(f.error=function(c,d){b.error.call(this,c,d,a)}),f.complete=function(c,e){"undefined"!==a.ajaxWaitingScreen&&null!==a.ajaxWaitingScreen&&spotter.toggle.hide(a.ajaxWaitingScreen),d.active=!1,"function"==typeof b.complete&&b.complete.call(this,c,e,a)}}(this),spotter.ajax(f),"undefined"!==a.ajaxWaitingScreen&&null!==a.ajaxWaitingScreen&&spotter.toggle.show(a.ajaxWaitingScreen),!1};a.addEventListener("submit",e,!1),a.displayAjaxError=function(a){document.body.appendChild(a),a.id="spotter-form-errors-display";var b=function(){this.style.display="none"};return a.addEventListener("click",b,!1),function(b){a.style.display="block";var d,c="";for(d in b)c+=b[d];a.innerHTML=c}}(document.createElement("DIV"))},b.setInput=function(a,b){if("radio"===a.type&&a.name)for(var c=a.form[a.name],d=c.length;--d>-1;)String(c[d].value)===String(b)?c[d].checked=!0:c[d].checked=!1;else if("checkbox"===a.type)b.length>0&&a.setAttribute("checked","true");else if("SELECT"===a.tagName)for(var e=a.options,d=e.length;--d>-1;)e[d].value==b?(e[d].setAttribute("selected","true"),a.selectedIndex=d):e[d].removeAttribute("selected");else a.value=b},b}(),console.log("forms loaded");