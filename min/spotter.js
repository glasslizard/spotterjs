"use strict";function baseSort(a,b){var a=(""+a).toLowerCase(),b=(""+b).toLowerCase();return a===b?0:a<b?-1:1}function merge(a,b,c,d,e,f){for(var g=d,h=e+1,i=d;;)if(a(b[g],b[h])<=0){if(c[i++]=b[g++],g>e){do{c[i++]=b[h++]}while(h<=f);break}}else if(c[i++]=b[h++],h>f){do{c[i++]=b[g++]}while(g<=e);break}}function sortarrtoaux(a,b,c,d,e){if(!(e<d)){if(e==d)return void(c[d]=b[d]);var f=Math.floor(d+(e-d)/2);sortarrtoarr(a,b,c,d,f),sortarrtoarr(a,b,c,f+1,e),merge(a,b,c,d,f,e)}}function sortarrtoarr(a,b,c,d,e){if(!(e<=d)){var f=Math.floor(d+(e-d)/2);sortarrtoaux(a,b,c,d,f),sortarrtoaux(a,b,c,f+1,e),merge(a,c,b,d,f,e)}}function getVector(a){var e,b=a.end.x-a.start.x,c=a.end.y-a.start.y,d=Math.sqrt(b*b+c*c);return e=b<0?c<0?"0":c>0?"2":"4":b>0?c<0?"1":c>0?"3":"5":c<0?"6":c>0?"7":"no change",{chgX:b,chgY:c,L:d,quadrant:e}}function canvasToBlob(a,b,c){for(var d=a.toDataURL(b,c),e=atob(d.split(",")[1]),f=e.length,g=new Uint8Array(f);f--;)g[f]=e.charCodeAt(f);var h=new Blob([g],{type:b});return console.log("the blob size:",h.size/1e3),console.log("canvas size:",a.width),h}function getScrollPos(a){var b=document.documentElement,c=(window.pageXOffset||b.scrollLeft)-(b.clientLeft||0),d=(window.pageYOffset||b.scrollTop)-(b.clientTop||0);return"top"===a?d:"left"===a?c:[d,c]}function CustomEvents(a,b){var c;for(c in a)a.hasOwnProperty(c)&&(this[c]=a[c]);this.timeStamp=Date.now(),this.type="CustomEvent",this.listenerName=b,this.cancelled=!1}function CustomEventsDispatcher(a){this.__registeredListeners={},this.__source=a}function fastArray(a){this.pointer=0,this.length=0,this.size=a,this.values=new Array(a),this.searchVal=null,this.namedSets={}}window.onloadFunctions=[];var spotter={};spotter.static={classes:{placeholder:"placeholder-active"}},Array.prototype.mergeSort=function(a){a=a||baseSort;var c,b=this.length;if(0!==b)return b<3&&this.sort(a),c=this.slice(0),sortarrtoarr(a,this,c,0,this.length-1),this},Array.prototype.indexSort=function(a){a=a||baseSort;for(var e,f,i,b={},c=[],d=this.length,g=!1,j=0;--d>-1;)i=this[d],f=0===i.length?"":(""+i)[0].toLowerCase(),e=b[f],void 0===e?(b[f]=[i],c.insertSort([f],a)):(g=!0,e.push(i));if(this.splice(0),d=c.length,g)for(j;j<d;j++)Array.prototype.push.apply(this,b[c[j]].mergeSort(a));else for(j;j<d;j++)Array.prototype.push.apply(this,b[c[j]])},Array.prototype.insertSort=function(a,b){if(b=b||baseSort,a.length>1&&a.sort(b),0===this.length)return void Array.prototype.push.apply(this,a);for(var c,d=a.pop(),f=this.length-1;f>-1&&void 0!==d;)c=this[f],b(d,c)>=0?(this.splice(f+1,0,d),d=a.pop()):--f;return-1===f&&(a.push(d),Array.prototype.unshift.apply(this,a)),this},document.cb_addEventListener=function(){if(document.addEventListener)var a=function(a,b,c){this.addEventListener(a,b,c)};else var a=function(a,b,c){this.attachEvent("on"+a,b)};return a}(),document.cb_removeEventListener=function(){if(document.removeEventListener)var a=function(a,b,c){this.removeEventListener(a,b,c)};else var a=function(a,b,c){this.detachEvent("on"+a,b)};return a}(),document.querySelectorAll||(jQuery?document.querySelector=function(a){return jQuery(a)[0]}:document.querySelectorAll=function(a){var b,c,d,e,f,g,h;if(-1!==a.indexOf("#")){if(c=a.split("#"),c=c.last().split(" "),1===c.length)return document.getElementById(c[0].match(/^([^#\.]+)/)[1]);b=[document.getElementById(c[0])]}else c=a.split(" "),d=c.length;for(h=0;h<d;h++){for(e=b.length;e;)for(e--,g=document.getElementsByTagName(c[h].match(/^([^.]+)/)[1])||b.children||b.childNodes,f=g.length;f;)f--,b[e][g[f]].className.split(" ").hasList(c[h].replace(".",","))||g.splice(f,1);b=g}return g}),RegExp.escape||(RegExp.escape=function(a){return a.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}),Array.prototype.last||(Array.prototype.last=function(){return this[this.length-1]}),Array.prototype.indexOf||(Array.prototype.indexOf=function(a){for(var b=this.length;b;)if(b--,this[b]==a)return b;return-1}),Array.prototype.hasList=function(a,b){b.delimiter||(b.delimiter=","),b.ordermatters||(b.ordermatters=!1);var d=(this.length,a.split(b.delimiter)),e=d.length;if(b.ordermatters){for(;e;)if(!this[e]==d[e])return!1}else for(;e;)if(e--,!this.indexOf(d[e]))return!1;return!0},Array.prototype.removeValues||(Array.prototype.removeValues=function(){for(var a,d,b=arguments,c=b.length;c&&this.length;)for(a=b[--c];-1!==(d=this.indexOf(a));)this.splice(d,1);return this}),Array.prototype.changeCSS||(Array.prototype.changeCSS=function(a,b){for(var c=this.length;--c>l;)this[c].style[a]=b}),Array.prototype.arrayWalk||(Array.prototype.arrayWalk=function(a){var b=this.length,c=0;for(c;c<b;c++)this[b]=a(this[b])}),Array.prototype.clone||(Array.prototype.clone=function(){return this.slice(0)}),Array.prototype.merge||(Array.prototype.merge=function(){var a=0,b=arguments,c=b.length;for(a;a<c;a++)Array.prototype.push.apply(this,b[a]);return this}),Array.prototype.mergeDistinct||(Array.prototype.mergeDistinct=function(){var b,a=function(a){return-1===b.indexOf(a)};return function(){b=this;var c=0,d=arguments,e=d.length;for(c;c<e;c++)Array.prototype.push.apply(this,d[c].filter(a));return this}}()),Array.prototype.xProd||(Array.prototype.xProd=function(){var a,b=arguments,c=b.length,d=b[0];for(a=1;a<c;a++)Array.prototype.push.apply(d,b[a]);for(c=this.length;--c>-1;)~d.indexOf(this[c])||this.splice(c,1);return this}),Array.prototype.mergeAll||(Array.prototype.mergeAll=function(){for(Array.isArray(this[0])||(this[0]=[this[0]]);void 0!==this[1];)Array.prototype.push.apply(this[0],this[1]),this.splice(1,1);return Array.prototype.push.apply(this,this[0]),this.shift(),this}),Array.prototype.unique=function(){for(var a=this.length;--a>-1;)this.indexOf(this[a])!==a&&this.splice(a,1);return this},Array.prototype.cloneRows=function(){var e,f,g,a=Object.keys(this[0]),b=this.length,c=a.length,d=[];for(f=0;f<b;f++){for(row=this[f],g={},e=0;e<c;e++)g[a[e]]=row[a[e]];d.push(g)}return d},Array.empty=function(a){return!a||0===a.length||!Array.isArray(a)},Array.getRowFieldValues=function(){var a,b=function(b){return b[a]};return function(c,d){return a=d,c.map(b)}}(),Math.toPercent=function(a,b){return 100*Number(a)+"%"},Math.fromPercent=function(a){return parseFloat(a)/100},Number.prototype.toPrecision=function(){var a=this.toString().match(/^\d*\.{0,1}\d{0,2}/);return Number(a)},window.offSetY=function(){if(window.pageYOffset)var a=function(){return window.pageYOffset};else var a=function(a){return"number"==a.scrollTop?function(){return a.scrollTop}:function(){return document.body.scrollTop}}(document.documentElement||document.body.parentNode);return a}(),String.prototype.stringDifference=function(a){for(var b=this.length-1,c=0;c<b;c++)if(a.charAt(c)!==this.charAt(c))return a.substr(c);return a.substr(c)},String.prototype.replaceAll||(String.prototype.replaceAll=function(a,b){return this.replace(new RegExp(a,"g"),b)}),String.prototype.replaceAllNoCase||(String.prototype.replaceAllNoCase=function(a,b){return this.replace(new RegExp(a,"ig"),b)}),String.prototype.replaceNoCase||(String.prototype.replaceNoCase=function(a,b){return this.replace(new RegExp(a,"i"),b)}),String.prototype.replaceAllUsing||(String.prototype.replaceAllUsing=function(){var a,b=function(b,c){return a[c.toLowerCase()]};return function(c,d){return a=d,this.replace(new RegExp(c,"g"),b)}}()),String.prototype.toggleListValue||(String.prototype.toggleListValue=function(a,b){if(a=a.toString(),!this.length)return a;if(this===a)return"";void 0===b&&(b=",");var c=this.split(b);return-1===(i=c.indexOf(a))?c.join(b)+b+a:c.removeValues(a).join(b)}),String.prototype.removeListValue||(String.prototype.removeListValue=function(a,b){if(!this.length||this===a)return"";void 0===b&&(b=",");var c=this.split(b);return Array.isArray(a)?Array.prototype.removeValues.apply(c,a).join(","):(a=""+a,c.removeValues(a).join(b))}),String.prototype.addListValue||(String.prototype.addListValue=function(a,b){if(Array.isArray(a)){if(console.log("addListValue contactIds"),0===this.length||this===a)return a;void 0===b&&(b=",");var c=this.split(b);return c.push(a),c.unique().join(b)}if(console.log("addListValue contactIds"),a=""+a,0===this.length||this===a)return a;void 0===b&&(b=",");var c=this.split(b);return-1!==c.indexOf(a)?this:(c.push(a),c.join(b))}),String.prototype.forEach=function(a){for(var b=this.length,c=0;c<b;)a(this[c],c,this),c++},String.prototype.decodeHTML||(String.prototype.decodeHTML=function(){return decodeURI(this.replaceAll("[\\r\\t\\n]"," ").replaceAll("&lt;","<").replaceAll("&gt;",">"))}),String.prototype.forEach||(String.prototype.forEach=function(a){for(var b=this.length,c=0;c<b;)a(this[c],c,this),c++}),String.prototype.encodeURLParam=function(){return encodeURIComponent(this).replace(/[!'()*]/g,function(a){return"%"+a.charCodeAt(0).toString(16)}).replace("%20","+")},void 0===Element.prototype.matches&&(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(a){for(var b=this.parentNode,c=b.querySelectorAll(a),d=c.length;--d>-1&&c[d]!==this;);return d>-1}),void 0===XMLHttpRequest.prototype.sendAsBinary&&(XMLHttpRequest.prototype.sendAsBinary=function(a){var b=Array.prototype.map.call(a,function(a){return 255&a.charCodeAt(0)});this.send(new Uint8Array(b).buffer)}),Storage.prototype.registry={},Storage.prototype.setObject=function(a,b){if("object"!=typeof b)return console.warn("store object failed bc value is not an object",b,(new Error).stack),!1;this.setItem(a,JSON.stringify(b))},Storage.prototype.getObject=function(a){var b=this.getItem(a);return"[object Object]"==b?(console.warn("for some reason a non object is being saved for registry"),{}):b&&JSON.parse(b)},Storage.prototype.register=function(a,b,c){var e;!c&&this.registry[a]||(e=Date.now(),b=b?b+e:null,this.registry[a]={date:e,expires:b})},Storage.prototype.getRegisteredObject=function(a){var c,b=this.registry[a];return void 0!==b&&(null!==b.expiration&&Date.now()>b.expiration?(delete this.registry[a],!1):(c=this.getItem(a))&&c&&JSON.parse(c))},Storage.prototype.getRegistry=function(a){return a?this.registry[a]:this.registry},Storage.prototype.removeExpired=function(a){var b,e,c=Date.now(),d=[];a?(e=this.registry[a],e[a]=e):e=this.registry;for(b in e)c>e[b].expires&&(this.removeItem("prop"),d.push(b));return d},localStorage.removeExpired(),sessionStorage.removeExpired();try{localStorage.registry=localStorage.getObject("registry")||{},sessionStorage.registry=sessionStorage.getObject("registry")||{}}catch(a){console.warn("An error occurred using local storage \n","error: \n",a)}HTMLCanvasElement.prototype.toBlob||(HTMLCanvasElement.prototype.toBlob=function(a,b,c){for(var d=this.toDataURL(b,c),e=atob(d.split(",")[1]),f=e.length,g=new Uint8Array(f);f--;)g[f]=e.charCodeAt(f);var h=new Blob([g],{type:b});a.call(this,h)}),CustomEvent.prototype.stopImmediatePropagation=function(){this.cancelled=!0},CustomEventsDispatcher.prototype.__evtFunctions=function(a){return void 0===this.__registeredListeners[a]?this.__registeredListeners[a]=[]:this.__registeredListeners[a]},CustomEventsDispatcher.prototype.__addEventListener=function(a,b){var c=this.__evtFunctions(a);~c.indexOf(b)||c.push(b)},CustomEventsDispatcher.prototype.__removeEventListener=function(a,b){var d,c=this.__registeredListeners[a];if(void 0===c)return console.warn("cannot remove func from event listener because event listener does not exist for target",this,a,b),!1;d=c.indexOf(b),c.splice(d,1)},CustomEventsDispatcher.prototype.__dispatchEvent=function(a){for(var b=this.__registeredListeners[a.listenerName],c=b.length,d=-1;++d<c&&!a.cancelled;)b[d].call(this.__source,a);return!a.defaultPrevented},fastArray.prototype.next=function(){for(var a=this.values.length;void 0===this.values[++this.pointer]&&this.pointer<a;);return this.values[this.pointer]||null},fastArray.prototype.prev=function(){for(this.values.length;void 0===this.values[--this.pointer]&&this.pointer>-1;);return this.values[this.pointer]||null},fastArray.prototype.current=function(){return this.values[this.pointer]||null},fastArray.prototype.first=function(){return this.pointer=0,this.values[0]},fastArray.prototype.last=function(){return this.pointer=this.length,this.values[this.length]},fastArray.prototype.getAt=function(a){return this.pointer=a,this.values[a]},fastArray.prototype.setAt=function(a,b){return a>this.length-1?(console.error("cannot set value ("+b+") in fast array - index ("+a+") exceeds length"),this):(this.values[a]=b,this)},fastArray.prototype.push=function(a){return this.values.length<this.length+1&&this.values.concat(Math.floor(new Array(this.size/2))),this.values[this.length++]=a,this.length},fastArray.prototype.concat=function(a){this.values.length<this.length+a.length&&this.values.concat(Math.floor(new Array(Math.max(this.size/2,this.length+2*a.length))));var b=0,c=a.length;for(b;b<c;b++)this.values[this.length++]=a[b];return this.length},fastArray.prototype.unique=function(){return Array.prototype.unique.call(this)},fastArray.prototype.mergeDistinct=function(a){this.values.length<this.length+a.length&&this.values.concat(Math.floor(new Array(Math.max(this.size/2,this.length+2*a.length))));var d,b=0,c=a.length;for(b;b<c;b++)d=a[b],~this.indexOf(d)||(this.values[this.length++]=d);return this.length},fastArray.prototype.pop=function(a){return this.values[this.length--]||null},fastArray.prototype.slice=function(a,b){b=b||this.length,a<0?a=this.length+a:b>this.length&&(b=this.length);var c=new Array(b-a),d=0;for(a;a<b;a++)c[d++]=this.values[a];return c},fastArray.prototype.splice=function(a,b,c){var d=0;for(this.values.length<b+1&&this.values.concat(Math.floor(new Array(Math.max(this.size/2,4*(b-this.values.length)))));a<b;)this.values[a++]=c[d++]||void 0;return this},fastArray.prototype.spliceAt=function(a,b){var c=a+b.length,d=0;for(c>this.values.length&&this.values.concat(Math.floor(new Array(Math.max(this.size/2,4*(c-this.values.length))))),a;a<c;a++)this.values[a]=b[d++]||void 0;return this},fastArray.prototype.insert=function(a,b){var c=this.length+b.length,e=(--this.length,this.length);for(c>this.values.length&&this.values.concat(Math.floor(new Array(Math.max(this.size/2,4*(c-this.values.length))))),this.length=c;--c>a;)this.values[c]=this.values[e--];for(var f=b.length,g=0;g<f;)this.values[++a]=b[g++];return this},fastArray.prototype.indexOf=function(a){for(this.searchVal=a,this.pointer=0,this.pointer;this.pointer<this.length;this.pointer++)if(this.values[this.pointer]===a)return this.pointer;return this.pointer=0,-1},fastArray.prototype.lastIndexOf=function(a){for(void 0!==a?this.searchVal=a:a=this.searchVal,this.pointer=this.length;--this.pointer;)if(this.values[this.pointer]===a)return this.pointer;return-1},fastArray.prototype.indexOfNext=function(a){for(void 0!==a?this.searchVal=a:a=this.searchVal,++this.pointer;this.pointer<this.length;this.pointer++)if(this.values[this.pointer]===a)return this.pointer;return-1},fastArray.prototype.indexOfPrev=function(a){if(void 0!==a?this.searchVal=a:a=this.searchVal,0===this.pointer)return-1;for(;--this.pointer>-1;)if(this.values[this.pointer]===a)return this.pointer;return this.pointer=0,-1},fastArray.prototype.forEach=function(a){var b=0,c=this.length,d=this.values;for(b;b<c;b++)void 0!==d[b]&&!1===a(d[b],b,this)&&b--;return this},fastArray.prototype.clean=function(a){var b=0,c=this.length,d=this.values,e=0,f=this.pointer;if("function"!=typeof a)for(b;b<c;b++)value=d[b],void 0===value?e++:(e>0&&(d[b-e]=value),f===b&&(this.pointer-=e));else for(b;b<c;b++)value=d[b],void 0===value?e++:(e>0&&(d[b-e]=a(value,b,b-e,this)),f===b&&(this.pointer-=e));return this.length-=e,this},fastArray.prototype.clear=function(){this.length=0,this.pointer=0},fastArray.prototype.mergeSort=function(a){a=a||baseSort;var c,b=this.length;if(0!==b)return b<3&&this.sort(a),c=this.slice(0),sortarrtoarr(a,this.values,c,0,this.length-1),this},fastArray.prototype.insertSort=function(a,b){Array.isArray(a)&&a.mergeSort(b);var f,h,c=0,d=0,e=this.length,g=[];for(d;d<e;d++){for(f=this.values[d];(h=a[c])&&b(h,f)<1;)g.push(h),c++;g.length>0&&(this.insert(d,g),g=[])}c<a.length&&this.concat(a.slice(c))},fastArray.prototype.namedSet=function(a,b,c){},function(){var a=document||documentElement,c={};window.height=window.innerHeight||a.clientHeight||a.getElementsByTagName("BODY")[0].clientHeight,window.width=window.innerWidth||a.clientWidth||a.getElementsByTagName("BODY")[0].clientWidth,window.addEventListener("resize",function(){window.height=window.innerHeight||a.clientHeight||a.getElementsByTagName("BODY")[0].clientHeight},!1),spotter.preLoaded=[],spotter.testLoaded=function(a,b){spotter.preLoaded.push([a,b])},spotter.makeId=function(){var a=[];return function(b){var c="",d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",b=b||5;do{for(var e=0;e<b;e++)c+=d.charAt(Math.floor(Math.random()*d.length))}while(-1!==a.indexOf(c));return a.push(c),c}}(),spotter.events=function(){var a={},b=function(b,c){if(b in a){if(!0===c)return b;b+=spotter.makeId(5)}return a[b]=document.createEvent("HTMLEvents"),a[b].initEvent(b,!0,!0),b};if(b.appendTo=function(b,c){a[c].content=a[c].content||{};for(var d in b)a[c].content[d]=b[d]},b.fire=function(b){void 0===a[b]&&console.log("The event "+b+" sent to spotter.events.fire is not a registered event"),document.dispatchEvent(a[b])},document.createEvent&&document.dispatchEvent)b.setEventTrigger=function(a,b){if(spotter.isType.element(a)){if(a.eventTriggers=a.eventTriggers||{},void 0!==a.eventTriggers[b])return!1;var d=document.createEvent("HTMLEvents"),e="on"===b.substring(0,2)?b.substring(2):b;d.initEvent(e,!0,!0),a.eventTriggers[b]=function(a,b){return function(c,d){void 0!==d&&(b.arguments=d),void 0!==c&&(a.originalEvent=c),c&&(b.spotterTarget=c.target||c.srcElement||c.originalTarget),a.dispatchEvent(b)}}(a,d)}else c(a,b);return b};else{if(!document.fireEvent)return console.warn("custom events are not supported either by fireEvent or createEvent"),!1;b.setEventTrigger=function(a,b){return b="on"!==b.substring(0,2)?"on"+b:b,a.eventTriggers[b]=function(a){return function(){a.fireEvent(b)}}(a),b}}var c=function(){var a=[],b=[];return function(c,d){var f,e=a.indexOf(c);~e?void 0===c.eventTriggers[d]&&(f=b[e],f.__evtFunctions(d),function(a,b){c.eventTriggers[b]=function(c){var d=new CustomEvents(c,b);a.__dispatchEvent.call(a,d)}}(f,d)):(f=new CustomEventsDispatcher(c),c.eventTriggers={},f.__evtFunctions(d),function(a,b){c.addEventListener=function(b,c){a.__addEventListener.call(a,b,c)},c.removeEventListener=function(b,c){a.__removeEventListener.call(a,b,c)},c.eventTriggers[b]=function(c){var d=new CustomEvents(c,b);a.__dispatchEvent.call(a,d)}}(f,d),e=a.push(c)-1,b[e]=f)}}();return b.setDelegatedEvent=function(a,b,c,d,e){"string"==typeof d?b.addEventListener(a,function(a){var b=a.spotterTarget||a.target||a.srcElement||a.originalTarget;do{if(b.matches(d))return c.call(b,a),!1;b=b.parentNode}while(b!==this)},e?e.capture:void 0,e):b.addEventListener(a,function(a){var b=a.spotterTarget||a.target||a.srcElement||a.originalTarget;do{if(b.parentNode===this)return c.call(b,a),!1;b=b.parentNode}while(b!==this)},e?e.capture:void 0,e)},b.swipeEvents=function(a,b,c,d){c=c||500,b=b||150,d=d||["horizontal","vertical"];var j,k,l,m,n,o,p,j,e=~d.indexOf("vertical"),f=~d.indexOf("horizontal"),g=b,h=b,i=!1,q=[],e=~d.indexOf("vertical"),f=~d.indexOf("horizontal");if(a.hasAttribute("max-swipe-time")&&(c=a.getAttribute("max-swipe-time")),a.hasAttribute("min-swipe-distance")&&(b=a.getAttribute("min-swipe-distance"),g=b,h=b),~b.toString().indexOf("%")){if(e){var r=spotter.getHeight(a);g=b.slice(0,-1)/100*r}if(f){var s=spotter.getWidth(a);h=b.slice(0,-1)/100*s}}a.addEventListener("mousedown",function(a){j=a,i=!0,k=(new Date).getTime(),m=a.clientX,n=a.clientY},!1);var t=function(b){if(!1!==i){if(i=!1,l=(new Date).getTime(),o=b.clientX,p=b.clientY,l-k<=c){var d=u();d?a.eventTriggers["swipe"+d](j,{target:j.originalTarget||j.target}):console.debug(q)}else console.debug("time too long "+(l-k).toString());q=[]}};a.addEventListener("mouseup",t,!1),a.addEventListener("mouseout",t,!1);var u=function(){var a=o-m,b=p-n,c=Math.abs(a),d=Math.abs(b);if(d<g&&c<h)return q.push("distance too short X:"+c+" Xmin:"+h+" Y:"+d+" Ymin:"+g),!1;if(a>0){if(f&&c>d)return"right";if(e)return b>0?"down":"up"}else{if(f&&c>d)return"left";if(e)return b>0?"down":"up"}};f&&(spotter.events.setEventTrigger(a,"swiperight"),spotter.events.setEventTrigger(a,"swipeleft")),e&&(spotter.events.setEventTrigger(a,"swipeup"),spotter.events.setEventTrigger(a,"swipedown"))},b.swipeEvents.minSwipeDistance="40%",b.scrollEndEvent=function(a,b){var c={minInterval:b||800,start:(new Date).getTime(),now:null,timer:null,scrollBox:a};c.process=function(b){c.timer=function(b){return a.eventTriggers.scrollEnd(b),null}(b),c.start=(new Date).getTime()};var d=function(a){c.now=(new Date).getTime(),null===c.timer&&(c.now-c.start>c.minInterval&&c.process(a),c.timer=window.setTimeout(function(){c.process(a)},c.minInterval))};spotter.events.setEventTrigger(a,"scrollEnd"),a.addEventListener("scroll",d,!1),a.disableScrollEnd=function(){a.removeEventListener("scroll",d,!1),clearTimeout(c.timer)},a.enableScrollEnd=function(){a.addEventListener("scroll",d,!1)}},b.scrollEndEventv2=function(a,b){var c;spotter.events.setEventTrigger(a,"scrollEnd");var d=function(d){c&&clearTimeout(c),c=setTimeout(function(){a.eventTriggers.scrollEnd(d)},b)};a.addEventListener("scroll",d,!1),a.disableScrollEnd=function(){c&&clearTimeout(c),a.removeEventListener("scroll",d,!1)},a.enableScrollEnd=function(){a.addEventListener("scroll",d,!1)}},b.onScrollBottom=function(a,b){spotter.events.setEventTrigger(a,"scrollBot");var c=function(){var a=0;return function(b){var c=this.scrollHeight,d=this.scrollTop;this.offsetHeight;d>=c-this.clientHeight&&a-d<0&&this.eventTriggers.scrollBot(b),a=d}}();return a.addEventListener("scroll",c,!1),b},b.pressandhold=function(){var a=[];return function(b,c){if(~a.indexOf(b))return!0;a.push(b),void 0!==b.eventTriggers&&b.eventTriggers.pressandhold||spotter.events.setEventTrigger(b,"pressandhold");var d,e,f="return false;",g=function(a,b){return e=function(){return clearTimeout(d),!1},function(b){clearTimeout(d),a.pressandhold=!1,a.setAttribute("onclick",f),d=setTimeout(function(){a.pressandhold=!0,f=a.getAttribute("onclick"),a.removeAttribute("onclick"),a.eventTriggers.pressandhold()},spotter.events.pressandhold.timeout)}}(b,b.parentNode);b.addEventListener("mousedown",g,!1),b.addEventListener("mouseup",e,!1)}}(),b.pressandhold.timeout=700,b.expandedMouseEvents=function(a){void 0===a.spotterExpandedMouseEvents&&(a.addEventListener=function(a,b,c,d){"click"===a&&(a="spotterclick");var e=a;if(~["pressandhold","swipeleft","swiperight","swipeup","swipedown","spotterclick"].indexOf(a)){"swipeleft"!==a&&"swiperight"!==a||(e="swipehorizontal"),"swipeup"!==a&&"swipedown"!==a||(e="swipevertical");var f=spotter.events.expandedMouseEvents,g=this.spotterExpandedMouseEvents,h=!0;"object"==typeof d&&(void 0!==d.minSwipeDist&&("swipehorizontal"===e?g.minDistH=spotter.events.expandedMouseEvents.getMinSwipeDistance(d.minSwipeDist,this,"horizontal"):"swipevertical"===e&&(g.minDistV=spotter.events.expandedMouseEvents.getMinSwipeDistance(d.minSwipeDist,this,"vertical"))),g.swipeMaxTime=d.swipeMaxTime||750,g.holdMinTime=d.holdMinTime||750),"swipehorizontal"===e?!0===g.horizontal?h=!1:g.horizontal=!0:"swipevertical"===e?!0===g.vertical?h=!1:g.vertical=!0:"pressandhold"===e&&(!0===g.hold?h=!1:g.hold=!0),!0===h&&(f.setupEventTrigger(this,e),f.addMouseDownListener(this,e),f.addMouseUpListener(this,e),f.addMouseOutListener(this,e))}EventTarget.prototype.addEventListener.call(this,a,b,c)},a.spotterExpandedMouseEvents={mouseX:0,mouseY:0,startTime:0,horizontal:!1,vertical:!1,hold:!1,minDistV:50,minDistH:50,swipeMaxTime:750,holdMinTime:750})},b.expandedMouseEvents.getMinSwipeDistance=function(a,b,c){if(~a.toString().indexOf("%")){var d;return"vertical"===c?d=spotter.getHeight(b):"horizontal"===c&&(d=spotter.getWidth(b)),a.slice(0,-1)/100*d}},b.expandedMouseEvents.setupEventTrigger=function(a,b){switch(b){case"swipehorizontal":spotter.events.setEventTrigger(a,"swipeleft"),spotter.events.setEventTrigger(a,"swiperight");break;case"swipevertical":spotter.events.setEventTrigger(a,"swipeup"),spotter.events.setEventTrigger(a,"swipedown");break;case"pressandhold":spotter.events.setEventTrigger(a,"pressandhold");break;case"spotterclick":spotter.events.setEventTrigger(a,"spotterclick")}},b.expandedMouseEvents.addMouseDownListener=function(a,b){var c=a.spotterExpandedMouseEvents,d="mousedownFunc";(c.vertical||c.horizontal)&&(d+="Swipe"),c.hold&&(d+="Hold"),a.addEventListener("mousedown",spotter.events.expandedMouseEvents[d])},b.expandedMouseEvents.mousedownFuncSwipe=function(a){var b=this.spotterExpandedMouseEvents;b.active=!0,b.mouseX=a.clientX,b.mouseY=a.clientY,b.startTime=(new Date).getTime(),b.initiatingEvent=a},b.expandedMouseEvents.mousedownFuncSwipeHold=b.expandedMouseEvents.mousedownFuncSwipe,b.expandedMouseEvents.mousedownFuncHold=function(a){var b=this.spotterExpandedMouseEvents;b.active=!0,b.startTime=(new Date).getTime(),b.initiatingEvent=a},b.expandedMouseEvents.mousedownFunc=function(a){var b=this.spotterExpandedMouseEvents;b.active=!0,b.initiatingEvent=a},b.expandedMouseEvents.addMouseUpListener=function(a){var b=a.spotterExpandedMouseEvents,c="mouseUp";a.removeEventListener("mouseup",b.mouseupfunc),(b.vertical||b.horizontal)&&(c+="Swipe"),b.hold&&(c+="Hold"),b.mouseupfunc=spotter.events.expandedMouseEvents[c],a.addEventListener("mouseup",b.mouseupfunc)},b.expandedMouseEvents.swipeDirection=function(a,b,c){var d=b-a.mouseX,e=c-a.mouseY,f=Math.abs(d),g=Math.abs(e);if(g<a.minDistH&&f<a.minDistV)return console.log("distance too short X:"+f+" Xmin:"+a.minDistV+" Y:"+g+" Ymin:"+a.minDistH),!1;if(d>0){if(a.horizontal&&f>g)return"right";if(a.vertical)return e>0?"down":"up"}else{if(a.horizontal&&f>g)return"left";if(a.vertical)return e>0?"down":"up"}return!1},b.expandedMouseEvents.mouseUpSwipe=function(a){var b=this.spotterExpandedMouseEvents;if(!1!==b.active){b.active=!1;var h,c=b.initiatingEvent,d=(new Date).getTime(),e=a.clientX,f=a.clientY,g=d-b.startTime;g<=b.swipeMaxTime&&(h=spotter.events.expandedMouseEvents.swipeDirection(b,e,f))?this.eventTriggers["swipe"+h](c):void 0!==this.eventTriggers.spotterclick&&this.eventTriggers.spotterclick(c)}},b.expandedMouseEvents.mouseUpSwipeHold=function(a){var b=this.spotterExpandedMouseEvents;if(!1!==b.active){b.active=!1;var h,c=b.initiatingEvent,d=(new Date).getTime(),e=a.clientX,f=a.clientY,g=d-b.startTime;g<=b.swipeMaxTime&&(dir=swipeDirection(b,e,f))?this.eventTriggers["swipe"+h](c):g>b.holdMinTime?this.eventTriggers.pressandhold(c):void 0!==this.eventTriggers.spotterclick&&this.eventTriggers.spotterclick(c)}},b.expandedMouseEvents.mouseUpHold=function(a){var b=this.spotterExpandedMouseEvents;if(!1!==b.active){b.active=!1;var c=b.initiatingEvent,d=(new Date).getTime(),e=d-b.startTime;e>b.holdMinTime?this.eventTriggers.pressandhold(c):void 0!==this.eventTriggers.spotterclick&&this.eventTriggers.spotterclick(c)}},b.expandedMouseEvents.mouseUp=function(a){var b=this.spotterExpandedMouseEvents;if(!1!==b.active){b.active=!1;var c=b.initiatingEvent;void 0!==this.eventTriggers.spotterclick&&this.eventTriggers.spotterclick(c)}},b.expandedMouseEvents.addMouseOutListener=function(a,b){var c=a.spotterExpandedMouseEvents;a.removeEventListener("mouseout",spotter.events.expandedMouseEvents.mouseoutfunc),(c.vertical||c.horizontal)&&a.addEventListener("mouseout",spotter.events.expandedMouseEvents.mouseoutfunc)},b.expandedMouseEvents.mouseoutfunc=function(a){var b=this.spotterExpandedMouseEvents;if(!1!==b.active){b.active=!1;var h,c=b.initiatingEvent,d=(new Date).getTime(),e=a.clientX,f=a.clientY,g=d-b.startTime;g<=b.swipeMaxTime&&(h=spotter.events.expandedMouseEvents.swipeDirection(b,e,f))&&this.eventTriggers["swipe"+h](c)}},b}(),spotter.getMousePos=function(a){var b,c;if(void 0!==a.clientX)b=a.clientX,c=a.clientY;else{if(void 0===a.pageX)return!1;b=a.pageX,c=a.pageY}return[b,c]},spotter.getRelativeMousePos=function(a,b){var c=a.getBoundingClientRect(),d=spotter.getMousePos(b);return d?{x:Math.round((d[0]-c.left)/(c.right-c.left)*(a.width||spotter.getWidth(a))),y:Math.round((d[1]-c.top)/(c.bottom-c.top)*(a.height||spotter.getHeight(a)))}:(console.warn("event passed to get relative mouse position does not have the necessary data",b),!1)},spotter.observeSetter=function(a,b,c){Object.defineProperty(a,b,{set:function(d){delete a[b],this[b]=d,spotter.events.fire(c)},configurable:!0})},spotter.empty=function(a){return void 0===a||null===a||0===a.length||0===a};var d=new RegExp("(.*?)@(.+)\\/([a-zA-Z0-9]+\\.js):([0-9]+):([0-9]+)$");spotter.log=function(a,b){var e,f,g,h,c=[];switch(e="font-weight:bold;font-size:1.1rem;",f="font-size:1.0rem;",g="font-size:1.0rem;",a){case"log":e+="color:#5E5045;",f+="color:#AA9586;",g+="color:#8E5F3D;";break;case"debug":e+="color:#001266;",f+="color:#808BBF;",g+="color:#8E5F3D;";break;case"error":e+="color:red;",f+="color:#922;",g+="color:#8E5F3D;"}var i=(new Error).stack.split("\n")[1];if(i=d.exec(i),null!==i&&i.length>1&&console.log("%c"+i[1]+" - "+i[3]+":"+i[4]+": \n",e),void 0!==b.msg&&console.log(">%c  "+b.msg+" \n",f),b.vars){console.log(">%c    variables: \n",g);for(h in b.vars)c.push(">        "+h+": "),c.push(String(b.vars[h])),c.push(" \n")}console.log.apply(console,c),console.log("--------------------------------------------------------------------")},spotter.log.stackDump=function(a){var b=a.split("\n"),c=[],d=0,e=new RegExp("(.*?)@(.+?)([a-zA-Z0-9\\-_\\.]+)\\/?:([0-9]+):([0-9]+)$");return b.forEach(function(a){++d<10&&a.length>0&&null!==(a=e.exec(a))&&c.push(a[1]+"@"+a[3]+":"+a[4])})," \n "+c.join(" <= ")},function(a){for(var b=a.getElementsByTagName("SCRIPT"),c=b.length,d=[];--c>-1;)console.log("intial src for base spotter script:",b[c].getAttribute("src")),d.push(b[c].getAttribute("src"));spotter.addScriptToHead=function(b,c){if(~d.indexOf(b))return console.warn("script was already added",b),!1;d.push(b);var e=document.createElement("script");"function"==typeof c&&(e.onload=c),e.src=b,a.appendChild(e)};for(var e=a.getElementsByTagName("LINK"),c=e.length,f=[];--c>-1;)f.push(e[c].href+"-"+e[c].rel);spotter.addCSSToHead=function(a){if(~f.indexOf(a+"-stylesheet"))return console.warn("stylesheet was already added",a),!1;f.push(a+"-stylesheet");var b=document.createElement("link");b.href=a,b.rel="stylesheet",document.getElementsByTagName("HEAD")[0].appendChild(b)},spotter.addLinkToHead=function(a){if(!a.href||!a.rel)return console.warn("adding a link requires both an href and rel attribute",a),!1;if(~f.indexOf(a.href+"-"+a.rel))return console.warn("link was already added",a),!1;f.push(a.href+"-"+a.rel);var b=document.createElement("link");for(var c in a)b.setAttribute(c,a[c]);document.getElementsByTagName("HEAD")[0].appendChild(b)}}(document.getElementsByTagName("HEAD")[0]),spotter.testLoaded=function(a,b){if("function"!=typeof a)return void console.warn("argument 'func' for spotter testLoaded must be a function",a);var c,d;if("document"===b?(c="interactive,DOMContentLoaded,complete",d=!1):void 0===b||"window"===b||"complete"===b?(c="complete",d=!1):d=!0,d)if(spotter.require.isReady(b))a();else{var f=window.spotter.onModuleReady.functions;f[b]=f[b]||[],f[b].push(a)}else{c.indexOf(document.readyState)>-1?a():window.onloadFunctions.push(function(a,b,c){return function(){-1!==c.indexOf(document.readyState)&&(document.cb_removeEventListener("readystatechange",window.onloadFunctions[b]),a())}}(a,window.onloadFunctions.length,c));/fennec/i.test((navigator.userAgent||navigator.vendor||window.opera).substr(0,4))?document.addEventListener("resize",window.onloadFunctions[window.onloadFunctions.length-1],!1):document.addEventListener("readystatechange",window.onloadFunctions[window.onloadFunctions.length-1],!1)}},spotter.preLoaded.length&&spotter.preLoaded.forEach(function(a){spotter.testLoaded(a[0],a[1])}),spotter.isElement=function(a){return!!("object"==typeof HTMLElement?a instanceof HTMLElement:a&&"object"==typeof a&&null!==a&&1===a.nodeType&&"string"==typeof a.nodeName)},Object.defineProperty(spotter,"requiredParam",function(){var a=!1,b=[],c=void 0,d=function(a){if(void 0!==a)return c=a,d;spotter.consoleError("requred argument is undefined",c)};return d.array=function(){return!0===a||Array.isArray(c)?a=!0:(b.push("Array"),a=!1),d},d.integer=function(){return!0===a||!0===Number.isInteger(c)?a=!0:b.push("Integer"),d},d.DOMList=function(){return!0===a||spotter.isType.DOMList(c)?a=!0:(b.push("HTMLCollection"),b.push("NodeList")),d},d.string=function(){return!0===a||"string"==typeof c?a=!0:b.push("String"),d},d.element=function(e){return!0===a||spotter.isType.element(c)&&(void 0===e||c.tagName===e.toUpperCase())?a=!0:b.push("HTMLElement"),d},d.result=function(){return void 0===c?function(){console.warn("when using required param, the test argument must be set using spotter.requiredParam(argument)...")}:!1===a?function(a){return console.warn("required arg must be type:["+b.join(",")+"]",c,a?(new Error).stack:""),!1}:!0===a?function(){return!0}:function(){console.warn("result not boolean")}},{get:function(){return c=void 0,a=!1,b=[],d},enumerable:!0,configurable:!1}}()),spotter.isType={array:function(a){return Array.isArray(a)},integer:function(a){return!0===Number.isInteger(a)},DOMList:function(a){return void 0!==a&&(a instanceof NodeList||a instanceof HTMLCollection)},string:function(a){return"string"==typeof a},element:function(a){return!(!a||!(a.nodeName||a.prop&&a.attr&&a.find))},rows:function(a){var b=!0;return!!Array.isArray(a)&&(a.forEach(function(a){"object"!=typeof a&&(b=!1)}),b)},numeric:function(a){return"undefined"!=typeof o&&!Array.isArray(o)&&o-parseFloat(o)+1>=0},arrayLike:function(a){return a&&"object"==typeof a&&void 0!==a.length}},spotter.hexToRgb=function(a){"#"===a.charAt(0)&&(a=a.substr(1)),3===a.length&&(a=a.replace(/^(.)(.)(.)$/,function(a,b,c,d){return b+b+c+c+d+d}));var b=parseInt(a,16);return(b>>16&255)+","+(b>>8&255)+","+(255&b)},spotter.consoleError=function(a,b,c,d){if(c=c||"minor",a=void 0===d?"ERROR: "+arguments.callee.caller.toString()+": "+a:"ERROR: "+d+": "+a,"minor"===c)console.log(a),b?console.log(b):console.log("---DATA EMPTY---"),console.log("/ERROR END");else if("major"===c)throw new Error(a+"/ERROR END")},c.whichTransitionEvent=function(){var a,b=document.createElement("fakeelement"),c={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(a in c)if(void 0!==b.style[a])return c[a];return console.log("no transition end event was discovered, defaulting to 'transitionend'"),"transitionend"},spotter.whichTransitionEvent=c.whichTransitionEvent(),c.whichAnimationEvent=function(){var a,b=document.createElement("fakeelement"),c={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"animationend",WebkitAnimation:"webkitAnimationEnd"};for(a in c)if(void 0!==b.style[a])return c[a]},spotter.whichAnimationEvent=c.whichAnimationEvent(),spotter.onTransformEnd=function(){var a=c.whichTransitionEvent();return function(b,c){c=function(b){c(b),this.removeEventListener(a,c,!1)},b.addEventListener(a,c,!1)}}(),spotter.onResize=function(){var c,a={onResize:[]},b=function(b,c){Array.isArray(c)||(c=[c]),a.onResize.push({func:b,args:c})},d=function(){a.onResize.forEach(function(a,b){a.func.apply(this,a.args)})};return window.addEventListener("resize",function(){clearTimeout(c),c=setTimeout(d,500)}),b}(),spotter.onPageOut=function(){var a=[],b=function(b){a.push(b)};return b.getFuncs=a,window.addEventListener("beforeunload",function(a){var b=spotter.onPageOut.getFuncs;b.length;b.forEach(function(a,b,c){a()})},!1),b}(),spotter.getFirstTextNode=function(a){for(var b=0,c=a.childNodes.length;b<c&&"#text"!==a.childNodes[b].nodeName;b++);return a.childNodes[b]||(a=a.insertBefore(document.createTextNode(""),a.firstChild)||a.firstChild)},spotter.setFirstTextNode=function(a,b){var c=spotter.getFirstTextNode(a);return c.nodeValue=b,c},spotter.toggleFirstTextNodeValue=function(a,b){var c=spotter.getFirstTextNode(a);return c.nodeValue=c.nodeValue.toggleListValue(b),c},spotter.firstTextNodeRemoveValue=function(a,b){var c=spotter.getFirstTextNode(a);return c.nodeValue=c.nodeValue.removeListValue(b),c},spotter.firstTextNodeAddValue=function(a,b){var c=spotter.getFirstTextNode(a);c.nodeValue=c.nodeValue.addListValue(b)},spotter.placeholder={add:function(a,b){a.nodeValue?spotter.toggle.class.remove(a.parentNode,spotter.static.classes.placeholder):(a.nodeValue=b,spotter.toggle.class.add(a.parentNode,spotter.static.classes.placeholder))}},spotter.prependChild=function(a,b){a.insertBefore(b,a.firstChild)},spotter.insertAfter=function(a,b){a.parentNode.insertBefore(b,a.nextSibling)},spotter.deleteElement=function(a){a.parentNode.removeChild(a)},spotter.replaceElement=function(a,b){var c=a.parentNode,d=a.nextSibling;c.removeChild(a),c.insertBefore(b,d)},spotter.replaceByHTML=function(a,b){var c=a.previousSibling,d="afterend",e="nextSibling";return c||(d="beforebegin",c=a.nextSibling,e="previousSibling"),spotter.deleteElement(a),c.insertAdjacentHTML(d,b),c[e]},spotter.moveTo=function(a,b){var c=document.body.getBoundingClientRect(),d=b.getBoundingClientRect(),e=d.top-c.top;offsetLeft=d.left-c.left;var f=spotter.getWidth(a),g=offsetLeft+f>c.width?c.width-f:offsetLeft;a.style.top=e+"px",a.style.left=g+"px"},spotter.concatNodeLists=function(a){for(var b=[],c=0,d=a.length;c<d;c++)b=b.concat(Array.prototype.slice.call(a[c]));return b},spotter.DOMObject=function(){var a=function(){};return a.getRelativeWidth=function(a){var b=spotter.getWidth(a);if(b>0){for(var c=a.parentNode,d=0;!((wP=spotter.getWidth(c))>0)&&d<5;)c=c.parentNode,d++;return Number(b/wP*100)+"%"}return b},a}(),spotter.verticallyCenter=function(a){spotter.toggle.class.add(a,"centered-content"),spotter.toggle.class.add(a.parentNode,"content-centered")},spotter.getSelector=function(a){var b=a.tagName;return b=b.toLowerCase(),a.id&&(b+="#"+a.id),a.className&&(b+="."+a.className.replace(" ",".")),b},spotter.ajax=function(){function b(){this.onComplete=[],this.onSuccess=[],this.onProgress=[],this.onError=[],this.onAbort=[],this.failed=!1,this.succeeded=!1,this.isComplete=!1}return b.prototype.complete=function(a){return this.isComplete?a(this.ajax.response):this.onComplete.push(a),this},b.prototype.success=function(a){return this.isComplete&&this.succeeded?a(this.ajax.response):this.onSuccess.push(a),this},b.prototype.progress=function(){return this.onProgress.push(func),this},b.prototype.error=function(a){return this.failed?a():this.onError.push(a),this},b.prototype.abort=function(a){return this.aborted?a():this.onAbort.push(a),this},b.prototype.kill=function(){this.request&&(this.request.active=!1,4!=this.request.readyState&&this.request.abort(),delete this.request)},b.prototype.timeout=function(a){},b.registeredInstances={},b.registerNamedRequest=function(a,b,c){this.registeredInstances[a]={request:b,opts:c}},b.getNamedRequest=function(a){return void 0!==this.registeredInstances[a]&&this.registeredInstances[a]},function(c){var g,h,k,l,d=new b,f={},i=null,j=c.cache;if(void 0!==c.requestor&&(b.getNamedRequest(c.requestor)&&c.onNewRequest,b.registerNamedRequest(c.requestor,d,c)),c.url=c.url||"",c.method=c.method||c.type||"POST",c.async=c.async||!0,c.headers=c.headers||[],c.headers["X-Requested-With"]="XMLHttpRequest","Content-type"in c.headers||(c.headers["Content-type"]="application/x-www-form-urlencoded"),"Accept"in c.headers||(c.headers.Accept=["application/json","text/plain","*/*"]),"object"==typeof c.data&&("FORM"===c.data.tagName?(c.method="POST",c.headers["Content-type"]="",i=spotter.getFormData(c.data),!1===c.cache&&i.append("nocache",spotter.makeId()),~c.url.indexOf("?")&&(urlParams=c.url.split("?"),c.url=urlParams[0],urlParams=urlParams[1].split("&"),urlParams.forEach(function(a){a=a.split("="),i.append(a[0],a[1])}))):(~c.url.indexOf("?")&&(k=c.url.split("?"),k[1].split("&").forEach(function(a){a=a.split("="),c.data[a[0]]=a[1]}),c.url=k[0]),i=spotter.serialize(c.data,!0)),spotter.logFormData(i),"GET"===c.method.toUpperCase()&&(h=i,h.length&&(~c.url.indexOf("?")?c.url+=h:c.url+="?"+h.slice(1)),!1===c.cache&&(c.url+=(~c.url.indexOf("?")?"&":"?")+"nocache="+spotter.makeId()))),"function"==typeof c.success&&d.success(c.success),"function"==typeof c.error&&d.error(c.error),"function"==typeof c.complete&&d.complete(c.complete),"function"==typeof c.timeout&&d.timeout(c.timeout),j){if("object"!=typeof j&&console.warn("the value for cache sent to spotter ajax must be an object like {name:name, type(opt):local|session, expiration(opt):integer(s)",(new Error).stack),void 0===j.name&&void 0!==c.requestor&&(j.name=c.requestor),f.response=spotter.ajax.getSavedResponse(j.name,j.type))return d.isComplete=!0,d.succeeded=!0,d.active=!1,console.log("CACHED: ",c.method," XHR ",c.url," \n","params:",i),d.onSuccess.forEach(function(a){a.call({ajax:f},f.response,i)}),d.onComplete.forEach(function(a){a.call({ajax:f},f.response,i)}),d;d.success(function(a,b){spotter.ajax.saveResponse(a,j.name,j.type,j.expiration)})}if(d.request=f=new XMLHttpRequest,c.timeout=c.timeout||8e3,c.timeout&&(f.timeout=c.timeout,f.ontimeout=function(a){d.isComplete=!0,d.failed=!0,console.warn("request timed out \n","this:",this),d.timeout.forEach(function(b){b.call(a,f.response,i)}),d.active=!1}),f.createdWith=c,f.addEventListener("progress",function(a){d.onProgress.forEach(function(b){b(a)})}),f.addEventListener("abort",function(){d.aborted=!0,d.onAbort.forEach(function(a){a()})}),f.addEventListener("error",function(){d.failed=!0,d.onError.forEach(function(a){a()})}),f.open(c.method,c.url,c.async),void 0!==c.headers)for(var l in c.headers)c.headers.hasOwnProperty(l)&&(g=c.headers[l],Array.isArray(g)?g.forEach(function(a){a&&f.setRequestHeader(l,a)}):c.headers[l]&&f.setRequestHeader(l,c.headers[l]));return f.onload=function(a){4===f.readyState&&(d.isComplete=!0,f.status>=200&&f.status<=299?(d.succeeded=!0,d.active&&d.onSuccess.forEach(function(b){b.call(a,f.response,i)})):(d.failed=!0,d.active&&(404==f.status?console.warn("ajax error "+c.url+" returned 404"):console.warn("Error "+f.status+" occurred uploading form."),d.onError.forEach(function(b){b.call(a,f.response,i)}))),d.onComplete.forEach(function(b){b.call(a,f.response,i)}),d.active=!1)},f.send(i),d.active=!0,d}}(),spotter.ajax.saveResponse=function(a,b,c,d){if(!b)return console.warn("name is required for save ajax response"),!1;c=(c||"session")+"Storage",window[c].setItem("A"+b,a),window[c].register("A"+b,1e3*d,!0)},spotter.ajax.getSavedResponse=function(a,b){if(!a)return console.warn("name is required for save ajax response"),!1;var c;return b=(b||"session")+"Storage",a="A"+a,!1!==(c=window[b].getRegisteredObject(a))&&c},spotter.extend=function(a){for(var c,e,b=spotter.castToArray(arguments).slice(1),d=b.length;--d>-1;){c=b[d];for(e in c.prototype)void 0===a.prototype[e]&&(a.prototype[e]=c.prototype[e])}},spotter.setNestedProperties=function(a,b){for(var c in b)void 0===a[c]&&(a[c]={}),"object"==typeof b[c]&&null!==b[c]?Array.isArray(b[c])?(Array.isArray(a[c])||(a[c]=[]),b[c].forEach(function(b,d){a[c][d]=b})):void 0===a[c]?a[c]=b[c]:spotter.setNestedProperties(a[c],b[c]):(delete a[c],a[c]=b[c])},spotter.deleteNestedProperties=function(a,b){for(var c in b)void 0!==a[c]&&("object"==typeof b[c]&&null!==b[c]?spotter.deleteNestedProperties(a[c],b[c]):delete a[c])},spotter.castToArray=function(a){var b=[],c=0,d=a.length;for(c;c<d;c++)b.push(a[c]);return b},spotter.addElementAsParent=function(a,b){"string"==typeof a&&(a=document.getElementById(a));var c=a.parentNode,d=document.createElement(b);return c.replaceChild(d,a),d.appendChild(a),d},spotter.unpackParent=function(a){var b=a.parentNode,c=a.childNodes,d=0,e=c.length;for(d;d<e;d++)b.appendChild(c[d]),arguments[1]&&unpackparent(c[d])},spotter.unpackChild=function(a){a.parentNode.parentNode.appendChild(a)},spotter.reCloak=function(a){for(var b=a[0].length-1;b;)b--,a[0][b].className=a[0][b].className.replace(" uncloak","")},spotter.unCloak=function(a,b){var c=[[]];for(b=b||999;"BODY"!=a.tagName&&b;)b--,c[0].push(a),a.className=a.className+" uncloak",a=a.parentNode;return c},spotter.effectiveWidth=function(a,b){var d=(a.style.cssText,a.currentStyle||window.getComputedStyle(a)),e=d.paddingLeft.match(/[0-9\.]+/),f=d.paddingRight.match(/[0-9\.]+/);return[b,b-e-f,e,f,d.marginLeft.match(/[0-9\.]+/),d.marginRight.match(/[0-9\.]+/)]},spotter.effectiveHeight=function(a,b){var d=(a.style.cssText,a.currentStyle||window.getComputedStyle(a)),e=d.paddingTop.match(/[0-9\.]+/),f=d.paddingBottom.match(/[0-9\.]+/);return[b,b-e-f,e,f,d.marginTop.match(/[0-9\.]+/),d.marginBottom.match(/[0-9\.]+/)]},spotter.getHeight=function(a,b,c){if(a&&a.tagName){var e,d=a.getBoundingClientRect();return c&&console.log("get height for ",a,d),d?(e=void 0!==d.height?d.height:d.bottom-d.top,b?this.effectiveHeight(a,e,d):e):(e=a.offsetHeight||a.clientHeight||a.scrollHeight,b?this.effectiveHeight(a,e):e)}return console.warn("an element is required for getHeight",(new Error).stack),0},spotter.getWidth=function(a,b,c){if(a&&a.tagName){var e,d=a.getBoundingClientRect();return d?(e=void 0!==d.width?d.width:d.right-d.left,b?this.effectiveWidth(a,e,d):e):(e=a.offsetWidth||a.clientWidth||a.scrollWidth,b?this.effectiveWidth(a,e):e)}return console.warn("an element is required for getWidth",(new Error).stack),0},spotter.testLoaded(function(){spotter.getRemUnitValue=function(){var b,a=document.createElement("DIV");return a.style.width="1rem",a.id="spotter-1-rem",spotter.appendToBody(a),b=spotter.getWidth(a),spotter.onResize(function(){b=spotter.getWidth(a)}),function(){return b}}()}),spotter.dumpObject=function(a,b){for(var c in a)console.log(b+"["+c+"]="+typeof a[c]),"object"==typeof a[c]&&dumpObject(a[c],c)},spotter.findParent=function(a,b,c){var d=a,e=(b||"").substr(0,1);if("#"===e)for(b=b.substr(1);d.id!==b;)d=d.parentNode;else if("."===e)for(b=b.substr(1);-1===d.className.indexOf(b);)d=d.parentNode;else if(c)if(null===b)for(;d.hasAttribute&&!d.hasAttribute(c);)d=d.parentNode;else if(~["name","tagName"].indexOf(c))for(;d[c]!==b;)d=d.parentNode;else for(;d.getAttribute(c)!==b;)d=d.parentNode;else{if("string"!=typeof b)return console.log(b+" is not a valid argument for find parent"),!1;for(;d.byAttr!==b;)d=d.parentNode}return d===document&&(d=null),d},spotter.Rows=function(a){this.arr=[],void 0!==a&&a.length>0&&this.push(a)},spotter.Rows.prototype.mergeDistinct=function(){var g,a=arguments,b=a.length,d=this.length;for(g=1;g<b;g++)Array.prototype.push.apply(a[0],a[g]);for(;--d>-1;)~a[0].indexOf(this[d])&&a[0].splice(d,1);return Array.prototype.push.apply(this,a[0]),this},spotter.Rows.prototype.push=function(a){Array.isArray(a)||"object"!=typeof a||(a=[a]);var d,b=a.length,c=0;for(c;c<b;c++)d=a[c],"object"!=typeof d?console.debug("rows push argument must be an array of objects"):this.arr.push(d);return this},spotter.Rows.prototype.cut=function(a){Array.isArray(a)||(a=[a]);var b=a.length,c=0;for(c;c<b;c++)this.arr.splice(a[c],1);return this},spotter.Rows.prototype.find=function(a,b){var c=0,d=this.length;for(c;c<d;c++)if(this[c][a]===b)return c},spotter.toggle=function(){var a=function(a){"none"===a.style.display?a.style.removeProperty("display"):a.style.display="none"};return a.hide=function(a){if(void 0===a.className)return console.warn("toggle hide argument must be a valid element \n","el:",a," \n",(new Error).stack),!1;a.className=a.className.addListValue("hide"," ")},a.show=function(a){a.className=a.className.removeListValue("hide"," ")},a.class=function(){var a=function(a,b){if(spotter.isType.arrayLike(a))for(var d,c=a.length;--c>-1;)d=a[c],d.className=d.className.toggleListValue(b," ");else a.className=a.className.toggleListValue(b," ")};return a.add=function(a,b){if(!a)return void console.log("element sent to toggle class was not node or node array \n","el:",a," \n",(new Error).stack);if(spotter.isType.arrayLike(a))for(var d,c=a.length;--c>-1;)d=a[c],d||console.log("stupid thing:",a),d.className=d.className.addListValue(b," ");else a.className=a.className.addListValue(b," ")},a.remove=function(a,b){if(!a)return void console.log("element sent to toggle class was not node or node array \n","el:",a," \n",(new Error).stack);if(spotter.isType.arrayLike(a))for(var d,c=a.length;--c>-1;)d=a[c],d.className=d.className.removeListValue(b," ");else a.className=a.className.removeListValue(b," ")},a.swap=function(a,b,c){if(!a||void 0===a.className)return void console.log((new Error).stack);if(spotter.isType.arrayLike(a))for(var e,d=a.length;--d>-1;)e=a[d],e.className=e.className.removeListValue(b," "),e.className=e.className.addListValue(c," ");else a.className=a.className.removeListValue(b," "),a.className=a.className.addListValue(c," ")},a}(),a.value=function(){var a=function(a,b){""===a.value.trim()?a.value=b:a.value=""};return a.toDefault=function(a,b){""===a.value.trim()&&(a.value=b)},a.removeDefault=function(a,b){a.value.trim()===b&&(a.value="")},a}(),a.content=function(a,b,c){a.innerHTML===b?a.innerHTML=c:a.innerHTML=b},a.CSS=function(){var a={},b=function(a,b,c){return a.coreToggleCSS=a.coreToggleCSS||{},void 0===a.coreToggleCSS[b]&&(a.coreToggleCSS[b]=a.style[b]),function(){a.style[b]===a.coreToggleCSS[b]?a.style[b]=c:a.style[b]=a.coreToggleCSS[b]}};return b.createGroup=function(a,c,d,e){Array.isArray(a)||(a=spotter.castToArray(a)),a.forEach(function(a){b.addToGroup(a,c,d,e)})},b.toggleGroup=function(b){if(void 0!==a[b])for(var c=a[b].memberFuncs,d=c.length;--d>-1;)c[d]()},b.memberActive=function(b,c){var d=a[c].memberFuncs;a[c].active.forEach(function(a){d[a.coreToggleCSS[c].memberNum]()}),a[c].active=[b],d[b.coreToggleCSS[c].memberNum]()},b.memberReset=function(b,c){a[c].active.removeValues(b),a[c].memberFuncs[b.coreToggleCSS[c].memberNum]()},b.addToGroup=function(c,d,e,f){void 0===a[f]&&(a[f]={memberFuncs:[],active:[]}),c.coreToggleCSS=c.coreToggleCSS||{},c.coreToggleCSS[f]={},c.coreToggleCSS[f].memberNum=a[f].memberFuncs.push(b(c,d,e))-1},b}(),a}(),spotter.activateAjaxButton={setup:function(a){var b=JSON.parse(a.getAttribute("data-ajax-button"));return a.activateAjaxButton={},a.activateAjaxButton.setup=b,function(){return spotter.ajax({url:b.url,data:b.argumentString,type:b.method,dataType:b.returnType,cache:b.cache||!0})}}},spotter.preventDefault=function(a){var b=a||window.event;b.preventDefault&&b.preventDefault(),b.returnValue=!1},spotter.resetCursor=function(a){if(a.setSelectionRange)a.focus(),a.setSelectionRange(0,0);else if(a.createTextRange){var b=a.createTextRange();b.moveStart("character",0),b.select()}},spotter.fancySelect=function(a,b){a.removeAttribute("onmouseover");var f,c=a.querySelectorAll(".fancy-option"),d=c.length,e=a.querySelector(".fancy-value"),g=function(){return function(){for(var a=c.length;a;)a--,spotter.toggleClass.remove(c[a],"selected")}}();a.selectedValue=function(){return function(){return e.innerHTML}}();for(var h=spotter.events(b);--d>-1;)f=function(a){return function(b){e.innerHTML=a.innerHTML,g(),spotter.toggleClass.add(a,"selected"),spotter.events.appendTo(a.innerHTML,h),spotter.events.fireEvent(h)}}(c[d]),c[d].addEventListener("click",f,!1);return h},spotter.isEventSupported=function(){function b(b){var c=document.createElement(a[b]||"div");b="on"+b;var d=b in c;return d||(c.setAttribute(b,"return;"),d="function"==typeof c[b]),c=null,d}var a={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return b}(),window.previousposition=0,spotter.scroll={to:function(a){var b=a.parentNode.getBoundingClientRect(),c=window.offSetY();window.scrollTo(0,.98*(c+b.top))},reset:function(){window.scrollTo(0,window.previousposition||0),window.previousposition=0},recordPosition:function(){(window.previousposition=0)&&(window.previousposition=document.documentElement.scrollTop||document.body.scrollTop)}},spotter.onScrollBottom=function(a,b){void 0===a&&(a=window),void 0===b&&(b="onScrollBottom"),b=spotter.events(b);var c=function(a,b){var c=0;return function(d){var e=a.scrollHeight,f=a.scrollTop;a.offsetHeight;f>=e-a.clientHeight&&c-f<0&&spotter.events.fire(b),c=f}}(a,b);return a.addEventListener("scroll",c,!1),b},spotter.keyboard={textInput:spotter.isEventSupported("textInput")?"textInput":"keypress",keyCodes:[],getChar:function(b){b=b||window.event;var c=b.which||b.keyCode;return String.fromCharCode(c)}},spotter.keyboard.keyCodes[8]="backspace",spotter.keyboard.keyCodes[9]="tab",spotter.keyboard.keyCodes[13]="enter",spotter.keyboard.keyCodes[16]="shift",spotter.keyboard.keyCodes[17]="ctrl",spotter.keyboard.keyCodes[18]="alt",spotter.keyboard.keyCodes[19]="pause/break",spotter.keyboard.keyCodes[20]="caps lock",spotter.keyboard.keyCodes[27]="escape",spotter.keyboard.keyCodes[33]="page up",spotter.keyboard.keyCodes[34]="page down",spotter.keyboard.keyCodes[35]="end",spotter.keyboard.keyCodes[36]="home",spotter.keyboard.keyCodes[37]="left arrow",spotter.keyboard.keyCodes[38]="up arrow",spotter.keyboard.keyCodes[39]="right arrow",spotter.keyboard.keyCodes[40]="down arrow",spotter.keyboard.keyCodes[45]="insert",spotter.keyboard.keyCodes[46]="delete",spotter.keyboard.keyCodes[48]="0",spotter.keyboard.keyCodes[49]="1",spotter.keyboard.keyCodes[50]="2",spotter.keyboard.keyCodes[51]="3",spotter.keyboard.keyCodes[52]="4",spotter.keyboard.keyCodes[53]="5",spotter.keyboard.keyCodes[54]="6",spotter.keyboard.keyCodes[55]="7",spotter.keyboard.keyCodes[56]="8",spotter.keyboard.keyCodes[57]="9",spotter.keyboard.keyCodes[65]="a",spotter.keyboard.keyCodes[66]="b",spotter.keyboard.keyCodes[67]="c",spotter.keyboard.keyCodes[68]="d",spotter.keyboard.keyCodes[69]="e",spotter.keyboard.keyCodes[70]="f",spotter.keyboard.keyCodes[71]="g",spotter.keyboard.keyCodes[72]="h",spotter.keyboard.keyCodes[73]="i",spotter.keyboard.keyCodes[74]="j",spotter.keyboard.keyCodes[75]="k",spotter.keyboard.keyCodes[76]="l",spotter.keyboard.keyCodes[77]="m",spotter.keyboard.keyCodes[78]="n",spotter.keyboard.keyCodes[79]="o",spotter.keyboard.keyCodes[80]="p",spotter.keyboard.keyCodes[81]="q",spotter.keyboard.keyCodes[82]="r",spotter.keyboard.keyCodes[83]="s",spotter.keyboard.keyCodes[84]="t",spotter.keyboard.keyCodes[85]="u",spotter.keyboard.keyCodes[86]="v",spotter.keyboard.keyCodes[87]="w",spotter.keyboard.keyCodes[88]="x",spotter.keyboard.keyCodes[89]="y",spotter.keyboard.keyCodes[90]="z",spotter.keyboard.keyCodes[91]="left window key",spotter.keyboard.keyCodes[92]="right window key",spotter.keyboard.keyCodes[93]="select key",spotter.keyboard.keyCodes[96]="numpad 0",spotter.keyboard.keyCodes[97]="numpad 1",spotter.keyboard.keyCodes[98]="numpad 2",spotter.keyboard.keyCodes[99]="numpad 3",spotter.keyboard.keyCodes[100]="numpad 4",spotter.keyboard.keyCodes[101]="numpad 5",spotter.keyboard.keyCodes[102]="numpad 6",spotter.keyboard.keyCodes[103]="numpad 7",spotter.keyboard.keyCodes[104]="numpad 8",spotter.keyboard.keyCodes[105]="numpad 9",spotter.keyboard.keyCodes[106]="multiply",spotter.keyboard.keyCodes[107]="add",spotter.keyboard.keyCodes[109]="subtract",spotter.keyboard.keyCodes[110]="decimal point",spotter.keyboard.keyCodes[111]="divide",spotter.keyboard.keyCodes[112]="f1",spotter.keyboard.keyCodes[113]="f2",spotter.keyboard.keyCodes[114]="f3",spotter.keyboard.keyCodes[115]="f4",spotter.keyboard.keyCodes[116]="f5",spotter.keyboard.keyCodes[117]="f6",spotter.keyboard.keyCodes[118]="f7",spotter.keyboard.keyCodes[119]="f8",spotter.keyboard.keyCodes[120]="f9",spotter.keyboard.keyCodes[121]="f10",spotter.keyboard.keyCodes[122]="f11",spotter.keyboard.keyCodes[123]="f12",spotter.keyboard.keyCodes[144]="num lock",spotter.keyboard.keyCodes[145]="scroll lock",spotter.keyboard.keyCodes[186]="semi-colon",spotter.keyboard.keyCodes[187]="equal sign",spotter.keyboard.keyCodes[188]="comma",spotter.keyboard.keyCodes[189]="dash",spotter.keyboard.keyCodes[190]="period",spotter.keyboard.keyCodes[191]="forward slash",spotter.keyboard.keyCodes[192]="grave accent",spotter.keyboard.keyCodes[219]="open bracket",spotter.keyboard.keyCodes[220]="back slash",spotter.keyboard.keyCodes[221]="close braket",spotter.keyboard.keyCodes[222]="single quote";var e=[];spotter.testLoaded(function(){document.body.addEventListener("click",function(a){e.forEach(function(b){b(a)})},!1)}),spotter.addToCloseFunctions=function(a){"function"==typeof a&&-1===e.indexOf(a)&&e.push(a)},spotter.cookie=function(){var a={},b={};return b.refresh=function(){for(var c,b=document.cookie.split("; "),d=0,e=b.length;d<e;d++)c=b[d].split("="),c[1]=unescape(c[1]),"{"!==c[1].substr(0,1)&&"["!==c[1].substr(0,1)||(c[1]=JSON.parse(c[1])),a[c[0].trim()]={value:c[1],seconds:3600}},b.bindElementToCache=function(b,c,d){var e=c.length;if(!Array.isArray(c)||!e)return console.warn("propertyChain must be an array with at least one value",arguments),!1;var f,h,i;e>1?(i=a[c[0]].value,f=i[h],h=c[1]):(i=a[h],f=a[h].value,h="value"),void 0===f&&(f=d),console.debug("cache",a),console.debug("arguments:",arguments),console.debug("parentObj: ",i),console.debug("initialValue: ",f),console.debug("attribute: ",h),Object.defineProperty(i,h,{get:function(){},set:function(a){f=a,spotter.setFirstTextNode(b,f)},enumerable:!0,configurable:!0}),spotter.setFirstTextNode(b,f)},b.getValue=function(b){return void 0!==b&&"string"==typeof b&&b.length?(void 0===a[b]&&(a[b]={value:{},seconds:3600}),a[b]):a},b.setValue=function(b){console.log("setValue",b);for(var c in b)void 0!==b[c].value?(void 0===a[c]&&(a[c]={value:{},seconds:3600}),Array.isArray(b[c].value)||"string"==typeof b[c].value?a[c].value=b[c].value:"object"==typeof b[c].value?spotter.setNestedProperties(a[c].value,b[c].value):console.errpr("cookie setValue unnaccounted type: ",typeof b[c].value),void 0!==b[c].seconds&&b[c].seconds>0&&(a[c].seconds=b[c].seconds)):console.warn("set cookie value: object passed was wrong format")},b.commitValue=function(a){console.log("commitValue:",a);for(var b in a)if(void 0!==a[b]){if(void 0!==a[b].seconds&&a[b].seconds>0){var c=new Date;c=new Date(c.getTime()+1e3*a[b].seconds),c=" expires="+c.toUTCString()}else c="";void 0===a[b].ignoreEmpty&&(a[b].ignoreEmpty=!1);var d=a[b].value;"object"==typeof d&&(d=escape(JSON.stringify(d))),console.log("commitValue",b+"="+d+"; Path=/;"+c),document.cookie=b+"="+d+"; Path=/;"+c}else console.log("commitValue property undefined",b+" undefined")},b.removeValue=function(b){if("string"==typeof b&&(b=[b]),Array.isArray(b))for(var c=b.length;c;)c--,document.cookie=b[c]+"=; Path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT;';",delete a[b[c]];else if("object"==typeof b)for(var d in b)void 0!==b[d].value?spotter.deleteNestedProperties(a[d].value,b[d].value):(document.cookie=d+"=; Path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT;';",delete a[d])},b.unset=function(a){var b,c=function(a,b){for(var d in a)void 0!==b[d]&&("object"==typeof a[d]?b[d]=c(a[d],b[d]):delete b[d]);return b};for(var d in a)(b=spotter.cookie.getValue(d))?(b=c(a,b),newObj={},newObj[d]=b,spotter.cookie.setValue(newObj)):console.log("cookie key "+d+" was not found in document.cookie")},b.JSON={save:function(a,c){b.setValue({key:JSON.stringify(c)})},load:function(a){return JSON.parse(b.getValue(a))}},b.commit=function(){b.commitValue(a)},b.finalCommit=function(c){c=c||window.event,c.preventDefault=!0,c.cancelBubble=!0,b.commitValue(a)},b.dump=function(){console.log(a)},b.refresh(),window.addEventListener("beforeunload",b.finalCommit,!1),b}(),spotter.getLocalePreferences=function(){var a=spotter.cookie.getValue("regionalPreferences");if(a&&void 0!==a.value.language)a=a.value;else{if(a={},a.language=navigator.languages?navigator.languages[0]:navigator.language||navigator.userLanguage,void 0===a.currency&&(a.currency={}),void 0===a.currency.abbr){var b,c=a.language.split("-");switch(c[0]){case"en":"US"===c[1]&&(b="USD"),"UK"===c[1]&&(b="GBP");break;case"de":b="EUR"}a.currency.abbr=b}spotter.cookie.setValue({regionalPreferences:{value:a}})}return function(){return a}}(),spotter.URL=function(){var a={},b={};return b.getParams=function(){return window.location.search.substring(1).split("&").forEach(function(b){var c=b.split("=");2===c.length&&(a[c[0]]=decodeURIComponent(c[1]))}),a},b.forwardParams=function(){for(var d,a=document.getElementsByTagName("A"),b=a.length,c=new RegExp(".[0-9a-zA-Z]{2,}?");b;)b--,d=a[b].href,c.test(d),a[b].href=a[b].href+window.location.search.substring(1)},b.previousURL=function(){for(var c,a=/(previousURL[A-Z])\=([^;\?]+)/g,b={};c=a.exec(document.cookie);)b[c[1]]=c[2];return 0===b.length?(document.cookie="previousURLA="+window.location.href+"; PATH=/;",document.cookie="previousURLB="+window.location.href+"; PATH=/;",window.location.href):b.previousURLA===b.previousURLB?(document.cookie="previousURLB="+window.location.href+"; PATH=/;",b.previousURLA):b.previousURLA===window.location.href||b.previousURLB===window.location.href?b.previousURLB:(document.cookie="previousURLA="+b.previousURLB+"; PATH=/;",document.cookie="previousURLB="+window.location.href+"; PATH=/;",b.previousURLA)}(),b.previousDomain=function(){return spotter.URL.previousURL.match(/^[^\?]+/)[0]},b.currentPage=function(){return/([^\/]+)(\.[a-zA-Z0-9]+)?(\?|$)/.exec(window.location.href)[1]},b.getParams(),b.params=a,b}(),spotter.forwardTo=function(){var a,b="",c=function(){if("string"!=typeof(a=spotter.forwardTo.get()))return console.log("forwardTo.goTo value is not set or not a string"),!1;"false"!==a.substring(0,5)?window.location.href=a:console.warn(c.caller,"forwardTo not set")};return c.set=function(a){if("string"!=typeof(a=a||123))return console.warn("forwardTo.set value not a string ("+a+")"),!1;spotter.cookie.setValue({forwardTo:{value:a}})},c.appendParams=function(a){for(var c in a)b+="&"+c+"="+a[c]},c.get=function(){var a=b.substring(1),c=spotter.cookie.getValue("forwardTo").value;return"string"==typeof c?c.toString()+(a.length>0?"?"+a:""):(console.warn("forwardTo.set value saved not a string ("+c+")"),!1)},c.unset=function(){spotter.cookie.removeValue("forwardTo")},c}(),spotter.imports=function(){var a={supported:"import"in document.createElement("link")},b=function(a,b){c.complete[a]="complete",c.templates[a]=b,spotter.events.appendTo({template:b},c.eventName[a]),spotter.events.fire(c.eventName[a])},c={members:{},templates:{},eventName:{},complete:{},onComplete:{}},d=function(e){var f,h,g=null;if(void 0!==e){if(null===(g=document.querySelector('link[data-import-name="'+e+'"]'))){if((h=document.getElementsByName(e)).length)return void d.registerTemplate(h[0]);var g=document.createElement("LINK");g.rel="import",g.href=spotter.require.homeURL+"templates/"+e+".html",g.setAttribute("data-import-name",e),document.getElementsByTagName("HEAD")[0].appendChild(g),console.info("import not found for "+e+". import was created.")}g=[g]}else(g=document.querySelectorAll('link[rel="import"]'))||console.log("no imports found");if(null===g)return void console.log("import not found for "+e);for(var k,l,m,i=g.length;--i>-1;)l=g[i],k=l.getAttribute("data-import-name"),c.members[k]=l,void 0===c.eventName[k]&&(c.eventName[k]=spotter.events(k)),c.complete[k]="in progress",a.supported?void 0!==l.import&&null!==l.import?(f=l.import.body.innerHTML,b(k,f)):l.addEventListener("load",function(a){f=this.import.body.innerHTML,b(k,f)},!1):(m=l.hasAttribute("cache")?{name:k,type:l.getAttribute("cache-type")||"local",expiration:l.getAttribute("cache-time")||259200}:null,spotter.ajax({url:l.getAttribute("href"),data:window.location.search.substring(1),dataType:"HTML",method:"GET",cache:m,success:function(a){return function(c){b(a,c)}}(k),error:function(){console.warn(arguments)}}))};return d.useImport=function(a,b){void 0===c.complete[a]&&spotter.imports(a),"complete"===c.complete[a]?b({content:{template:c.templates[a]}}):(void 0===c.eventName[a]&&(c.eventName[a]=spotter.events(a)),document.addEventListener(c.eventName[a],function(a){return function(c){a(c)}}(b),!1))},d.registerTemplate=function(a){void 0===a&&console.debug("elem sent to register template must be a valid element \n",(new Error).stack);var d=a.getAttribute("name");void 0===c.eventName[d]&&(c.eventName[d]=spotter.events(d)),b(d,a.innerHTML),c.members[d]=a,spotter.deleteElement(a)},d(),spotter.testLoaded(function(){Array.prototype.forEach.call(document.querySelectorAll("spotter-template[name]"),d.registerTemplate)}),d};var f=function(a,b){if("string"==typeof b){var c=this.getTemplate(b);if(null!==c)return c}this.closedStatements=[],this.openComplexStatements=[],a=a.replaceAll("data-src","src");for(var l,m,d=a,e=this.openComplexStatements,g=this.closedStatements,i=0,j=0,k=0;m=f.patterns.master.exec(a);){switch(m[0].slice(0,3)){case"IF[":if(e.length){this.registerComplex(),i++;break}e.push({type:"if",start:k+m.index,condition:m[2],then:{start:k+m.index+m[0].length,isComplex:!1},else:null,leadingFrag:a.slice(0,m.index)});break;case"]EL":if(i>0)break;l=e.last(),l.then.end=k+m.index,l.then.template=d.slice(l.then.start,l.then.end),l.else={start:k+m.index+m[0].length,isComplex:!1};break;case"]EN":if(i>0){i--;break}l=e.pop(),null!==l.else?(l.else.end=k+m.index,l.else.template=d.slice(l.else.start,l.else.end)):(l.then.end=k+m.index,l.then.template=d.slice(l.then.start,l.then.end)),l.end=k+m.index+m[0].length,l.parse=f.if(l.condition,l.then,l.else),g.push(l);break;case"REP":if(e.length){this.registerComplex(),j++;break}e.push({type:"repeat",start:k+m.index+m[0].length,isComplex:!1,leadingFrag:a.slice(0,m.index)});break;case"]US":if(j>0){j--;break}l=e.pop(),l.template=d.slice(l.start,k+m.index),l.end=k+m.index+m[0].length,l.use=m[8],l.limit=m[10]||-1,l.parse=f.repeat(l.template,l.use,l.limit,l.isComplex),g.push(l);break;default:if(m[14]){if(e.length){this.registerComplex();break}l={leadingFrag:a.slice(0,m.index)},l.parse=f.or(m[0]),g.push(l)}else{if(e.length)break;l={leadingFrag:a.slice(0,m.index)},l.parse=f.replacement(m[12]),g.push(l)}}k+=m.index+m[0].length,a=a.slice(m.index+m[0].length)}a.length&&g.push({leadingFrag:a}),e.length>0&&console.warn("a statement within template "+b+" was not completed eg ENDIF"),"string"==typeof b&&f.registerTemplate(b,this)};f.prototype.parse=function(a,b){Array.isArray(a)||(a=[a]);var e,f,c="",d=a.length,g=[];for(f=0;f<d;f++)e=a[f],c="",void 0===this.closedStatements&&console.warn("this.closedStatements undefined:\n",this),this.closedStatements.forEach(function(a){c+=a.leadingFrag,a.parse&&(c+=a.parse(e))}),g.push(c);return g},f.prototype.registerComplex=function(){var a=this.openComplexStatements.last();"repeat"===a.type?a.isComplex=!0:"if"===a.type&&(null!==a.else?a.else.isComplex=!0:a.then.isComplex=!0)},f.prototype.getTemplate=function(a){return a&&void 0!==f.registeredTemplates[a]?f.registeredTemplates[a]:null},f.replacement=function(a){return a=a.toLowerCase(),function(b){return b[a]||""}},f.replaceMultiple=function(a){for(var e,g,b=new RegExp(f.patterns.replacement),c=[];g=b.exec(a);)c.push({leadingFrag:a.slice(0,g.index),prop:g[1].toLowerCase()}),a=a.slice(g.index+g[0].length);return e=a,function(a){var b="";return c.forEach(function(c){b+=c.leadingFrag+a[c.prop]}),b+=e}},f.or=function(a){var b=[];return a=a.split("OR"),a.forEach(function(a){b.push(a.slice(2,-2).toLowerCase())}),function(a){for(var c=0,d=b.length;c<d;c++)return a[b[c]]?a[b[c]]:""}},f.if=function(a,b,c,d){if(c=c||null,a=a.split(" "),a.length<2)return void console.warn("an IF conditional was found ("+a+") but the condition format is wrong");var e=a.shift().toLowerCase(),g=a.shift(),h=a.join(" ").toLowerCase(),i="{{"!==h.slice(0,2);switch(g){case"NOT":"null"===h?a=function(a){return null!==a[e]}:"empty"===h?a=function(a){return a[e]||"0"===a[e]}:i?a=function(a){return a[e]!==h}:(h=h.slice(2,-2),a=function(a){return a[e]!==a[h]});break;case"GT":i?a=function(a){return a[e]>h}:(h=h.slice(2,-2),a=function(a){return a[e]>a[h]});break;case"LT":i?a=function(a){return a[e]<h}:(h=h.slice(2,-2),a=function(a){return a[e]<a[h]});break;case"EQ":"null"===h?a=function(a){return null===a[e]}:"empty"===h?a=function(a){return!a[e]||"0"===a[e].length}:i?a=function(a){return a[e]==h}:(h=h.slice(2,-2),a=function(a){return a[e]==a[h]});break;default:console.warn("the 'if' condition sent could not be parsed.")}return!1===b.isComplex?b.parse=f.replaceMultiple(b.template):b=new f(b.template),c&&(!1===c.isComplex?c.parse=f.replaceMultiple(c.template):c=new f(c.template)),function(d){return a(d)?b.parse(d):c?c.parse(d):""}},f.repeat=function(a,b,c,d){for(var e=new RegExp(f.patterns.replacement),g=[],h=d?new f(a):{parse:f.replaceMultiple(a)};iter=e.exec(a);)g.push(iter[1]),a=a.slice(iter.index+iter[0].length);return function(a){var d=a[b].split(","),e=[],f="",i=-1==i?d.length:Math.min(c,d.length),j=0;for(g.forEach(function(b){for(arr=a[b].split(","),j=0;j<i;j++)void 0===e[j]&&(e[j]={}),e[j][b]=arr[j]||"undefined"}),j=0;j<i;j++)f+=h.parse(e[j]);return f}},f.registeredTemplates={},f.registerTemplate=function(a,b){void 0!==this.registeredTemplates[a]?console.warn("a template is already registered by name ("+a+")"):b?this.registeredTemplates[a]=b:console.warn("a map must be provided to register for name ("+a+")")},f.patterns={replacement:"{{(.+?)}}",repeat:"REPEAT\\[(.+?)",use:"\\]USE\\[(.+?)\\](LIMIT\\[([0-9]+)\\]){0,1}",if:"IF\\[(.+?)\\]THEN\\[",else:"\\]ELSE\\[",end:"\\]ENDIF"},f.patterns.or=f.patterns.replacement+"(OR{{(.+?)}})*",f.patterns.master=new RegExp("("+f.patterns.if+")|("+f.patterns.else+")|("+f.patterns.end+")|("+f.patterns.repeat+")|("+f.patterns.use+")|("+f.patterns.or+")"),function(){var b=document.createElement("SPAN");spotter.templates={get:function(a){return f.registeredTemplates[a]},setup:function(a,b){return b?(f.registeredTemplates[b]||new f(a,b),f.registeredTemplates[b]):(console.warn("a name must be sent when setting up a template.\n",(new Error).stack),!1)},append:function(a,c,d,e){var i,q,g=f.registeredTemplates[a],p=[];return void 0===g?void console.warn("templates must first be setup (spotter.templates.setup(template)) before they can be used\n",(new Error).stack):(void 0===c||null===c?(c=[{}],1):c.length?c.length:(c=[c],1),i=g.parse(c,e),i.forEach(function(a,e){b.innerHTML=a,q=Array.prototype.slice.call(b.children),q.forEach(function(a){a.parseData=c[e],d.appendChild(a)}),p.merge(q)}),p)},parse:function(a,b){var c=f.registeredTemplates[a];return void 0===c?void console.warn("templates must first be setup (spotter.templates.setup(template)) before they can be used\n",(new Error).stack):(void 0===b||null===b?(b=[{}],l=1):(l=b.length)?l=b.length:(b=[b],l=1),c.parse(b,debug).join())}}}(),spotter.shade=function(){var a={shades:[],instances:[],openShades:[]};return spotter.onResize(function(){a.shades.forEach(function(b){b.style.height=window.height+"px",-1===a.openShades.indexOf(b)&&(b.style.bottom=window.height+"px")})}),function(b,c,d,e){if(void 0===b||!b.length)return console.warn("Spotter shade must be given a non-empty name \n",(new Error).stack),!1;c=c||"vertical";var f,g,h=9900,j=8800,k={open:!1,onClose:function(){console.log("onClose not set")},onOpen:function(){console.log("onOpen not set")},hasBeenOpened:!1,fill:{}},l=document.createElement("div");a.shades.push(l),l.id="shade-"+b,l.className="shade force-open "+c;var m=document.createElement("div"),n=document.createElement("div");m.className="content",n.className="close-button",l.appendChild(n),l.appendChild(m),m.className+=" spotter-hide-scroll",l.style.visibility="hidden",l.style.zIndex=9900,f=spotter.whichAnimationEvent,g=spotter.whichTransitionEvent,"vertical"===c?(l.style.bottom=window.height+"px",l.style.height=window.height+"px",k.fill.expand=function(){l.style.bottom=0},k.fill.shrink=function(){l.style.bottom=window.height+"px"},n.innerHTML="[X]"):"horizontal"===c?(l.style.right=window.width+"px",l.style.width=window.width+"px",l.style.minWidth="100%",l.style.height=window.height+"px",k.fill.expand=function(){l.style.right=0},k.fill.shrink=function(){l.style.right="100%"},n.innerHTML='<div class="vertical-align"><</div>'):"animate"===c?(d=d||"zoomIn",e=e||"zoomOut",spotter.toggle.class.add(m,"animated"),k.fill.expand=function(){l.style.visibility="visible",spotter.toggle.class.remove(m,e),spotter.toggle.class.add(m,d)},k.fill.shrink=function(){l.style.backgroundColor="rgba(0,0,0",spotter.toggle.class.remove(m,d),spotter.toggle.class.add(m,e)}):console.warn("the type ("+c+") send to spotter.shade was not recognized",(new Error).stack),document.body||console.warn("document body not yet loaded",(new Error).stack),spotter.appendToBody(l);var o={shade:l,content:m,closeButton:n,onClose:function(a){k.onClose=a},close:function(){console.log("shade close"),a.openShades.removeValues(l),k.open=!1,k.fill.shrink()},open:function(){k.hasBeenOpened||(o.shade.className=o.shade.className.replace(" force-open"," spotter-animated")),a.openShades.push(l),j=h+a.openShades.length,l.style.zIndex=j,l.style.visibility="visible",k.open=!0,k.fill.expand()}};return a.instances.push(o),"horizontal"===c||"vertical"===c?l.addEventListener(g,function(){k.open||(l.style.zIndex=h,l.style.visibility="hidden",k.onClose())},!1):"animate"===c&&m.addEventListener(f,function(){k.open||(l.style.zIndex=h,l.style.visibility="hidden",k.onClose())}),n.addEventListener("click",function(a){var b=a.srcElement||a.originalTarget;void 0!==b&&(b===this||b.parentNode===this&&k.open)?o.close():console.warn("popMenu is not open",a,a.originalTarget===this,k.open)},!1),o}}(),spotter.popMenu=function(){return function(a,b,c,d){var e=new spotter.shade(a,b,c,d);void 0===e.content&&console.log("shade arguments:",arguments," \n","stack: \n",spotter.log.stackDump((new Error).stack));var f=document.createElement("DIV");f.id=a,f.className="pop-menu",e.content.appendChild(f);var g={state:!1,container:f,shade:e,closeButton:e.closeButton,beforeOpen:[function(){}],onOpen:[function(){}],beforeClose:[function(){}],onClose:[function(){console.log("close")}],onMenu:[],onResponse:[],onScrollBottom:function(){},pagination:{use:!1,start:0,current:0},limit:{use:!1,to:25},menus:[],activationCount:0,activateOnReady:0,menuReady:!1},h={shade:e,container:g.container,closeButton:g.closeButton,beforeOpen:function(a){return"function"!=typeof a?(console.warn("argument (beforeOpen) must be a function"),this):(g.beforeOpen.push(a),this)},onOpen:function(a){return"function"!=typeof a?(console.warn("argument (onOpen) must be a function"),this):(g.onOpen.push(a),this)},beforeClose:function(a){return"function"!=typeof a?(console.warn("argument (beforeClose) must be a function"),this):(g.beforeClose.push(a),this)},onClose:function(a){return"function"!=typeof a?(console.warn("argument (onClose) must be a function"),this):(g.onClose.push(a),this)},resetOnOpen:function(a){if(a){if("function"!=typeof a)return console.warn("argument (resetOnOpen) must be a function"),this;g.onOpen=[a]}else g.onOpen=[];return this},resetOnClose:function(a){if(a){if("function"!=typeof a)return console.warn("argument (resetOnClose) must be a function"),this;g.onClose=[a]}else g.onClose=[];return this}};g.onScrollBottomEventName=spotter.onScrollBottom(e.content,"onScrollBottom"),h.onScrollBottom=function(a){return"function"==typeof a?g.onScrollBottom=function(b){return function(){a(b)}}(g):"refresh"===a&&(g.onScrollBottom=function(){return function(){!0!==g.template.suspended&&g.buildMenuWithRemoteData()}}()),this},g.setupScrollBottom=function(){document.removeEventListener(g.onScrollBottomEventName,g.onScrollBottom,!1),document.addEventListener(g.onScrollBottomEventName,g.onScrollBottom,!1)},g.template={data:{src:{url:null,type:null,params:null,form:null},rows:null,ready:!1,events:{ready:spotter.events("ready")},enabled:!1},ready:!1,events:{ready:spotter.events("ready")},enabled:!1,refresh:!1,suspended:!1,showEmpty:!1},g.emptyResult=document.createElement("DIV"),g.emptyResult.className="popmenu-empty-result",g.emptyResult.innerHTML="No Results Found",g.menuActivationProcess=function(){for(var a=g.beforeOpen.length;--a>-1;)if(!1===g.beforeOpen[a](g))return;g.shade.open(),g.shade.onClose(g.menuDeactivationProcess),spotter.scroll.recordPosition(),spotter.scroll.to(g.container),g.container.style.display="block",g.onOpen.forEach(function(a){a(g)}),g.state=!0,g.template.suspended=!1},g.menuDeactivationProcess=function(){return function(){g.beforeClose.forEach(function(a){a(g)}),spotter.scroll.reset(),g.container.style.display="none",g.pagination.current=0,document.removeEventListener(g.onScrollBottomEventName,g.onScrollBottom,!1),g.onClose.forEach(function(a){a(g)}),g.activationCount=0,g.state=!1,g.template.suspended=!1}}(),g.enableActivation=function(){g.template.suspended=!1,g.template.ready=!0,!0===g.activateOnReady&&(g.menuActivationProcess(),g.activateOnReady=!1)};return g.parseTemplate=function(){var b=g.template,c=b.data;if(!0===c.enabled&&!1===c.ready)return void console.debug("popMenu.parseTemplate - data not ready for popmenu "+a);if(!1===b.ready)return void console.debug("popMenu.parseTemplate - template not ready for popmenu "+a);var d,e=g.menus.push(d=document.createElement("SPAN"))-1;g.container.appendChild(d),c.enabled?("form"===c.type&&(c.rows=[spotter.getDataFromForm(c.form)]),spotter.templates.setup(b.result,b.name),spotter.templates.append(b.name,c.rows,d)):d.innerHTML=b.result;var i,f=d.querySelectorAll("script"),h="";if(null!==f){var k,e=f.length,j=0;for(j;j<e;j++)i=f[j],h+=i.innerHTML+((k=i.getAttribute("data-name"))?"//# sourceURL=inline: "+k:""),spotter.deleteElement(i);var l=document.createElement("SCRIPT");l.text=h,d.appendChild(l)}g.onMenu.forEach(function(a){a.call(d,g)}),g.pagination.current++,g.enableActivation(),c.ready=!1},g.readyDataToParseTemplate=function(){var a=!1;return function(){if(!0!==g.template.data.enabled)return void console.warn("Data not enabled. Ready data to parse template call useless.");var b=g.template.data;0===g.pagination.current&&(g.container.innerHTML=""),"static"!==b.type&&null!==b.type?("form"===b.type&&(b.params=spotter.getDataFromForm(b.form)),!1===a&&(document.addEventListener(g.template.data.events.ready,g.parseTemplate,!1),a=!0),g.getRemoteData()):g.parseTemplate()}}(),g.getRemoteData=function(){var a=!1;return function(){return a?(console.warn("popMenu.getRemoteData is already active and awaiting a request"),!1):(a=!0,spotter.ajax({url:g.template.data.src.url,data:g.template.data.src.params,dataType:"JSON",type:"GET",cache:g.template.data.src.cache,success:function(a){if(a=JSON.parse(a),g.onResponse.forEach(function(b){b.call(a,g)}),"success"!==a.status||0===a.result.length)return void(!0===g.template.showEmpty&&g.container.appendChild(g.emptyResult));g.template.data.rows=a.result,g.template.data.ready=!0,spotter.events.fire(g.template.data.events.ready)},error:function(){console.warn(arguments),console.log(stack),g.enableActivation()},complete:function(){a=!1}}),!1)}}(),g.revertDynamicParams=function(){g.template.data=g.template.data.old},h.activate=function(){if(console.log("spotter popMenu activate"),!0===g.state)return void console.debug("menu was previously activated and never set to deactivated");g.state=!0,g.activateOnReady=!0,void 0!==g.title&&(g.titleBar.innerHTML=g.title),g.setupScrollBottom(),!0===g.template.enabled?!1===g.template.suspended?!1===g.template.ready?(console.log("template not yet loaded. now loading."),h.loadTemplate()):g.menuActivationProcess():console.log("popMenu ("+a+") is currently suspended"):g.enableActivation()},h.deActivate=function(){console.debug("spotter pop menu deactivation"),g.shade.closeButton.click()},h.attachTo=function(a){spotter.requiredParam(a).element().result()();var b=function(a){return function(b){this.pressandhold||(b.preventDefault(),a.activate.call(a))}}(this);return g.goButton=a,a.addEventListener("click",b,!1),this},h.bindDataToRemoteRequest=function(a,b,c){if(g.template.data.enabled=!0,g.template.data.ready=!1,"FORM"===a.tagName)g.template.data.src.form=a,g.template.data.src.type="form",g.template.data.src.url=a.action;else if("object"==typeof a)g.template.data.src.params=a,g.template.data.src.type="remote","string"==typeof b&&(g.template.data.src.url=b);else{if("string"!=typeof b)return void console.warn("the argument for 'bindDataToRemoteRequest' must be a form element or array of objects (rows) or a URL must be specified");g.template.data.src.url=b}return g.template.data.src.cache=c||!1,this},h.bindDataToParseTemplate=function(a){if(g.template.data.enabled=!0,"FORM"===a.tagName)g.template.data.type="form",g.template.data.form=a;else{if(!spotter.isType.rows(a))return void console.warn("the argument for 'bindDataToRemoteRequest' must be a form element or array of objects (rows)",spotter.log.stackDump((new Error).stack));g.template.data.rows=a,g.template.data.type="static"}return g.template.data.ready=!0,g.readyDataToParseTemplate(),this},h.useTemplate=function(a){return g.template.name=a,g.template.enabled=!0,this},h.loadTemplate=function(){var a=!1;return function(){return!1===a&&(document.addEventListener(g.template.events.ready,g.parseTemplate),a=!0),g.template.enabled?(spotter.imports.useImport(g.template.name,function(a){var b=g.template;b.result=a.content.template,b.ready=!0,spotter.events.fire(b.events.ready)}),g.template.data.enabled&&g.readyDataToParseTemplate(),this):(g.onMenu.forEach(function(a){a.call(f,g)}),this)}}(),h.setTitle=function(a){return g.title=a,g.titleBar=document.createElement("DIV"),g.titleBar.className="title",spotter.prependChild(g.shade.content,g.titleBar),this.setTitle=function(a){return g.title=a,this},this},h.enableRefresh=function(a){return g.template.refresh=!!a,this},h.showEmpty=function(a){return g.template.showEmpty=!!a,this},h.onMenu=function(a){return!1===g.template.suspended||!1===g.template.ready||!1===g.template.refresh?g.onMenu.push(a):a.call(g.menus.last(),g),this},h.onResponse=function(a){return!1===g.template.ready?g.onResponse.push(a):a.call(g.template.data.rows,g),this},h.resetFunctions=function(){g.onMenu=[],g.onResponse=[],g.onOpen=[],g.onClose=[],g.beforeClose=[],g.beforeOpen=[]},h.forceOpen=function(){g.shade.shade.className=g.shade.shade.className.replace(" spotter-animated"," force-open")},h.forceClose=function(){g.shade.shade.className=g.shade.shade.className.replace(" force-open"," spotter-animated")},h.refreshCurrentState=function(){g.container.style.display="none",g.pagination.current=0,document.removeEventListener(g.onScrollBottomEventName,g.onScrollBottom,!1),g.activationCount=0,g.state=!1,g.template.suspended=!1,this.activate()},h.limitResult=function(a){return g.limit.use=!0,g.limit.to=Number(a),this},h.usePagination=function(a){return g.pagination.use=!0,void 0!==a&&(g.pagination.start=g.pagination.current=a),this},h.isActive=function(){return g.state},h}}(),spotter.appendToBody=function(){var a=[],b=function(){var b=document.body;a.forEach(function(a){b.appendChild(a)})};return spotter.testLoaded(b),function(b){document.body?document.body.appendChild(b):a.push(b)}}(),spotter.confirmation=function(){var a={acceptFuncs:[],denyFuncs:[]},b=function(){a.acceptFuncs.forEach(function(a){a()})},c=function(){a.denyFuncs.forEach(function(a){a()}),a.popMenu.shade.closeButton.click()};a.popMenu=new spotter.popMenu("confirmation-box","animate","zoom").useTemplate("confirmation-box").onMenu(function(d){a.title=document.getElementById("spotter-confirmation-title"),a.msg=document.getElementById("spotter-confirmation-msg"),a.qBox=document.getElementById("spotter-confirmation-question"),a.ok=document.getElementById("spotter-confirmation-ok"),a.cancel=document.getElementById("spotter-confirmation-cancel"),a.ok.addEventListener("click",b),a.cancel.addEventListener("click",c),spotter.verticallyCenter(document.getElementById("spotter-confirmation"))}).loadTemplate();var d=function(){return a.ok.removeEventListener("click",a.onAccept,!1),a.cancel.removeEventListener("click",a.onDeny,!1),a.acceptFuncs=[],a.denyFuncs=[],d};return d.setTitle=function(b){return a.title.innerHTML=b.toString(),spotter.confirmation},d.setMessage=function(b){return a.msg.innerHTML=b.toString(),spotter.confirmation},d.setQuestion=function(b){return a.qBox.innerHTML=b.toString(),spotter.confirmation},d.onAccept=function(b){return a.acceptFuncs.push(b),d},d.onDeny=function(b){return a.denyFuncs.push(b),d},d.activate=function(){return a.popMenu.activate(),d},d.deActivate=function(){return a.popMenu.shade.closeButton.click(),d},d},spotter.confirmationMessage=function(){var a={closeFuncs:[]},b=function(){a.closeFuncs.forEach(function(a){a()}),c.deActivate()};a.popMenu=new spotter.popMenu("confirmation-message-box","animate","zoom").useTemplate("confirmation-message-box").onMenu(function(c){a.title=document.getElementById("spotter-confirmation-message-title"),a.msg=document.getElementById("spotter-confirmation-message-msg"),a.ok=document.getElementById("spotter-confirmation-message-ok"),a.ok.addEventListener("click",b),spotter.verticallyCenter(document.getElementById("spotter-confirmation-message"))}).loadTemplate();var c=function(){return a.ok.removeEventListener("click",a.onAccept,!1),a.closeFuncs=[],spotter.confirmationMessage};return c.setTitle=function(b){return a.title.innerHTML=b.toString(),spotter.confirmationMessage},c.setMessage=function(b){return a.msg.innerHTML=b.toString(),spotter.confirmationMessage},c.onClose=function(b){return a.closeFuncs.push(b),spotter.confirmationMessage},c.activate=function(){return a.popMenu.activate(),spotter.confirmationMessage},c.deActivate=function(){return console.log("confirmation message deactivate"),a.popMenu.shade.closeButton.click(),spotter.confirmationMessage},c},spotter.createWorker=function(a){window.URL=window.URL||window.webkitURL;var c,b=a;try{c=new Blob([b],{type:"application/javascript"})}catch(a){window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder,c=new BlobBuilder,c.append(b),c=c.getBlob()}return new Worker(URL.createObjectURL(c))},spotter.scrollBarWidth=function(){var a={calculatedValue:-1,onReady:[],isReady:!1};a.runOnReady=function(){-1!==a.calculatedValue&&(a.onReady.forEach(function(b){b(a.calculatedValue)}),a.onReady=[])};var b={calc:function(){if(document.body){var b=document.createElement("div");b.style.visibility="hidden",b.style.width="100px",b.style.msOverflowStyle="scrollbar",spotter.appendToBody(b);var c=b.offsetWidth;b.style.overflow="scroll";var d=document.createElement("div");d.style.width="100%",b.appendChild(d);var e=d.offsetWidth;b.parentNode.removeChild(b),a.calculatedValue=c-e,a.isReady=!0,a.runOnReady()}else console.log("spotter.scrollBarWidth document.body is not ready")},get:function(){return-1===a.calculatedValue&&(b.calc(),-1===a.calculatedValue&&console.log("getScrollBarWidth is not functioning. Make sure page has loaded before calling")),a.calculatedValue},onReady:function(b){"function"==typeof b&&(!0===a.isReady?b(a.calculatedValue):a.onReady.push(b))}};return spotter.testLoaded(function(){spotter.scrollBarWidth.calc()}),b}(),spotter.transitionEndEventName=function(){var a,b,c=document.createElement("div"),d={transition:"transitionend",OTransition:"otransitionend",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(a in d)if(d.hasOwnProperty(a)&&c.style[a]!==b)return d[a]}(),spotter.data=function(){var a={variables:{}},b={createDOMElementObserver:function(){var a={members:[],evts:[]};return a.observer=function(b,c,d,e){var f=b,g=a.members.indexOf(c)||a.members.push(c)-1;a.evts[g]=a.evts[g]||[],a.evts[g].push(e);var h=a.evts[g].length;Object.defineProperty(c,d,{get:function(){return f},set:function(b){var c=h;for(f=b;--c>-1;)this.eventTriggers[a.evts[g][c]](void 0,{value:b})},configurable:!0,enumerable:!0})},function(b,c,d){spotter.events.setEventTrigger(b,d),a.observer(b[c],b,c,d)}}()};return a.bindAttributeOnCustomElement=function(a,b){Object.defineProperty(a,b,{get:function(){return a.getAttribute(b)},set:function(c){a.setAttribute(b,c)},configurable:!0,enumerable:!0})},a.triggerEventOnPropertySetter=function(a,c,d){b.createDOMElementObserver(a,c,d)},a.createBoundVariables=function(b,c){var d=!1;"string"==typeof b&&(b=b.split(","),d=!0),"string"==typeof c&&(c=c.split(","));for(var e=b.length;--e>-1;)void 0===a.variables[b[e]]?(a.variables[b[1]]=c[e],b[e]=a.variables[b[1]]):b[e]=!1;return!0===d?b[0]:b},a.bindElementToInput=function(){var a=[],c=["text","email","tel","search","number","date","month","password"];return function(d,e,f){d&&e||console.warn("element and input must both be valid to bind input to element \n",(new Error).stack),f=f||function(a){return a};var g,h={value:""};(~c.indexOf(e.type)||"textarea"===e.tagName)&&(h=e.cloneNode(),h.id=null,h.name=null,e.style.display="none",e.parentNode.insertBefore(h,e),h.linkedInput=e,h.handleEvent=function(a){this.linkedInput.value=this.value},h.addEventListener("change",this)),~a.indexOf(e)||(b.createDOMElementObserver(e,"value","change"),a.push(e)),g="input"==d.tagName&&"text"==d.type||"textarea"==d.tagName?function(){h.value=this.value;var a=f(this.value);"ignore"!==a&&(d.value=a)}:"IMG"==d.tagName?function(){h.value=this.value;var a=f(this.value);"ignore"!==a&&(d.src=a)}:function(){h.value=this.value;var a=f(this.value);"ignore"!==a&&spotter.setFirstTextNode(d,a)},e.addEventListener("change",g,!1)}}(),a.bindElementToElement=function(){var a=[];return function(c,d,e,f){f=f||function(a){return a};var g;-1===a.indexOf(d)&&(b.createDOMElementObserver(d,e,"change"),a.push(d)),g="input"==c.tagName&&"text"==c.type||"textarea"==c.tagName?function(){c[e]=f(this[e])}:function(){spotter.getFirstTextNode(c).nodeValue=f(this[e])},d.addEventListener("change",g,!1)}}(),a.twowayBind=function(){for(var c,d,a=void 0,b=arguments,e=b.length+2;(e-=2)>0;)c=b[e-2],d=b[e-1],c[d]&&(a=c[d]),Object.defineProperty(c,d,{get:function(){return a},set:function(b){a=b}});b=void 0},b.setValue=function(){var a=["text","email","tel","search","number","date","month","password","hidden"];return function(b,c){"input"===b.tagName.toLowerCase()&&a.indexOf(b.type)>-1||"textarea"==b.tagName?b.value=c:spotter.getFirstTextNode(b).nodeValue=c}}(),a}(),spotter.date=function(){var a={};return c.today=new Date,c.format=function(a,b){var c=a.getDate(),d=("0"+c).slice(-2),e=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],f=a.getMonth();e[f];f=("0"+(Number(f)+1)).slice(-2);var h=a.getFullYear(),i=h.toString().slice(-2);a.getHours(),a.getMinutes(),a.getSeconds();return time=b.replace("$[d]",c),time=time.replace("$[D]",d),time=time.replace("$[m]",f),time=time.replace("$[M]",f),time=time.replace("$[Y]",h),time=time.replace("$[y]",i),time},a.formatUnix=function(a,b){var d=new Date(1e3*a);return c.format(d,b)},a.formatDate=function(a,b){return"[object Date]"!==Object.prototype.toString.call(a)&&(a="today"===a?c.today:new Date(a)),c.format(a,b)},a}(),spotter.primes={values:[2,3,5,7,11,13,17,19,23,31,37,43,53,59,61,67,71,73,79,83,89,95,101,103,107,109],alphaPositionReference:{a:0,b:1,c:2,d:3,e:4,f:5,g:6,h:7,i:8,j:9,k:10,l:11,m:12,n:13,o:14,p:15,q:16,r:17,s:18,t:19,u:20,v:21,w:22,x:23,y:24,z:25},alphaPrimeReference:{a:2,b:3,c:5,d:7,e:11,f:13,g:17,h:19,i:23,j:31,k:37,l:43,m:53,n:59,o:61,p:67,q:71,r:73,s:79,t:83,u:89,v:95,w:101,x:103,y:107,z:109}},spotter.parameterize=function(a,b){},spotter.getFormData=function(a){spotter.requiredParam(a).element("FORM").result()(!0);for(var e,f,g,h,b=new FormData(a),c=a.querySelectorAll('input[type="file"]')||[],d=c.length;--d>-1;)if(e=c[d],void 0!==(f=e.fileTarget)&&null!==e.value&&0!==e.value.length){if("CANVAS"!==f.tagName)return console.warn("file target for a file input must be a canvas",f,e,a),!1;g=f.getAttribute("mimeType")||"image/jpeg",h=f.getAttribute("quality")||1,h>1&&(h/=100);var i=canvasToBlob(f,g,h);b.append(e.name,i)}return b.processData=!1,b.contentType=!1,b},spotter.getFormObj=function(a){spotter.requiredParam(a).element("FORM").result()(!0);for(var e,f,g,h,i,j,k,b=a.elements,c=b.length,d={};--c>-1;)if(e=a.elements[c],f=e.hasAttribute("type")?e.getAttribute("type"):e.type,g=e.tagName.toUpperCase(),!e.disabled&&((h=e.getAttribute("name"))||(h=e.name)))if("SELECT"===g)if("select-multiple"===f){for(i=e.options.length,j=[];--i>-1;)k=e.options[i],k.selected&&v.push(k.value);d[h]=j}else d[h]=e.value;else"TEXTAREA"===g?d[h]=e.value:"INPUT"===g&&("radio"===f.toLowerCase()||"checkbox"===f.toLowerCase()?(e.checked&&(d[h]=d[h]||[]),d[h].push(e.value)):"file"!==f.toLowerCase()&&(d[h]=e.value));return d},spotter.serialize=function(a,b){var d,e,c="";if(a.tagName&&"FORM"===a.tagName&&(a=spotter.getFormObj(a)),"object"==typeof a)for(e in a)void 0!==(d=a[e])&&""!==d&&(Array.isArray(d)&&d.forEach(function(a){c+="&"+(b?encodeURIComponent(e):e)+"[]="+(b?encodeURIComponent(a):a)}),c+="&"+(b?encodeURIComponent(e):e)+"="+(b?encodeURIComponent(d):d));return c},spotter.deSerialize=function(a,b){"?"!==a[0]&&"&"!==a[0]||(a=a.slice(1));var g,h,i,c={},d=a.split("&"),e=0,f=d.length;for(e;e<f;e++)g=d[e].split("="),h=!0===b?decodeURIComponent(g[0]):g[0],i=!0===b?decodeURIComponent(g[1]):g[1],void 0!==c[h]?Array.isArray(c[h])?c[h].push(i):c[h]=[c[h],i]:c[h]=i;return c},spotter.storeForm=function(a,b){console.debug("** STORE FORM **");var c=spotter.getFormObj(a),d=a.storageId;console.debug(c),"string"!=typeof d&&(d="F"+(b||a.name||a.id)+"P"+spotter.URL.currentPage(),a.storageId=d),localStorage.setObject(d,c)}}(),spotter.imports=spotter.imports(),spotter.testLoaded(function(){spotter.sharedShade=new spotter.shade("shared"),spotter.confirmation=spotter.confirmation(),spotter.confirmationMessage=spotter.confirmationMessage();var c=(spotter.getWidth(document.body),document.createElement("DIV"));spotter.appendToBody(c),c.style.width="1rem",document.createElement("STYLE"),spotter.css=function(){var a={},b={};return a.createStyleSheet=function(){a.styleSheet=document.createElement("STYLE"),a.styleSheet.type="text/css",spotter.testLoaded(function(){(document.head||document.getElementsByTagName("head")[0]).appendChild(a.styleSheet)})},b.addRule=function(c){void 0===a.styleSheet&&a.createStyleSheet(),a.styleSheet.styleSheet?b.addRule=function(b){a.styleSheet.styleSheet.cssText+=b}:b.addRule=function(b){a.styleSheet.appendChild(document.createTextNode(b))},b.addRule(c)},b}(),spotter.scrollBarWidth.onReady(function(a){spotter.css.addRule(".vertical { overflow-x: hidden; }"),spotter.css.addRule(".vertical .spotter-hide-scroll { width: calc(100% + "+a+"px) !important; overflow-y:scroll; overflow-x: hidden; }"),spotter.css.addRule(".horizontal .spotter-hide-scroll { overflow:scroll; height:calc(100% + "+a+"px); }"),spotter.css.addRule(".shade.horizontal .content{ width:calc(100% + "+a+"px); }")}),spotter.onPageOut(function(){localStorage.setObject("registry",localStorage.registry),sessionStorage.setObject("registry",sessionStorage.registry)})}),window.spotter.onModuleReady={eventName:"",functions:{}},window.spotter.require=function(){var d,a=spotter.events("moduleCreated"),b={name:"spotter.js",registered:[],dependencies:[],isReadyFuncs:[],ready:[],testModuleReady:function(){var d,e,f,a=b.registered,c=a.length-1;a:for(;c>-1&&a.length;){var d=a[c],e=b.dependencies[c],g=b.isReadyFuncs[c];if(void 0!==d)if(!1!==g()){if(e&&(f=e.length))for(;--f>-1;)if(-1===b.ready.indexOf(e[f])){--c;continue a}b.ready.push(d),a.splice(c,1),b.dependencies.splice(c,1),window.spotter.onModuleReady.functions[d].forEach(function(a){a()})}else--c;else--c}}},c=function(b,d,e,f){b=b.toLowerCase(),e=e||[];var g=!1,h=[];switch(b){case"template":f=function(){return void 0!==window.spotter.template},d=c.homeURL+"Template.js",g=!0;break;case"datamanager":f=function(){return void 0!==window.spotter.DataManager},d=c.homeURL+"DataManager.js",g=!0;break;case"mobile":f=function(){return void 0!==window.spotter.mobile},d=c.homeURL+"Mobile.js",g=!0;break;case"image":e[0]="exif",f=function(){return void 0!==window.spotter.image},d=c.homeURL+"Image.js",g=!0;break;case"fader":f=function(){return void 0!==window.spotter.fader},d=c.homeURL+"Fader.js",g=!0;break;case"error":f=function(){return void 0!==window.spotter.error},d=c.homeURL+"Error.js",g=!0;break;case"components":e[0]="datamanager",f=function(){return void 0!==window.spotter.components},d=c.homeURL+"Components.js",g=!0;break;case"form":d=c.homeURL+"Form.js",f=function(){return void 0!==window.spotter.form},g=!0}if(!0===g)spotter.observeSetter(window.spotter,b,a);else if("string"!=typeof d)return console.warn("for non-spotter require ("+b+") you must specify the download path"),!1;return c.register(b,e,f)?(spotter.addScriptToHead(d),h.forEach(function(a){spotter.addCSSToHead(a)}),!0):void console.warn("script/module "+b+" already registered")};return d=document.currentScript&&document.currentScript.src?document.currentScript:document.querySelector('script[src*="'+b.name+'"]'),c.getThisScript=function(){return d},c.homeURL=function(){var a;if(document.currentScript&&document.currentScript.src)a=d.src,a=a.slice(0,a.indexOf(b.name));else{var c=d.getAttribute("src"),a=window.location.href.split("/");a=a[0]+"//"+a[2]+c.slice(0,c.indexOf(b.name))}return a}(),c.register=function(a,c,d){c=c||[];var f,g;c.length;return!~b.registered.indexOf(a)&&(f=b.registered.push(a)-1,b.dependencies[f]=c,b.isReadyFuncs[f]=d||function(){},g=window.spotter.onModuleReady.functions,g[a]=g[a]||[],console.log("module or script '"+a+"' registered"),!0)},c.isReady=function(a){return~b.ready.indexOf(a)},spotter.observeSetter(window.spotter,"require",a),c.register("require"),document.addEventListener(a,b.testModuleReady,!1),c.scriptComplete=function(a){console.log("module ("+a+") complete"),b.testModuleReady()},c}();var onLoadModules=spotter.require.getThisScript().getAttribute("data-modules");onLoadModules&&(onLoadModules=onLoadModules.split(","),onLoadModules.forEach(function(a){spotter.require(a)||spotter.log("error",{func:"onLoadModules",msg:"the module was not recognized",vars:{module:a,stack:(new Error).stack}})})),document.write('<link rel="stylesheet" href="'+spotter.require.homeURL+'css/main.css"/>'),document.write('<link rel="stylesheet" href="'+spotter.require.homeURL+'css/animate/animate.min.css"/>'),spotter.events("spotterReady"),spotter.events.fire("spotterReady"),window.consoleStyles=[],window.consoleStyles.components=[,"border-top: 1px solid #3E0E02","color: white","display: block","font-weight: bold"].join(";");